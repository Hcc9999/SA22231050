<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Chen Huang" />

<meta name="date" content="2023-12-10" />

<title>Homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">Chen Huang</h4>
<h4 class="date">2023-12-10</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  <span class="fu">library</span>(stats)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  <span class="fu">library</span>(bootstrap)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  <span class="fu">library</span>(DAAG)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: package &#39;microbenchmark&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>  <span class="fu">library</span>(Rcpp)</span></code></pre></div>
<pre><code>## Warning: package &#39;Rcpp&#39; was built under R version 4.3.2</code></pre>
<div id="hw0" class="section level2">
<h2>HW0</h2>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at at least 3 examples where text is mixed with
figures, tables and mathematical formulas.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div id="example-1-线性回归模型分析" class="section level3">
<h3>Example 1: 线性回归模型分析</h3>
<div id="生成随机数据集" class="section level4">
<h4>1.1 生成随机数据集</h4>
<p>生成一个虚拟数据集用于线性回归分析。</p>
<table>
<caption>随机产生的数据集 (前10行)</caption>
<thead>
<tr class="header">
<th align="right">X</th>
<th align="right">Y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.5604756</td>
<td align="right">1.168642</td>
</tr>
<tr class="even">
<td align="right">-0.2301775</td>
<td align="right">2.796529</td>
</tr>
<tr class="odd">
<td align="right">1.5587083</td>
<td align="right">5.870725</td>
</tr>
<tr class="even">
<td align="right">0.0705084</td>
<td align="right">2.793474</td>
</tr>
<tr class="odd">
<td align="right">0.1292877</td>
<td align="right">2.306957</td>
</tr>
<tr class="even">
<td align="right">1.7150650</td>
<td align="right">6.385102</td>
</tr>
<tr class="odd">
<td align="right">0.4609162</td>
<td align="right">3.136928</td>
</tr>
<tr class="even">
<td align="right">-1.2650612</td>
<td align="right">-1.198064</td>
</tr>
<tr class="odd">
<td align="right">-0.6868529</td>
<td align="right">1.246068</td>
</tr>
<tr class="even">
<td align="right">-0.4456620</td>
<td align="right">3.027673</td>
</tr>
</tbody>
</table>
</div>
<div id="公式" class="section level4">
<h4>1.2 公式</h4>
<p>线性回归模型的公式如下：</p>
<p><span class="math display">\[
Y = \beta_0 + \beta_1 X + \epsilon
\]</span></p>
<p>其中，<span class="math inline">\(Y\)</span>是因变量，<span class="math inline">\(X\)</span>是自变量，<span class="math inline">\(\beta_0\)</span>和<span class="math inline">\(\beta_1\)</span>是模型的系数，<span class="math inline">\(\epsilon\)</span>表示误差项。</p>
</div>
<div id="结果分析" class="section level4">
<h4>1.3 结果分析</h4>
<div id="模型系数" class="section level5">
<h5>1.3.1 模型系数</h5>
<table>
<caption>线性回归模型系数</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
<th align="right">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">2.897197</td>
<td align="right">0.0975512</td>
<td align="right">29.69925</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">X</td>
<td align="right">1.947528</td>
<td align="right">0.1068786</td>
<td align="right">18.22187</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div id="拟合图像" class="section level5">
<h5>1.3.2 拟合图像</h5>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="example-2-逻辑回归模型分析" class="section level3">
<h3>Example 2: 逻辑回归模型分析</h3>
<div id="生成虚拟数据集" class="section level4">
<h4>2.1 生成虚拟数据集</h4>
<p>我们首先生成一个虚拟数据集，用于进行逻辑回归分析。我们将生成一个自变量X和一个因变量Y。</p>
<table>
<caption>随机产生的数据集 (前十行)</caption>
<thead>
<tr class="header">
<th align="right">X</th>
<th align="right">Y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.5604756</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">-0.2301775</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">1.5587083</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">0.0705084</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">0.1292877</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1.7150650</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">0.4609162</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">-1.2650612</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">-0.6868529</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">-0.4456620</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
<div id="逻辑回归模型公式" class="section level4">
<h4>2.2 逻辑回归模型公式</h4>
<p>逻辑回归模型是一种用于建模二分类问题的统计模型。对于给定的特征变量x，逻辑回归模型可以预测响应变量y的概率。逻辑回归模型的公式如下所示：</p>
<p><span class="math display">\[
P(y=1|x) = \frac{1}{1 + e^{-(\beta_0 + \beta_1x)}}
\]</span></p>
<p>其中，<span class="math inline">\(P(y=1|x)\)</span>表示在给定特征变量x的条件下，响应变量y取值为1的概率。<span class="math inline">\(\beta_0\)</span>和<span class="math inline">\(\beta_1\)</span>是模型的参数，分别表示截距和特征变量的系数。</p>
</div>
<div id="分析结果" class="section level4">
<h4>2.3 分析结果</h4>
<p>使用R中的glm函数进行逻辑回归分析。将响应变量y视为二项分布，并使用logit连接函数拟合逻辑回归模型。</p>
<div id="模型系数-1" class="section level5">
<h5>2.3.1 模型系数</h5>
<table>
<caption>逻辑回归模型系数</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">z value</th>
<th align="right">Pr(&gt;|z|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">2.493857</td>
<td align="right">0.5693791</td>
<td align="right">4.379960</td>
<td align="right">1.19e-05</td>
</tr>
<tr class="even">
<td align="left">X</td>
<td align="right">4.014433</td>
<td align="right">0.9408329</td>
<td align="right">4.266893</td>
<td align="right">1.98e-05</td>
</tr>
</tbody>
</table>
</div>
<div id="拟合图像-1" class="section level5">
<h5>2.3.2 拟合图像</h5>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="example-3多项式拟合模型分析" class="section level3">
<h3>Example 3：多项式拟合模型分析</h3>
<div id="生成虚拟数据集-1" class="section level4">
<h4>3.1 生成虚拟数据集</h4>
<p>生成一个虚拟数据集用于进行多项式拟合。</p>
<table>
<caption>随机产生的数据集 (前十行)</caption>
<thead>
<tr class="header">
<th align="right">X</th>
<th align="right">Y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">-0.5604756</td>
</tr>
<tr class="even">
<td align="right">0.1010101</td>
<td align="right">-0.5128017</td>
</tr>
<tr class="odd">
<td align="right">0.2020202</td>
<td align="right">1.0342720</td>
</tr>
<tr class="even">
<td align="right">0.3030303</td>
<td align="right">-0.6549278</td>
</tr>
<tr class="odd">
<td align="right">0.4040404</td>
<td align="right">-0.7563362</td>
</tr>
<tr class="even">
<td align="right">0.5050505</td>
<td align="right">0.7100655</td>
</tr>
<tr class="odd">
<td align="right">0.6060606</td>
<td align="right">-0.6226467</td>
</tr>
<tr class="even">
<td align="right">0.7070707</td>
<td align="right">-2.3863754</td>
</tr>
<tr class="odd">
<td align="right">0.8080808</td>
<td align="right">-1.8051061</td>
</tr>
<tr class="even">
<td align="right">0.9090909</td>
<td align="right">-1.5200421</td>
</tr>
</tbody>
</table>
</div>
<div id="多项式拟合模型公式" class="section level4">
<h4>3.2 多项式拟合模型公式</h4>
<p><span class="math display">\[
y = \beta_0 + \beta_1x + \beta_2x^2 + \beta_3x^3 + \ldots + \beta_nx^n
\]</span> 其中，<span class="math inline">\(y\)</span>
是因变量（或响应变量）；<span class="math inline">\(x\)</span>
是自变量（或预测变量）；<span class="math inline">\(\beta_0, \beta_1,
\ldots, \beta_n\)</span>是模型的系数（或回归系数）；<span class="math inline">\(n\)</span> 是多项式的次数。</p>
</div>
<div id="分析结果-1" class="section level4">
<h4>3.3 分析结果</h4>
<p>对虚拟数据集进行二次项的多项式拟合</p>
<div id="模型系数-2" class="section level5">
<h5>3.3.1 模型系数</h5>
<table>
<colgroup>
<col width="35%" />
<col width="13%" />
<col width="13%" />
<col width="14%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
<th align="right">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.1699114</td>
<td align="right">0.2688874</td>
<td align="right">0.6319054</td>
<td align="right">0.5289352</td>
</tr>
<tr class="even">
<td align="left">poly(X, degree, raw = TRUE)1</td>
<td align="right">-3.0986706</td>
<td align="right">0.1242731</td>
<td align="right">-24.9343553</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">poly(X, degree, raw = TRUE)2</td>
<td align="right">2.0123530</td>
<td align="right">0.0120252</td>
<td align="right">167.3443770</td>
<td align="right">0.0000000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="拟合曲线" class="section level3">
<h3>3.3.2 拟合曲线</h3>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw1" class="section level2">
<h2>HW1</h2>
</div>
<div id="question-1" class="section level2">
<h2>Question 1</h2>
<p>利用逆变换法复现R语言中函数Sample的部分功能（replace = TRUE）</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer 1</h2>
<p>基本思想： </p>
<p>1.生成<span class="math inline">\(U \backsim U(0,1)\)</span>的随机数
</p>
<p>2.计算累积概率 </p>
<p>3.通过逆变换（<span class="math inline">\(x=a+(b-a)y\)</span>）生成随机样本 </p>
<p>代码如下： </p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>my_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b, <span class="at">prob =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(a<span class="sc">:</span>b))) {</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="co"># 生成0到1之间的随机数</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  </span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="co"># 计算累积概率</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  cum_prob <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(prob)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  </span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>  <span class="co"># 逆变换生成随机样本</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> a <span class="sc">+</span> <span class="fu">findInterval</span>(u, cum_prob) <span class="sc">*</span> (b <span class="sc">-</span> a)</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>  </span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>}</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co"># 生成服从自定义概率分布的随机样本</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># 设置随机种子以重现结果</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>  <span class="co"># 样本数量</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span>   <span class="co"># 下限</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">10</span>  <span class="co"># 上限</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>)  <span class="co"># 自定义概率分布</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="fu">my_sample</span>(n, a, b, prob)</span></code></pre></div>
<pre><code>##  [1] 10 19 10 19 19  1 19 19 19 10</code></pre>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<p>3.2</p>
<p>使用逆变换法从具有密度函数<span class="math inline">\(f(x)=\frac{1}{2} e^{-|x|}, x
\in\mathbb{R}\)</span>的标准拉普拉斯分布生成一个大小为1000的随机样本，其中
x ∈R。并比较生成的样本与目标分布。</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer 2</h2>
<p>基本思想： </p>
<p>1.定义逆变换函数：根据标准拉普拉斯分布的累积分布函数（CDF），我们可以求解其逆函数
</p>
<p>2.生成随机样本：生成大小为1000的[0, 1]范围内的随机数<span class="math inline">\(u_1, u_2, ...,
u_{1000}\)</span>，然后使用逆变换函数将这些随机数转换为符合标准拉普拉斯分布的随机样本<span class="math inline">\(x_1, x_2, ..., x_{1000}\)</span> </p>
<p>3.绘制样本和目标分布的直方图：使用生成的样本<span class="math inline">\(x_1, x_2, ...,
x_{1000}\)</span>和标准拉普拉斯分布的密度函数<span class="math inline">\(f(x)\)</span>，绘制两者的直方图进行比较 </p>
<p>代码如下： </p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># 定义逆变换方法生成随机样本的函数</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>inverse_transform_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)  <span class="co"># 生成0到1之间的随机数</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">sign</span>(u <span class="sc">-</span> <span class="fl">0.5</span>) <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">abs</span>(u <span class="sc">-</span> <span class="fl">0.5</span>))  <span class="co"># 逆变换生成随机样本</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>}</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co"># 生成标准拉普拉斯分布的随机样本</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># 设置随机种子以重现结果</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co"># 样本数量</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>random_samples <span class="ot">&lt;-</span> <span class="fu">inverse_transform_sample</span>(n)</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co"># 绘制生成的样本和目标分布的直方图进行比较</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="fu">hist</span>(random_samples, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">f</span>(x) <span class="sc">==</span> <span class="fu">frac</span>(<span class="dv">1</span>, <span class="dv">2</span>) <span class="sc">*</span> e<span class="sc">^</span>(<span class="sc">-</span><span class="fu">abs</span>(x)))),</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">border =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="fu">curve</span>(<span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x)), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">n =</span> <span class="dv">1000</span>, <span class="at">from =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">to =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<p>3.7</p>
<p>写一个用接受-拒绝法从Beta(a,
b)分布中生成随机样本的R语言函数，并生成Beta(3,
2)分布的大小为1000的随机样本，然后绘制样本的直方图并叠加Beta(3,
2)的理论密度</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer 3</h2>
<p>基本思想： </p>
<p>1.选择均匀分布作为提议分布生成候选样本x </p>
<p>2.计算目标分布Beta(a, b)在候选样本x处的概率密度函数值（<span class="math inline">\(x^{(a-1)} * (1-x)^{(b-1)}\)</span>） </p>
<p>3.从均匀分布生成一个随机数，范围在 [0, 1]，用来判断是否接受候选样本 x
</p>
<p>4.如果生成的随机数小于等于目标分布在 x
处的概率密度函数值，我们就接受样本 x，将其保存在 samples 向量中,反之拒绝
</p>
<p>5.重复上述步骤，直到生成所需数量的样本 </p>
<p>代码如下： </p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># 密度函数 Beta(a, b)</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>beta_density <span class="ot">&lt;-</span> <span class="cf">function</span>(x, a, b) {</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  <span class="fu">ifelse</span>(x <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> x <span class="sc">&lt;=</span> <span class="dv">1</span>, x<span class="sc">^</span>(a<span class="dv">-1</span>) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>) <span class="sc">*</span> (<span class="fu">gamma</span>(a<span class="sc">+</span>b) <span class="sc">/</span> (<span class="fu">gamma</span>(a) <span class="sc">*</span> <span class="fu">gamma</span>(b))), <span class="dv">0</span>)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>}</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co"># 接受-拒绝法生成 Beta(a, b) 分布的随机样本</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>accept_reject_sampling <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b) {</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>  </span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>    accept <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>    </span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>    <span class="cf">while</span> (<span class="sc">!</span>accept) {</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)  <span class="co"># 生成均匀分布的随机变量</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>      u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)  <span class="co"># 生成均匀分布的随机变量</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a>      </span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a>      <span class="co"># 如果 u &lt;= f(x)，则接受 x</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a>      <span class="cf">if</span> (u <span class="sc">&lt;=</span> <span class="fu">beta_density</span>(x, a, b)) {</span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a>        samples[i] <span class="ot">&lt;-</span> x</span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a>        accept <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a>      }</span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a>    }</span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a>  }</span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a>  </span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a>}</span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a></span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a><span class="co"># 生成 Beta(3, 2) 分布的随机样本</span></span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">accept_reject_sampling</span>(n, a, b)</span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a></span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a><span class="co"># 绘制直方图和理论密度曲线</span></span>
<span id="cb9-35"><a href="#cb9-35" tabindex="-1"></a><span class="fu">hist</span>(samples, <span class="at">breaks =</span> <span class="dv">50</span>,  <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;Beta(3, 2)&quot;</span>)</span>
<span id="cb9-36"><a href="#cb9-36" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">beta_density</span>(x, a, b), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">n =</span> <span class="dv">1001</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-4" class="section level2">
<h2>Question 4</h2>
<p>3.9</p>
<p>标准化的Epanechnikov核密度函数是一个对称的密度函数，定义为 <span class="math display">\[f_e(x)=\frac{3}{4}\left(1-x^2\right), \quad|x|
\leq 1\]</span> Devroye和Györfi给出了以下用于模拟该分布的算法：</p>
<p>1.生成独立同分布的 U1、U2、U3 ∼ Uniform(−1, 1)。 </p>
<p>2.如果 |U3| ≥ |U2| 且 |U3| ≥ |U1|，则输出 U2；否则输出 U3。 </p>
<p>编写一个函数来生成<span class="math inline">\(f_e(x)\)</span>的随机变量，并构建一个大样本的直方图密度估计。</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer 4</h2>
<p>基本思想：</p>
<p>1.定义密度函数</p>
<p>2.根据题目中的算法编写一个函数来生成<span class="math inline">\(f_e(x)\)</span>的随机变量</p>
<p>2.1 生成三个独立同分布的随机变量U1、U2和U3，其取值范围为[-1,
1]，符合均匀分布Uniform(-1, 1)</p>
<p>2.2 比较绝对值大小：首先比较|U3|和|U2|的绝对值，如果|U3| ≥
|U2|，则进一步比较|U3|和|U1|的绝对值</p>
<p>2.3 输出结果：如果|U3| ≥ |U2| 且 |U3| ≥
|U1|，则输出U2作为随机变量，否则输出U3。</p>
<p>3.生成一个大样本的随机变量</p>
<p>4.构建直方图密度估计</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># 定义密度函数 f_e(x)</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>f_e <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">ifelse</span>(<span class="fu">abs</span>(x) <span class="sc">&lt;=</span> <span class="dv">1</span>, <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> x<span class="sc">^</span><span class="dv">2</span>), <span class="dv">0</span>)}</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co"># 生成f_e(x)随机变量的算法</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>generate_variable <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>  U1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>  U2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>  U3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>  </span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">abs</span>(U3) <span class="sc">&gt;=</span> <span class="fu">abs</span>(U2) <span class="sc">&amp;&amp;</span> <span class="fu">abs</span>(U3) <span class="sc">&gt;=</span> <span class="fu">abs</span>(U1)) {</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>    <span class="fu">return</span>(U2)</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>    <span class="fu">return</span>(U3)</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>  }</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>}</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="co"># 生成一组大样本随机变量</span></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 生成随机变量的数量</span></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a>variables <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n, <span class="fu">generate_variable</span>())</span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a><span class="co"># 统计随机变量的分布</span></span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a><span class="fu">hist</span>(variables,<span class="at">breaks =</span> <span class="dv">100</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>)(<span class="dv">1</span><span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">f_e</span>(x), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">n =</span> <span class="dv">1001</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-5" class="section level2">
<h2>Question 5</h2>
<p>3.10</p>
<p>证明练习3.9中生成的随机数符合<span class="math inline">\(f_e(x)=\frac{3}{4}\left(1-x^2\right), \quad|x|
\leq 1\)</span></p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer 5</h2>
<p>3.9中给出的算法为：</p>
<p>1.从区间(0, 1)上生成独立同分布的随机变量U1、U2、U3；</p>
<p>2.如果$U1   U2  并且  U3   U1 <span class="math inline">\(，选取\)</span>U2 <span class="math inline">\(；否则，选取\)</span>U3 $。</p>
<p>等同于：</p>
<p>1.从区间(0, 1)上生成独立同分布的随机变量X1、X2、X3；</p>
<p>2.以相等的概率随机选择最小的两个Xi中的一个，将其记为X；</p>
<p>3.以1/2的概率随机取反X。</p>
<p>这个算法可以归结为计算X的分布 </p>
<p>设<span class="math inline">\(0\leqslant t\leqslant 1 ，则 X
\leqslant t\)</span>可分为两个不相交的可能性：</p>
<p>1.至少有两个<span class="math inline">\(X_i\)</span>位于区间[0,
t],则二项式概率为： <span class="math display">\[
\binom{3}{2}t^2(1-t)+\binom{3}{3}t^3 = t^2(3-2t)\]</span>
2.只有一个<span class="math inline">\(X_i\)</span>位于区间[0,
t],而且是随机选择的那个，则二项式概率为： <span class="math display">\[
\binom{3}{1}t^2(1-t)\times\frac{1}{2} =
\frac{3}{2}t\times(1-t)^2\]</span> 因此，分布函数为： <span class="math display">\[ F(t) = t^2(3-2t)+\frac{3}{2}t\times(1-t)^2 =
\frac{3}{2}t - \frac{1}{2}t^3\]</span> 则密度函数为： <span class="math display">\[f(t)=F(t)^{&#39;}=\frac{3}{2}(1-t^2)\]</span>
通过对称性将<span class="math inline">\(f(t)\)</span>扩展到 [-1,1] ,因为
<span class="math inline">\((-t)^2=t^2\)</span> , 所以<span class="math inline">\(f(t)\)</span>关于 0 对称，但需要将将<span class="math inline">\(f(t)\)</span>的值减半以保持其归一化，即 <span class="math display">\[
f_e(t)=\frac{1}{2}\left(\frac{3}{2}\left(1-t^2\right)\right)=\frac{3}{4}\left(1-t^2\right),\lvert
t \lvert \ \leqslant \ 1
\]</span></p>
</div>
<div id="hw2" class="section level2">
<h2>HW2</h2>
</div>
<div id="question-1-1" class="section level2">
<h2>Question 1</h2>
<p>找一个最优的<span class="math inline">\(l/d=\rho\)</span>，使得<span class="math inline">\(\hat{\pi}=\frac{2l}{d\hat{p}}\)</span>，<span class="math inline">\(\hat{p}=\frac{n}{m}\)</span>的渐进方差最小? (<span class="math inline">\(m \sim B(n, p)\)</span>，使用<span class="math inline">\(\delta\)</span>方法)</p>
</div>
<div id="answer-1-1" class="section level2">
<h2>Answer 1</h2>
<p><span class="math inline">\(由题知\hat{\pi} =
\frac{2l}{d\hat{p}}，根据\delta方法可得：\)</span> <span class="math display">\[
Var(\hat\pi) = Var(\frac{2l}{d\hat{p}}) \approx
(\frac{d\hat{\pi}}{d\hat{p}})Var(\hat{p})=(-\frac{2l}{d{\hat{p}}^2})Var(\hat{p})
\]</span></p>
<p><span class="math inline">\(同理，由\hat{p}=\frac{n}{m}, m \sim B(n,
p)，可得：\)</span> <span class="math display">\[
Var(\hat{p}) = Var(\frac{n}{m}) \approx
(\frac{d\hat{p}}{dm})Var(m)=(-\frac{n}{m^2})Var(m)=-\frac{n^2p(1-p)}{m^2}
\]</span></p>
<p>综上， <span class="math display">\[
Var(\hat\pi) =(-\frac{2l}{d{\hat{p}}^2})(-\frac{n^2p(1-p)}{m^2})
\]</span> 所以，当l/d=ρ=1时，<span class="math inline">\(\hat\pi\)</span> 的渐进方差最小</p>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<p>取三个不同的<span class="math inline">\(\rho\)</span>（<span class="math inline">\(0 \leq \rho \leq
1，其中一个为\rho_{min}\)</span>），用MC方法比较三个<span class="math inline">\(\rho\)</span>下<span class="math inline">\(\hat\pi\)</span>的方差。(n = 106,重复模拟的次数 K
= 100)</p>
</div>
<div id="answer-2-1" class="section level2">
<h2>Answer 2</h2>
<p><span class="math inline">\(\rho_{min}=1,另两个分别取0.5，0.8\)</span></p>
<p>R语言代码如下：</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">106</span>  <span class="co"># 样本数量</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">100</span>  <span class="co"># 重复模拟次数</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>rho_1 <span class="ot">&lt;-</span> <span class="fl">1.0</span>  <span class="co"># 第一个rho值</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>rho_2 <span class="ot">&lt;-</span> <span class="fl">0.5</span>  <span class="co"># 第二个rho值</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>rho_3 <span class="ot">&lt;-</span> <span class="fl">0.8</span>  <span class="co"># 第三个rho值</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co"># 定义函数，用于模拟pi值</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>simulate_pi <span class="ot">&lt;-</span> <span class="cf">function</span>(rho) {</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>  pi_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>(K)</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K) {</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>    <span class="co"># 模拟m的值，使用binom函数从二项分布中抽样</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, rho)</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>    <span class="co"># 计算p_hat和pi_hat</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>    p_hat <span class="ot">&lt;-</span> n <span class="sc">/</span> m</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>    pi_hat <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> rho <span class="sc">*</span> p_hat</span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>    <span class="co"># 将得到的pi_hat存储在pi_values中</span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>    pi_values[i] <span class="ot">&lt;-</span> pi_hat</span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>  }</span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a>  <span class="fu">return</span>(pi_values)</span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>}</span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a><span class="co"># 分别模拟三个rho值下的pi，并计算方差</span></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a>pi_values_1 <span class="ot">&lt;-</span> <span class="fu">simulate_pi</span>(rho_1)</span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a>var_pi_1 <span class="ot">&lt;-</span> <span class="fu">var</span>(pi_values_1)</span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a></span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a>pi_values_2 <span class="ot">&lt;-</span> <span class="fu">simulate_pi</span>(rho_2)</span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a>var_pi_2 <span class="ot">&lt;-</span> <span class="fu">var</span>(pi_values_2)</span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a></span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a>pi_values_3 <span class="ot">&lt;-</span> <span class="fu">simulate_pi</span>(rho_3)</span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a>var_pi_3 <span class="ot">&lt;-</span> <span class="fu">var</span>(pi_values_3)</span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a></span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Variance of pi for rho 1:&quot;</span>, var_pi_1))</span></code></pre></div>
<pre><code>## [1] &quot;Variance of pi for rho 1: 0&quot;</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Variance of pi for rho 2:&quot;</span>, var_pi_2))</span></code></pre></div>
<pre><code>## [1] &quot;Variance of pi for rho 2: 0.0420703210432216&quot;</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Variance of pi for rho 3:&quot;</span>, var_pi_3))</span></code></pre></div>
<pre><code>## [1] &quot;Variance of pi for rho 3: 0.00714760919004316&quot;</code></pre>
</div>
<div id="question-3-1" class="section level2">
<h2>Question 3</h2>
<p>1.使用对偶变量法计算 <span class="math inline">\(\theta =
\int_{a}^{b} e^x dx\)</span> 的 <span class="math inline">\(Cov(e^U,
e^{1−U})\)</span> 和 <span class="math inline">\(Var(e^U +
e^{1−U})\)</span> , 其中 <span class="math inline">\(U ∼
Uniform(0,1)\)</span> 。</p>
<p>2.与简单MC相比，使用对偶变量法可以减少 <span class="math inline">\(\hat{\theta}\)</span> 方差的百分比是多少？</p>
</div>
<div id="answer-3-1" class="section level2">
<h2>Answer 3</h2>
<p>1.使用对偶变量法计算 <span class="math inline">\(\theta =
\int_{a}^{b} e^x dx\)</span> 的 <span class="math inline">\(Cov(e^U,
e^{1−U})\)</span> 和 <span class="math inline">\(Var(e^U +
e^{1−U})\)</span> , 其中 <span class="math inline">\(U ∼
Uniform(0,1)\)</span></p>
<p>（1）计算协方差<span class="math inline">\(Cov(e^U, e^{1−U})\)</span>
由<span class="math inline">\(Cov(x_1, x_2) =
E(x_1x_2)-E(x_1)E(x_2)\)</span>可得： <span class="math display">\[Cov(e^U, e^{1−U}) =
E(e^Ue^{1−U})-E(e^U)E(e^{1−U})\]</span> 由<span class="math inline">\(U
∼ Uniform(0,1)\)</span>可得：</p>
<p><span class="math display">\[
E(e^U)=E(e^{1−U})=\int_{0}^{1} e^x dx=e-1
\]</span></p>
<p><span class="math display">\[
\begin{align*}
E(e^Ue^{1−U})=&amp;\int_{0}^{1} e^x e^{1-x} dx\\
              =&amp;\int_{0}^{1} e^{1-x} de^x\\
              \overset{令t=e^x}{=}&amp;\int_{1}^{e} \frac{e}{t} dt\\
              =&amp; elne-0=e\\
\end{align*}
\]</span> 综上， <span class="math display">\[Cov(e^U,
e^{1−U})=e-(e-1)^2=-0.23421061\]</span></p>
<p>（2）计算方差值<span class="math inline">\(Var(e^U +
e^{1−U})\)</span></p>
<p>由<span class="math inline">\(Var(X)=E(X^2)-[E(X)]^2\)</span>可得
<span class="math display">\[
\begin{align*}
{Var}(e^U) &amp;= E(e^{2U}) - [E(e^U)]^2 \\
&amp;= \int_{0}^{1} e^{2x}dx - \left(\int_{0}^{1} e^{x}dx\right)^2 \\
&amp;= \frac{4e - e^2 - 3}{2} = {Var}(e^{1-U})
\end{align*}
\]</span> 故， <span class="math display">\[
\begin{align*}
Var(e^U + e^{1-U}) =&amp; Var(e^U)+Var(e^{1-U})+2Cov(e^U, e^{1−U})\\
                    =&amp;2 \times \frac{4e-e^2-3}{2}+2 \times
[e-(e-1)^2]\\
                    =&amp;10e - 3e^2 - 5\\
                    =&amp;0.01564998\\
\end{align*}
\]</span></p>
<p>2.减少的方差百分比为：</p>
<p><span class="math display">\[
\frac{Var(e^U)-Var(\frac{e^U + e^{1-U}}{2})}{Var(e^U)}
=\frac{\frac{4e-e^2-3}{2}-\frac{10e - 3e^2 - 5}{2}}{\frac{4e-e^2-3}{2}}
=96.767007\%
\]</span></p>
</div>
<div id="question-4-1" class="section level2">
<h2>Question 4</h2>
<p>使用蒙特卡罗模拟法，用反差变量法和简单蒙特卡罗法估算 <span class="math inline">\(\theta\)</span>。使用反义变量计算方差减少百分比的经验估计值。</p>
</div>
<div id="answer-4-1" class="section level2">
<h2>Answer 4</h2>
<p>1.使用蒙特卡罗模拟法，分别用对偶变量法和简单蒙特卡罗法估计<span class="math inline">\(\theta= \int_{a}^{b} e^x dx\)</span>。</p>
<p>(1)使用简单蒙特卡罗法进行估计：</p>
<p>核心步骤：</p>
<p>a.设置模拟中的样本数量 <span class="math inline">\(m\)</span>。</p>
<p>b.生成 <span class="math inline">\(m\)</span>个在区间 <span class="math inline">\([a, b]\)</span> 上均匀分布的随机变量 <span class="math inline">\(x_1, x_2, ..., x_m\)</span>。</p>
<p>c.计算函数值 <span class="math inline">\(f(x_i) =
e^{x_i}\)</span>。</p>
<p>d.计算 <span class="math inline">\(\theta\)</span>
的简单蒙特卡罗法估计值：<span class="math inline">\(\theta_{\text{simple}} = \frac{b-a}{m}
\sum_{i=1}^{m} f(x_i)\)</span>。</p>
<p>(2)使用对偶变量法进行估计：</p>
<p>核心步骤：</p>
<p>a.设置模拟中的样本数量 <span class="math inline">\(m\)</span>。</p>
<p>b.生成 <span class="math inline">\(m\)</span> 个在区间 <span class="math inline">\([0, 1]\)</span> 上均匀分布的随机变量 <span class="math inline">\(u_1, u_2, ..., u_m\)</span>。</p>
<p>c.计算反义变量 <span class="math inline">\(v_i = 1 -
u_i\)</span>。</p>
<p>d.计算 <span class="math inline">\(x_i = a + (b-a)u_i\)</span> 和
<span class="math inline">\(y_i = e^{x_i}\)</span>。</p>
<p>e.计算 <span class="math inline">\(\theta\)</span>
的反义变量法估计值： <span class="math display">\[\theta_{\text{antithetic}} = \frac{b-a}{2m}
\left(\sum_{i=1}^{m} y_i + \sum_{i=1}^{m}
e^{a+(b-a)v_i}\right)\]</span></p>
<p>2.计算方差减少百分比的经验估计：</p>
<p>核心步骤：</p>
<p><span class="math display">\[
方差减少百分比的经验估计值=\frac{简单蒙特卡罗法的方差
-对偶变量法的方差}{简单蒙特卡罗法的方差}
\]</span></p>
<p>下面是使用R语言实现上述过程的示例代码：</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 样本数量</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co"># 简单蒙特卡罗法估计</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>T1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(U) </span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>theta_simple <span class="ot">&lt;-</span> <span class="fu">mean</span>(T1)</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="co"># 对偶变量法估计</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>T2 <span class="ot">&lt;-</span> (<span class="fu">exp</span>(U) <span class="sc">+</span> <span class="fu">exp</span>(<span class="dv">1</span> <span class="sc">-</span> U))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>theta_antithetic <span class="ot">&lt;-</span> <span class="fu">mean</span>(T2)</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co"># 计算方差减少百分比的经验估计</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>var_simple <span class="ot">&lt;-</span> <span class="fu">var</span>(T1)</span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>var_antithetic <span class="ot">&lt;-</span> <span class="fu">var</span>(T2)</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>var_reduction_percentage <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> var_antithetic <span class="sc">/</span> var_simple) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="co"># 打印结果</span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Simple Monte Carlo estimate of theta:&quot;</span>, theta_simple, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Simple Monte Carlo estimate of theta: 1.712061</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Antithetic variate estimate of theta:&quot;</span>, theta_antithetic, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Antithetic variate estimate of theta: 1.717788</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Percent reduction in variance:&quot;</span>, var_reduction_percentage, <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Percent reduction in variance: 98.36555 %</code></pre>
</div>
<div id="hw3" class="section level2">
<h2>HW3</h2>
</div>
<div id="question-1-2" class="section level2">
<h2>Question 1</h2>
<p><span class="math inline">\(Var(\hat{\theta^{M}})=\frac{1}{Mk}\sum\nolimits_{i=1}^k
\sigma_i^2+Var(\theta_I)=Var(\hat{\theta}^S)+Var(\theta_I)\)</span>，
where <span class="math inline">\(\theta_i=E[g(U)|I=i]\)</span>,<span class="math inline">\(\sigma_i^2=Var[g(U)|I=i]\)</span> and I takes
uniform distribution over<span class="math inline">\({1, ...,
k}\)</span></p>
<p>Proof that if <span class="math inline">\(g\)</span> is a continuous
function over <span class="math inline">\((a,b)\)</span>, then <span class="math inline">\(\frac{Var(\hat{\theta^{S}})}{Var(\hat{\theta^{M}})}
\rightarrow 0\)</span> as $b_i - a_i $ for all <span class="math inline">\(i = 1,...,k\)</span>.</p>
</div>
<div id="answer-1-2" class="section level2">
<h2>Answer 1</h2>
<p><span class="math inline">\(Var(\hat{\theta^{M}})=\frac{1}{Mk}\sum\nolimits_{i=1}^k
\sigma_i^2+Var(\theta_I)=Var(\hat{\theta}^S)+Var(\theta_I)\)</span>，
其中<span class="math inline">\(\theta_i=E[g(U)|I=i]\)</span>,<span class="math inline">\(\sigma_i^2=Var[g(U)|I=i]\)</span>,<span class="math inline">\([P(I=i) = \frac{1}{k}, \quad \text{for } i = 1, 2,
..., k]\)</span></p>
<p>证明：如果函数<span class="math inline">\(g\)</span>在<span class="math inline">\((a,b)\)</span>上连续，则对于所有的<span class="math inline">\(i = 1,...,k\)</span>,有当$b_i - a_i <span class="math inline">\(,\)</span> $</p>
<p>由<span class="math inline">\(Var(\hat{\theta^M}) =
\frac{1}{Mk}\sum_{i=1}^k \sigma_i^2 + \frac{1}{M}Var(\theta_I)\)</span>,
<span class="math inline">\(Var(\hat{\theta^S}) =
\frac{1}{M}\sum_{i=1}^k \frac{1}{k} \sigma_i^2\)</span>以及<span class="math inline">\(\text{Var}(\theta_I) = \sum_{i=1}^k
\left(\frac{1}{k}\right) \left(\theta_i -
\bar{\theta}\right)^2\)</span></p>
<p>可得： <span class="math display">\[
\frac{Var(\hat{\theta^S})}{Var(\hat{\theta^M})}
= \frac{\frac{1}{Mk}\sum_{i=1}^k \sigma_i^2}{\frac{1}{Mk}\sum_{i=1}^k
\sigma_i^2 + \sum_{i=1}^k \left(\frac{1}{k}\right) \left(\theta_i -
\bar{\theta}\right)^2}
\]</span></p>
<p>在极限情况下，当 <span class="math inline">\(b_i - a_i \rightarrow
0\)</span> 时，每个 <span class="math inline">\(\sigma_i^2\)</span>
也趋近于零。因此，我们可以得到： <span class="math display">\[
\lim_{b_i - a_i \rightarrow
0}\frac{Var(\hat{\theta^S})}{Var(\hat{\theta^M})} =
\frac{\frac{0}{k}}{\frac{0}{k} + \sum_{i=1}^k \left(\frac{1}{k}\right)
\left(\theta_i - \bar{\theta}\right)^2}=0
\]</span></p>
</div>
<div id="question-2-2" class="section level2">
<h2>Question 2</h2>
<p>5.13</p>
<p>Find two importance functions f1 and f2 that are supported on <span class="math inline">\((1, \infty)\)</span> and are ‘close’ to <span class="math display">\[
g(x)=\frac{x^2}{\sqrt{2\pi}} e^{-x^2/2}, x&gt;1
\]</span> Which of your two importance functions should produce the
smaller variance in estimating <span class="math display">\[
f_1(x) = \frac{1}{{\sqrt{2\pi}}} e^{-\frac{{(x-1)^2}}{2}}
\]</span> by importance sampling? Explain.</p>
</div>
<div id="answer-2-2" class="section level2">
<h2>Answer 2</h2>
<p>寻找在<span class="math inline">\((1,\infty)\)</span>上有定义并且与
<span class="math display">\[
g(x)=\frac{x^2}{\sqrt{2\pi}} e^{-x^2/2}, x&gt;1
\]</span> 的两个重要函数<span class="math inline">\(f_1\)</span>和<span class="math inline">\(f_2\)</span>，分析哪一个在使用重要抽样估计时与目标函数<span class="math inline">\(\int_{1}^{\infty} \frac{{x^2}}{{\sqrt{2\pi}}}
e^{-\frac{{x^2}}{2}} dx\)</span> 有更小的方差？</p>
<p>选择两个重要函数：</p>
<p>1.瑞利分布的概率密度函数f1 <span class="math display">\[
f_1(x) = \frac{x}{\sigma^2} exp(-\frac{x^2}{2 \sigma^2})
\]</span> 2.正态分布的概率密度函数（σ=1）f2 <span class="math display">\[
f_2(x) = \frac{1}{\sqrt{2\pi}}exp(-\frac{(x - \mu)^2}{2})
\]</span></p>
<p>R代码如下：</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># 生成一组 x 值</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">11</span>,<span class="fl">0.1</span>)</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>g <span class="ot">=</span> <span class="cf">function</span> (x) {</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>  x <span class="sc">^</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>}</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>f1 <span class="ot">=</span> <span class="cf">function</span>(x, sigma){</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>  x<span class="sc">/</span>(sigma)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>}</span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a>f2 <span class="ot">=</span> <span class="cf">function</span>(x, μ){</span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>(x <span class="sc">-</span> μ)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a>}</span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a></span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a><span class="co"># 计算目标函数在x值上的概率密度值</span></span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a>f <span class="ot">=</span> <span class="fu">g</span>(x)</span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a><span class="co"># 计算瑞利分布在x值上计算分布参数为1.5的概率密度值</span></span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a>f1 <span class="ot">=</span><span class="fu">f1</span>(x,  <span class="fl">1.5</span>)</span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a><span class="co"># 计算正态分布在x值上均值参数为1.5的概率密度值</span></span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a>f2 <span class="ot">=</span> <span class="fu">f2</span>(x, <span class="fl">1.5</span>)</span>
<span id="cb23-23"><a href="#cb23-23" tabindex="-1"></a></span>
<span id="cb23-24"><a href="#cb23-24" tabindex="-1"></a>lim <span class="ot">=</span> <span class="fu">max</span>(<span class="fu">c</span>(f, f1, f2))</span>
<span id="cb23-25"><a href="#cb23-25" tabindex="-1"></a><span class="co"># 绘制 g(x) 的概率密度函数曲线</span></span>
<span id="cb23-26"><a href="#cb23-26" tabindex="-1"></a><span class="fu">plot</span>(x, f, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">main=</span> <span class="st">&quot;&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, lim), <span class="at">lwd =</span> w)</span>
<span id="cb23-27"><a href="#cb23-27" tabindex="-1"></a></span>
<span id="cb23-28"><a href="#cb23-28" tabindex="-1"></a><span class="co"># 分别绘制 瑞利分布 和 正态 的概率密度函数曲线</span></span>
<span id="cb23-29"><a href="#cb23-29" tabindex="-1"></a><span class="fu">lines</span>(x, f1, <span class="at">lwd =</span> w, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, lim))</span>
<span id="cb23-30"><a href="#cb23-30" tabindex="-1"></a><span class="fu">lines</span>(x, f2, <span class="at">lwd =</span> w,  <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, lim))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co"># 正态分布的概率密度函数f2更接近目标函数</span></span></code></pre></div>
<p>有图可观察出：正态分布的概率密度函数f2更接近目标函数</p>
</div>
<div id="question-3-2" class="section level2">
<h2>Question 3</h2>
<p>5.14</p>
<p>Obtain a Monte Carlo estimate of <span class="math display">\[
\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}} e^{-x^2/2} dx
\]</span> by importance sampling.</p>
</div>
<div id="answer-3-2" class="section level2">
<h2>Answer 3</h2>
<p>通过重要性采样方法得到下面表达式的蒙特卡洛估计 <span class="math display">\[
\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}} e^{-x^2/2} dx
\]</span></p>
<p>R代码如下：</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>sigma.rayleigh <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>mean <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span> (x) {</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>  x <span class="sc">^</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>}</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a>f1 <span class="ot">=</span> <span class="cf">function</span> (x) {</span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>  (x <span class="sc">/</span> sigma.rayleigh<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sigma.rayleigh<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a>}</span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span> (x) {</span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a>  <span class="fu">dnorm</span>(x, <span class="at">mean =</span> mean) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a>}</span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a>rf1 <span class="ot">&lt;-</span> <span class="cf">function</span> () {</span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a>  <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> sigma.rayleigh<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="fu">runif</span>(n))) <span class="sc">*</span> (<span class="fu">runif</span>(n) <span class="sc">&lt;</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb25-19"><a href="#cb25-19" tabindex="-1"></a>}</span>
<span id="cb25-20"><a href="#cb25-20" tabindex="-1"></a></span>
<span id="cb25-21"><a href="#cb25-21" tabindex="-1"></a>rf2 <span class="ot">&lt;-</span> <span class="cf">function</span> () {</span>
<span id="cb25-22"><a href="#cb25-22" tabindex="-1"></a>  <span class="fu">rnorm</span>(n, <span class="at">mean =</span> mean)</span>
<span id="cb25-23"><a href="#cb25-23" tabindex="-1"></a>}</span>
<span id="cb25-24"><a href="#cb25-24" tabindex="-1"></a></span>
<span id="cb25-25"><a href="#cb25-25" tabindex="-1"></a>is.rayleigh <span class="ot">&lt;-</span> <span class="cf">function</span> () {</span>
<span id="cb25-26"><a href="#cb25-26" tabindex="-1"></a>  xs <span class="ot">&lt;-</span> <span class="fu">rf1</span>()</span>
<span id="cb25-27"><a href="#cb25-27" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(<span class="fu">g</span>(xs)<span class="sc">/</span><span class="fu">f1</span>(xs), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))  </span>
<span id="cb25-28"><a href="#cb25-28" tabindex="-1"></a>}</span>
<span id="cb25-29"><a href="#cb25-29" tabindex="-1"></a></span>
<span id="cb25-30"><a href="#cb25-30" tabindex="-1"></a>is.norm <span class="ot">&lt;-</span> <span class="cf">function</span> () {</span>
<span id="cb25-31"><a href="#cb25-31" tabindex="-1"></a>  xs <span class="ot">&lt;-</span> <span class="fu">rf2</span>()</span>
<span id="cb25-32"><a href="#cb25-32" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(<span class="fu">g</span>(xs)<span class="sc">/</span><span class="fu">f2</span>(xs), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))  </span>
<span id="cb25-33"><a href="#cb25-33" tabindex="-1"></a>}</span>
<span id="cb25-34"><a href="#cb25-34" tabindex="-1"></a></span>
<span id="cb25-35"><a href="#cb25-35" tabindex="-1"></a>theta1 <span class="ot">&lt;-</span> <span class="fu">is.rayleigh</span>()</span>
<span id="cb25-36"><a href="#cb25-36" tabindex="-1"></a>theta2 <span class="ot">&lt;-</span> <span class="fu">is.norm</span>()</span>
<span id="cb25-37"><a href="#cb25-37" tabindex="-1"></a>truth <span class="ot">&lt;-</span> <span class="fl">0.400626</span></span>
<span id="cb25-38"><a href="#cb25-38" tabindex="-1"></a></span>
<span id="cb25-39"><a href="#cb25-39" tabindex="-1"></a>theta1  <span class="co"># 输出 theta1 的值</span></span></code></pre></div>
<pre><code>## [1] 0.325685</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>theta2  <span class="co"># 输出 theta2 的值</span></span></code></pre></div>
<pre><code>## [1] 0.580048</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>truth   <span class="co"># 输出真实值</span></span></code></pre></div>
<pre><code>## [1] 0.400626</code></pre>
</div>
<div id="question-4-2" class="section level2">
<h2>Question 4</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13
and compare it with the result of Example 5.10.</p>
</div>
<div id="answer-4-2" class="section level2">
<h2>Answer 4</h2>
<p>下面是使用R语言实现上述过程的示例代码:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co"># 总抽样数</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># 重复抽样的次数</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># 分层数</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a> <span class="co"># 使用逆变换方法生成具有密度函数 f_k(x) 的随机数</span></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>inv_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b) {</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>a) <span class="sc">-</span> (<span class="fu">exp</span>(<span class="sc">-</span>a) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>b)) <span class="sc">*</span> <span class="fu">runif</span>(n))</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>}</span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>res3 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(o) {</span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">inv_fun</span>(M, <span class="dv">0</span>, <span class="dv">1</span>) <span class="co"># 生成满足密度函数 f(x) 的随机数</span></span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>  M1 <span class="ot">&lt;-</span> <span class="fu">mean</span>((<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>))  <span class="co"># 使用重要抽样方法计算 M1 的估计值</span></span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>  M2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k) <span class="co"># 使用重要抽样方法计算 M1 的估计值</span></span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(k <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a>    a <span class="ot">&lt;-</span> j <span class="sc">/</span> k</span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a>    b <span class="ot">&lt;-</span> (j <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> k</span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a>    xj <span class="ot">&lt;-</span> <span class="fu">inv_fun</span>(M <span class="sc">/</span> k, a, b)  <span class="co"># 生成满足密度函数 f_j(x) 的随机数</span></span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a>    M2[j <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>((<span class="fu">exp</span>(<span class="sc">-</span>a) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>b)) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> xj<span class="sc">^</span><span class="dv">2</span>))  <span class="co"># 使用分层重要抽样方法计算 M2 的估计值</span></span>
<span id="cb31-20"><a href="#cb31-20" tabindex="-1"></a>  }</span>
<span id="cb31-21"><a href="#cb31-21" tabindex="-1"></a>  <span class="fu">c</span>(M1, <span class="fu">sum</span>(M2)) <span class="co"># 使用分层重要抽样方法计算 M2 的估计值</span></span>
<span id="cb31-22"><a href="#cb31-22" tabindex="-1"></a>})</span>
<span id="cb31-23"><a href="#cb31-23" tabindex="-1"></a></span>
<span id="cb31-24"><a href="#cb31-24" tabindex="-1"></a></span>
<span id="cb31-25"><a href="#cb31-25" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">var</span>(res3[<span class="dv">1</span>, ]), <span class="fu">var</span>(res3[<span class="dv">2</span>, ])) <span class="co"># 使用分层重要抽样方法计算 M2 的估计值</span></span></code></pre></div>
<pre><code>## [1] 9.148353e-07 3.264777e-08</code></pre>
</div>
<div id="question-5-1" class="section level2">
<h2>Question 5</h2>
<p>6.5</p>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but
the sample data are non-normal. Then the probability that the confidence
interval covers the mean is not necessarily equal to 0.95. Use aMonte
Carlo experiment to estimate the coverage probability of the t-interval
for random samples of χ2(2) data with sample size n = 20. Compare your
t-interval results with the simulation results in Example 6.4. (The
t-interval should be more robust to departures from normality than the
interval for variance.)</p>
</div>
<div id="answer-5-1" class="section level2">
<h2>Answer 5</h2>
<p>问题要求我们使用蒙特卡洛实验来估计在非正态分布的样本数据上使用t区间进行均值估计的覆盖概率。即使用样本量为n=20的χ2(2)数据进行随机抽样。此外，我们还需要将所得到的t区间结果与示例6.4中的模拟结果进行比较，以验证t区间在面对非正态分布时比方差区间更具鲁棒性的特点。</p>
<p>R语言代码如下：</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>exercise_6_5 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">seed =</span> <span class="dv">123</span>) {</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>  c <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, n <span class="sc">-</span> <span class="dv">1</span>)  <span class="co"># t-分布的0.975分位数</span></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>  <span class="co"># 使用蒙特卡洛模拟计算t区间</span></span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a>  cv.t <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>m, <span class="at">FUN =</span> <span class="cf">function</span>(o) {</span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="dv">2</span>)  <span class="co"># 从卡方分布中生成样本数据x</span></span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)  <span class="co"># 均值的估计值</span></span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a>    se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(x))  <span class="co"># 标准误差的估计值</span></span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a>    <span class="fu">as.numeric</span>((m <span class="sc">-</span> c <span class="sc">*</span> se <span class="sc">/</span> <span class="fu">sqrt</span>(n) <span class="sc">&lt;</span> <span class="dv">2</span>) <span class="sc">&amp;</span> (m <span class="sc">+</span> c <span class="sc">*</span> se <span class="sc">/</span> <span class="fu">sqrt</span>(n) <span class="sc">&gt;</span> <span class="dv">2</span>))  <span class="co"># 置信区间</span></span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a>  })</span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a>  level1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(cv.t)  <span class="co"># 蒙特卡洛实验的平均值，即t区间的覆盖概率估计</span></span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a>  <span class="co"># 使用卡方区间估计方差的覆盖概率</span></span>
<span id="cb33-17"><a href="#cb33-17" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb33-18"><a href="#cb33-18" tabindex="-1"></a>  UCL <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="at">expr =</span> {</span>
<span id="cb33-19"><a href="#cb33-19" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="dv">2</span>)</span>
<span id="cb33-20"><a href="#cb33-20" tabindex="-1"></a>    (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">var</span>(x) <span class="sc">/</span> <span class="fu">qchisq</span>(alpha, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb33-21"><a href="#cb33-21" tabindex="-1"></a>  })</span>
<span id="cb33-22"><a href="#cb33-22" tabindex="-1"></a>  level2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(UCL <span class="sc">&gt;</span> <span class="dv">4</span>) <span class="sc">/</span> m</span>
<span id="cb33-23"><a href="#cb33-23" tabindex="-1"></a></span>
<span id="cb33-24"><a href="#cb33-24" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(level1, level2))</span>
<span id="cb33-25"><a href="#cb33-25" tabindex="-1"></a>}</span>
<span id="cb33-26"><a href="#cb33-26" tabindex="-1"></a></span>
<span id="cb33-27"><a href="#cb33-27" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">exercise_6_5</span>(<span class="dv">1012</span>)</span>
<span id="cb33-28"><a href="#cb33-28" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>##   level1 level2
## 1  0.908  0.794</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="co"># 我们可以看到结果远小于0.95，因此t-区间更稳健</span></span></code></pre></div>
</div>
<div id="question-6" class="section level2">
<h2>Question 6</h2>
<p>6.A</p>
<p>Use Monte Carlo simulation to investigate whether the empirical Type
I error rate of the t-test is approximately equal to the nominal
significance level α, when the sampled population is non-normal. The
t-test is robust to mild departures from normality. Discuss the
simulation results for the cases where the sampled population is</p>
<ol style="list-style-type: lower-roman">
<li>χ2(1), (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each
case, test H0 : μ = μ0 vs H0 : μ = μ0, where μ0 is the mean of χ2(1),
Uniform(0,2), and Exponential(1), respectively.</li>
</ol>
</div>
<div id="ansewr-6" class="section level2">
<h2>Ansewr 6</h2>
<p>使用蒙特卡洛模拟来调查当样本所代表的总体不服从正态分布时，t检验的经验第一类错误率是否大致等于指定的显著性水平α。t检验对轻微偏离正态性是鲁棒的。讨论以下情况下的模拟结果：(1)
<span class="math inline">\(χ^2(1)\)</span>分布; (2) 均匀分布<span class="math inline">\(U(0,2)\)</span>; (3) 指数分布<span class="math inline">\(exp(1)\)</span></p>
<p>R语言代码如下：</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>exercise_6_A <span class="ot">&lt;-</span> <span class="cf">function</span>(seed){</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co">#设置随机种子</span></span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>  </span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>  num<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">200</span>,<span class="dv">500</span>,<span class="dv">1000</span>)  <span class="co"># 不同样本大小</span></span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>  m<span class="ot">&lt;-</span><span class="dv">10000</span> <span class="co"># 迭代次数</span></span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a> </span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a>  error<span class="ot">&lt;-</span><span class="cn">NULL</span> <span class="co"># 存储结果的空向量</span></span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> num){</span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>    cv<span class="ot">&lt;-</span><span class="fu">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>) <span class="co"># 计算自由度为 n-1 的 t 分布上的临界值</span></span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a>   </span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a>   <span class="co"># 估计卡方分布的经验第一类错误率</span></span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a>  error_1<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>m,<span class="at">FUN =</span> <span class="cf">function</span>(o){</span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,<span class="dv">1</span>)</span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a>    m<span class="ot">&lt;-</span><span class="fu">mean</span>(x)</span>
<span id="cb36-15"><a href="#cb36-15" tabindex="-1"></a>    se<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x))</span>
<span id="cb36-16"><a href="#cb36-16" tabindex="-1"></a>    <span class="fu">abs</span>((m<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(n)<span class="sc">/</span>se)<span class="sc">&gt;=</span>cv</span>
<span id="cb36-17"><a href="#cb36-17" tabindex="-1"></a>}))  </span>
<span id="cb36-18"><a href="#cb36-18" tabindex="-1"></a>  </span>
<span id="cb36-19"><a href="#cb36-19" tabindex="-1"></a>  <span class="co"># 估计均匀分布的经验第一类错误率</span></span>
<span id="cb36-20"><a href="#cb36-20" tabindex="-1"></a>  error_2<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>m,<span class="at">FUN =</span> <span class="cf">function</span>(o){</span>
<span id="cb36-21"><a href="#cb36-21" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb36-22"><a href="#cb36-22" tabindex="-1"></a>    m<span class="ot">&lt;-</span><span class="fu">mean</span>(x)</span>
<span id="cb36-23"><a href="#cb36-23" tabindex="-1"></a>    se<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x))</span>
<span id="cb36-24"><a href="#cb36-24" tabindex="-1"></a>    <span class="fu">abs</span>((m<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(n)<span class="sc">/</span>se)<span class="sc">&gt;=</span>cv</span>
<span id="cb36-25"><a href="#cb36-25" tabindex="-1"></a>  }))  </span>
<span id="cb36-26"><a href="#cb36-26" tabindex="-1"></a>  <span class="co"># 估计指数分布的经验第一类错误率</span></span>
<span id="cb36-27"><a href="#cb36-27" tabindex="-1"></a>  error_3<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>m,<span class="at">FUN =</span> <span class="cf">function</span>(o){</span>
<span id="cb36-28"><a href="#cb36-28" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">rexp</span>(n,<span class="dv">1</span>)</span>
<span id="cb36-29"><a href="#cb36-29" tabindex="-1"></a>    m<span class="ot">&lt;-</span><span class="fu">mean</span>(x)</span>
<span id="cb36-30"><a href="#cb36-30" tabindex="-1"></a>    se<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x))</span>
<span id="cb36-31"><a href="#cb36-31" tabindex="-1"></a>    <span class="fu">abs</span>((m<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(n)<span class="sc">/</span>se)<span class="sc">&gt;=</span>cv </span>
<span id="cb36-32"><a href="#cb36-32" tabindex="-1"></a>}))  </span>
<span id="cb36-33"><a href="#cb36-33" tabindex="-1"></a>  <span class="co"># 将结果添加到结果矩阵中</span></span>
<span id="cb36-34"><a href="#cb36-34" tabindex="-1"></a>  error <span class="ot">&lt;-</span><span class="fu">cbind</span>(error,<span class="fu">c</span>(error_1,error_2,error_3))</span>
<span id="cb36-35"><a href="#cb36-35" tabindex="-1"></a>}</span>
<span id="cb36-36"><a href="#cb36-36" tabindex="-1"></a>  <span class="fu">colnames</span>(error)<span class="ot">&lt;-</span>num <span class="co"># 列名</span></span>
<span id="cb36-37"><a href="#cb36-37" tabindex="-1"></a>  <span class="fu">rownames</span>(error)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;χ2(1)&quot;</span>,<span class="st">&quot;U(0,2)&quot;</span>,<span class="st">&quot;exp(1)&quot;</span>) <span class="co"># 行名</span></span>
<span id="cb36-38"><a href="#cb36-38" tabindex="-1"></a>  <span class="fu">return</span>(error) <span class="co"># 返回结果矩阵               </span></span>
<span id="cb36-39"><a href="#cb36-39" tabindex="-1"></a>}</span>
<span id="cb36-40"><a href="#cb36-40" tabindex="-1"></a></span>
<span id="cb36-41"><a href="#cb36-41" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">exercise_6_A</span>(<span class="dv">123</span>) <span class="co"># 调用函数并传入随机种子</span></span>
<span id="cb36-42"><a href="#cb36-42" tabindex="-1"></a><span class="fu">print</span>(result)  <span class="co"># 打印结果矩阵</span></span></code></pre></div>
<pre><code>##            50    100    200    500   1000
## χ2(1)  0.0783 0.0657 0.0584 0.0496 0.0535
## U(0,2) 0.0492 0.0495 0.0460 0.0499 0.0493
## exp(1) 0.0655 0.0644 0.0515 0.0492 0.0518</code></pre>
</div>
<div id="hw4" class="section level2">
<h2>HW4</h2>
</div>
<div id="question-1-3" class="section level2">
<h2>Question 1</h2>
<p>考虑m=1000个假设，其中前95%个原假设成立，后5%个对应假设成立。在原假设之下，p值服从U(0,1)分布，在对立假设之下，p值服从Beta(0.1,1)分布(可用rbeta生成)。应用Bonferroni校正与B-H校正用于生成的m个p值(独立)(应用p.adjust),得到校正后的p值，与α=0.1比较确定是否拒绝原假设基于M=1000次模拟，可估计FWER，FDR，TPR输出到表格中：</p>
</div>
<div id="answer-1-3" class="section level2">
<h2>Answer 1</h2>
<p>根据题意，我们考虑了m=1000个假设，其中前95%个假设是原假设成立，后5%个假设是对立假设成立。在原假设下，p值服从U(0,1)分布；在对立假设下，p值服从Beta(0.1,1)分布。我们将应用Bonferroni校正和B-H校正对生成的m个独立p值进行校正，并与显著性水平α=0.1进行比较，以确定是否拒绝原假设。通过进行M=1000次模拟，我们可以估计FWER、FDR和TPR，并将结果输出到表格中。</p>
<p>R语言代码如下：</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="co"># 设置模拟参数</span></span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">1000</span>      <span class="co"># 模拟次数</span></span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>   <span class="co"># 显著性水平</span></span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a><span class="co"># 初始化结果变量</span></span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a>FWER_bonf <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># Bonferroni校正的FWER</span></span>
<span id="cb38-7"><a href="#cb38-7" tabindex="-1"></a>FDR_bh <span class="ot">&lt;-</span> <span class="dv">0</span>    <span class="co"># B-H校正的FDR</span></span>
<span id="cb38-8"><a href="#cb38-8" tabindex="-1"></a>TPR_bh <span class="ot">&lt;-</span> <span class="dv">0</span>    <span class="co"># B-H校正的TPR</span></span>
<span id="cb38-9"><a href="#cb38-9" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" tabindex="-1"></a><span class="co"># 进行模拟</span></span>
<span id="cb38-11"><a href="#cb38-11" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M) {</span>
<span id="cb38-12"><a href="#cb38-12" tabindex="-1"></a>  <span class="co"># 生成m个p值</span></span>
<span id="cb38-13"><a href="#cb38-13" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb38-14"><a href="#cb38-14" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)</span>
<span id="cb38-15"><a href="#cb38-15" tabindex="-1"></a>  </span>
<span id="cb38-16"><a href="#cb38-16" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb38-17"><a href="#cb38-17" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;=</span> <span class="fl">0.95</span>) {</span>
<span id="cb38-18"><a href="#cb38-18" tabindex="-1"></a>      p[j] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb38-19"><a href="#cb38-19" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb38-20"><a href="#cb38-20" tabindex="-1"></a>      p[j] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, <span class="fl">0.1</span>, <span class="dv">1</span>)</span>
<span id="cb38-21"><a href="#cb38-21" tabindex="-1"></a>    }</span>
<span id="cb38-22"><a href="#cb38-22" tabindex="-1"></a>  }</span>
<span id="cb38-23"><a href="#cb38-23" tabindex="-1"></a>  </span>
<span id="cb38-24"><a href="#cb38-24" tabindex="-1"></a>  <span class="co"># Bonferroni校正的p值</span></span>
<span id="cb38-25"><a href="#cb38-25" tabindex="-1"></a>  p_bonf <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb38-26"><a href="#cb38-26" tabindex="-1"></a>  </span>
<span id="cb38-27"><a href="#cb38-27" tabindex="-1"></a>  <span class="co"># B-H校正的p值</span></span>
<span id="cb38-28"><a href="#cb38-28" tabindex="-1"></a>  p_bh <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb38-29"><a href="#cb38-29" tabindex="-1"></a>  </span>
<span id="cb38-30"><a href="#cb38-30" tabindex="-1"></a>  <span class="co"># 计算拒绝原假设的情况</span></span>
<span id="cb38-31"><a href="#cb38-31" tabindex="-1"></a>  reject_bonf <span class="ot">&lt;-</span> p_bonf <span class="sc">&lt;=</span> alpha</span>
<span id="cb38-32"><a href="#cb38-32" tabindex="-1"></a>  reject_bh <span class="ot">&lt;-</span> p_bh <span class="sc">&lt;=</span> alpha</span>
<span id="cb38-33"><a href="#cb38-33" tabindex="-1"></a>  </span>
<span id="cb38-34"><a href="#cb38-34" tabindex="-1"></a>  <span class="co"># 计算统计指标</span></span>
<span id="cb38-35"><a href="#cb38-35" tabindex="-1"></a>  FWER_bonf <span class="ot">&lt;-</span> FWER_bonf <span class="sc">+</span> <span class="fu">sum</span>(reject_bonf)</span>
<span id="cb38-36"><a href="#cb38-36" tabindex="-1"></a>  FDR_bh <span class="ot">&lt;-</span> FDR_bh <span class="sc">+</span> <span class="fu">sum</span>(reject_bh <span class="sc">&amp;</span> <span class="sc">!</span>reject_bonf)</span>
<span id="cb38-37"><a href="#cb38-37" tabindex="-1"></a>  TPR_bh <span class="ot">&lt;-</span> TPR_bh <span class="sc">+</span> <span class="fu">sum</span>(reject_bh)</span>
<span id="cb38-38"><a href="#cb38-38" tabindex="-1"></a>}</span>
<span id="cb38-39"><a href="#cb38-39" tabindex="-1"></a></span>
<span id="cb38-40"><a href="#cb38-40" tabindex="-1"></a><span class="co"># 计算平均统计指标</span></span>
<span id="cb38-41"><a href="#cb38-41" tabindex="-1"></a>FWER_bonf <span class="ot">&lt;-</span> FWER_bonf <span class="sc">/</span> (M <span class="sc">*</span> m)</span>
<span id="cb38-42"><a href="#cb38-42" tabindex="-1"></a>FDR_bh <span class="ot">&lt;-</span> FDR_bh <span class="sc">/</span> (M <span class="sc">*</span> m)</span>
<span id="cb38-43"><a href="#cb38-43" tabindex="-1"></a>TPR_bh <span class="ot">&lt;-</span> TPR_bh <span class="sc">/</span> (M <span class="sc">*</span> m)</span>
<span id="cb38-44"><a href="#cb38-44" tabindex="-1"></a></span>
<span id="cb38-45"><a href="#cb38-45" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb38-46"><a href="#cb38-46" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(FWER_bonf, <span class="cn">NA</span>, <span class="cn">NA</span>,</span>
<span id="cb38-47"><a href="#cb38-47" tabindex="-1"></a>                   <span class="cn">NA</span>, FDR_bh, TPR_bh),</span>
<span id="cb38-48"><a href="#cb38-48" tabindex="-1"></a>                 <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb38-49"><a href="#cb38-49" tabindex="-1"></a>                 <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;Bonferroni&quot;</span>, <span class="st">&quot;B-H&quot;</span>),</span>
<span id="cb38-50"><a href="#cb38-50" tabindex="-1"></a>                                 <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;TPR&quot;</span>)))</span>
<span id="cb38-51"><a href="#cb38-51" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>##                FWER FDR      TPR
## Bonferroni 0.020152  NA 0.011423
## B-H              NA  NA 0.031575</code></pre>
</div>
<div id="question-2-3" class="section level2">
<h2>Question 2</h2>
<p>Suppose the population has the exponential distribution with rate
<span class="math inline">\(\lambda\)</span>, then MLE of <span class="math inline">\(\lambda\)</span> is <span class="math inline">\(\hat{\lambda} = 1/\bar{X}\)</span>, where <span class="math inline">\(\bar{X}\)</span> is the sample mean. It can be
derived that the expectation of <span class="math inline">\(\hat{\lambda}\)</span> is <span class="math inline">\(\lambda n/(n-1)\)</span>, so that the estimation
bias is <span class="math inline">\(\lambda/(n-1)\)</span>. The standard
error <span class="math inline">\(\hat{\lambda}\)</span> is <span class="math inline">\(\lambda n/(n-1)\sqrt{n-2}\)</span>. Conduct a
simulation study to verify the performance of the bootstrap method.</p>
<ul>
<li><p>The true value of <span class="math inline">\(\lambda=2\)</span>.</p></li>
<li><p>The sample size n = 5,10,20.</p></li>
<li><p>The number of bootstrap replicates B = 1000.</p></li>
<li><p>The simulations are repeated for m = 1000 times.</p></li>
</ul>
<p>Compare the mean bootstrap bias and bootstrap standard error with the
theoretical ones. Comment on the results.</p>
</div>
<div id="answer-2-3" class="section level2">
<h2>Answer 2</h2>
<p>问题要求进行模拟研究来验证自助法在指数分布参数估计中的性能。即比较自助法的平均偏差和标准误差与理论值的差异，并对结果进行评论。</p>
<p>模拟研究的设置如下：</p>
<ul>
<li><p>真实参数值为 <span class="math inline">\(\lambda =
2\)</span>。</p></li>
<li><p>样本大小分别为 <span class="math inline">\(n = 5, 10,
20\)</span>。</p></li>
<li><p>自助法重复次数为 <span class="math inline">\(B =
1000\)</span>。</p></li>
<li><p>模拟重复次数为 <span class="math inline">\(m =
1000\)</span>。</p></li>
</ul>
<p>R语言代码如下：</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">2</span>  <span class="co"># 真实值</span></span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>)  <span class="co"># 样本大小 n</span></span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co"># 自助重复次数</span></span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co"># 模拟重复次数</span></span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a><span class="co"># 初始化存储平均偏差的矩阵</span></span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a>mean_bias <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> m, <span class="at">ncol =</span> <span class="fu">length</span>(sample_sizes))  </span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a><span class="co"># 初始化存储标准误的矩阵</span></span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a>std_error <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> m, <span class="at">ncol =</span> <span class="fu">length</span>(sample_sizes))  </span>
<span id="cb40-9"><a href="#cb40-9" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb40-11"><a href="#cb40-11" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sample_sizes)) {</span>
<span id="cb40-12"><a href="#cb40-12" tabindex="-1"></a>    n <span class="ot">&lt;-</span> sample_sizes[j]  <span class="co"># 当前样本大小</span></span>
<span id="cb40-13"><a href="#cb40-13" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="at">rate =</span> lambda)  <span class="co"># 生成指数分布样本</span></span>
<span id="cb40-14"><a href="#cb40-14" tabindex="-1"></a>    X_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(X)  <span class="co"># 计算样本均值</span></span>
<span id="cb40-15"><a href="#cb40-15" tabindex="-1"></a></span>
<span id="cb40-16"><a href="#cb40-16" tabindex="-1"></a>    <span class="co"># 使用自助法进行重采样，并计算每次重采样的MLE</span></span>
<span id="cb40-17"><a href="#cb40-17" tabindex="-1"></a>    bootstrap_estimates <span class="ot">&lt;-</span> <span class="fu">replicate</span>(B, <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(<span class="fu">sample</span>(X, <span class="at">replace =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb40-18"><a href="#cb40-18" tabindex="-1"></a>    <span class="co"># 计算平均偏差</span></span>
<span id="cb40-19"><a href="#cb40-19" tabindex="-1"></a>    mean_bias[i, j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(bootstrap_estimates) <span class="sc">-</span> lambda<span class="sc">/</span>(n<span class="dv">-1</span>)  </span>
<span id="cb40-20"><a href="#cb40-20" tabindex="-1"></a>    <span class="co"># 计算标准误差</span></span>
<span id="cb40-21"><a href="#cb40-21" tabindex="-1"></a>    std_error[i, j] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(n<span class="dv">-2</span>) <span class="sc">*</span> <span class="fu">mean</span>(bootstrap_estimates) <span class="sc">*</span> (n<span class="sc">/</span>(n<span class="dv">-1</span>))  </span>
<span id="cb40-22"><a href="#cb40-22" tabindex="-1"></a>  }</span>
<span id="cb40-23"><a href="#cb40-23" tabindex="-1"></a>}</span>
<span id="cb40-24"><a href="#cb40-24" tabindex="-1"></a></span>
<span id="cb40-25"><a href="#cb40-25" tabindex="-1"></a>mean_bias_theoretical <span class="ot">&lt;-</span> lambda<span class="sc">/</span>(sample_sizes <span class="sc">-</span> <span class="dv">1</span>)  <span class="co"># 理论偏差</span></span>
<span id="cb40-26"><a href="#cb40-26" tabindex="-1"></a>std_error_theoretical <span class="ot">&lt;-</span> lambda <span class="sc">*</span> sample_sizes <span class="sc">/</span> ((sample_sizes <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(sample_sizes <span class="sc">-</span> <span class="dv">2</span>))  <span class="co"># 理论标准误差</span></span>
<span id="cb40-27"><a href="#cb40-27" tabindex="-1"></a></span>
<span id="cb40-28"><a href="#cb40-28" tabindex="-1"></a>mean_bias_mean <span class="ot">&lt;-</span> <span class="fu">apply</span>(mean_bias, <span class="dv">2</span>, mean)  <span class="co"># 平均偏差的均值</span></span>
<span id="cb40-29"><a href="#cb40-29" tabindex="-1"></a>std_error_mean <span class="ot">&lt;-</span> <span class="fu">apply</span>(std_error, <span class="dv">2</span>, mean)  <span class="co"># 标准误的均值</span></span>
<span id="cb40-30"><a href="#cb40-30" tabindex="-1"></a></span>
<span id="cb40-31"><a href="#cb40-31" tabindex="-1"></a>mean_bias_theoretical  <span class="co"># 输出理论偏差</span></span></code></pre></div>
<pre><code>## [1] 0.5000000 0.2222222 0.1052632</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>std_error_theoretical  <span class="co"># 输出理论标准误差</span></span></code></pre></div>
<pre><code>## [1] 1.4433757 0.7856742 0.4962153</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>mean_bias_mean  <span class="co"># 输出自助法的平均偏差</span></span></code></pre></div>
<pre><code>## [1] 2.608858 2.211444 2.121664</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a>std_error_mean  <span class="co"># 输出自助法的平均标准误差</span></span></code></pre></div>
<pre><code>## [1] 6.730875 7.648276 9.945317</code></pre>
</div>
<div id="question-3-3" class="section level2">
<h2>Question 3</h2>
<p>7.3</p>
<p>Obtain a bootstrap t confidence of interval estimate for the
correlation statistic in Example 7.2 (law data in bootstrap).</p>
</div>
<div id="answer-3-3" class="section level2">
<h2>Answer 3</h2>
<p>根据示例7.2中的法律数据，使用自助法来计算t统计量置信区间估计。</p>
<p>R代码如下：</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;bootstrap&quot;</span>) <span class="co"># 加载bootstrap包</span></span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a><span class="co"># 设置bootstrap</span></span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">200</span> <span class="co"># 自助法重复次数</span></span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(law) <span class="co"># 数据集的观测数</span></span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> <span class="fu">cor</span>(law<span class="sc">$</span>LSAT, law<span class="sc">$</span>GPA) <span class="co"># 原始样本的相关系数估计值</span></span>
<span id="cb48-8"><a href="#cb48-8" tabindex="-1"></a>theta.hats.b <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B) <span class="co"># 储存自助法样本相关系数估计值的向量</span></span>
<span id="cb48-9"><a href="#cb48-9" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)  <span class="co"># 存储t统计量的向量</span></span>
<span id="cb48-11"><a href="#cb48-11" tabindex="-1"></a></span>
<span id="cb48-12"><a href="#cb48-12" tabindex="-1"></a><span class="co"># 自助法估计的R的标准差 </span></span>
<span id="cb48-13"><a href="#cb48-13" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb48-14"><a href="#cb48-14" tabindex="-1"></a>  <span class="co"># 从原始样本中有放回地抽取自助样本</span></span>
<span id="cb48-15"><a href="#cb48-15" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)  </span>
<span id="cb48-16"><a href="#cb48-16" tabindex="-1"></a>  <span class="co"># 根据自助样本索引获取自助样本</span></span>
<span id="cb48-17"><a href="#cb48-17" tabindex="-1"></a>  law.b <span class="ot">=</span> law[i,] </span>
<span id="cb48-18"><a href="#cb48-18" tabindex="-1"></a>   <span class="co"># 计算自助样本的相关系数估计值</span></span>
<span id="cb48-19"><a href="#cb48-19" tabindex="-1"></a>  theta.hats.b[b] <span class="ot">&lt;-</span> <span class="fu">cor</span>(law.b<span class="sc">$</span>LSAT, law.b<span class="sc">$</span>GPA) </span>
<span id="cb48-20"><a href="#cb48-20" tabindex="-1"></a>  sd.theta.hats.b <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb48-21"><a href="#cb48-21" tabindex="-1"></a>  </span>
<span id="cb48-22"><a href="#cb48-22" tabindex="-1"></a>  <span class="cf">for</span>(b2 <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb48-23"><a href="#cb48-23" tabindex="-1"></a>    i2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb48-24"><a href="#cb48-24" tabindex="-1"></a>    law.b2 <span class="ot">&lt;-</span> law.b[i2,]</span>
<span id="cb48-25"><a href="#cb48-25" tabindex="-1"></a>    sd.theta.hats.b[b2] <span class="ot">&lt;-</span> <span class="fu">cor</span>(law.b2<span class="sc">$</span>LSAT, law.b2<span class="sc">$</span>GPA)</span>
<span id="cb48-26"><a href="#cb48-26" tabindex="-1"></a>  }</span>
<span id="cb48-27"><a href="#cb48-27" tabindex="-1"></a>  </span>
<span id="cb48-28"><a href="#cb48-28" tabindex="-1"></a>  se.b <span class="ot">&lt;-</span> <span class="fu">sd</span>(sd.theta.hats.b)</span>
<span id="cb48-29"><a href="#cb48-29" tabindex="-1"></a>  </span>
<span id="cb48-30"><a href="#cb48-30" tabindex="-1"></a>  ts[b] <span class="ot">&lt;-</span> (theta.hats.b[b] <span class="sc">-</span> theta.hat) <span class="sc">/</span> se.b</span>
<span id="cb48-31"><a href="#cb48-31" tabindex="-1"></a>}</span>
<span id="cb48-32"><a href="#cb48-32" tabindex="-1"></a></span>
<span id="cb48-33"><a href="#cb48-33" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span> <span class="co"># 置信水平</span></span>
<span id="cb48-34"><a href="#cb48-34" tabindex="-1"></a>ts.ordered <span class="ot">&lt;-</span> <span class="fu">sort</span>(ts) <span class="co"># 对t统计量进行排序</span></span>
<span id="cb48-35"><a href="#cb48-35" tabindex="-1"></a><span class="co"># 计算置信区间的上下界</span></span>
<span id="cb48-36"><a href="#cb48-36" tabindex="-1"></a>qs <span class="ot">&lt;-</span> <span class="fu">quantile</span>(ts.ordered, <span class="at">probs =</span> <span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)) </span>
<span id="cb48-37"><a href="#cb48-37" tabindex="-1"></a><span class="co"># 原始样本相关系数估计值的标准差</span></span>
<span id="cb48-38"><a href="#cb48-38" tabindex="-1"></a>se.hat <span class="ot">&lt;-</span> <span class="fu">sd</span>(theta.hats.b)  </span>
<span id="cb48-39"><a href="#cb48-39" tabindex="-1"></a><span class="co"># 置信区间估计</span></span>
<span id="cb48-40"><a href="#cb48-40" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="fu">c</span>(theta.hat <span class="sc">-</span> qs[<span class="dv">2</span>]<span class="sc">*</span>se.hat, theta.hat <span class="sc">-</span> qs[<span class="dv">1</span>]<span class="sc">*</span>se.hat)  </span>
<span id="cb48-41"><a href="#cb48-41" tabindex="-1"></a><span class="fu">print</span>(CI)</span></code></pre></div>
<pre><code>##      97.5%       2.5% 
## -0.7398025  0.9846295</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="fu">hist</span>(ts, <span class="at">breaks =</span> <span class="dv">100</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAq1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2ZpC2kGa229u22/+2///T09PbkDrbkGbbtmbbtpDb27bb29vb////tmb/25D/27b//7b//9v///9nY54hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIcElEQVR4nO2da3vbNABG1a2lgTIuDR2sAQbUA7pmF5o08f//ZViSHXtN7NeSZV3s93zoulSRrPPIussWOelEhL6A2KEgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIA4wrar8TFo/738vCfxp//fu86wXcLIX5wGXtIQU83L1wL2oiCa5exexR0RCacC1qLszu3sfsvQR+uhDj7/l7moEBm4tNrIV7+rArX/p0Q53cqb0Ve/7gRL+7zTzdFuFdFvndLcfnpSpy9yT8silB1MocIVJRaURX7ITlLvAtaC1FeepWF8hMZsAgic3hVf3zxuNF/LrJdCNJcVWo1dQTHgurkLBldUEUpSJaCx/yjqij0TbBdlN6uVRVy+bjPKm8X9/l/xbe+epSBrpWga/ld8aYMr2hG8PwWayZnh29BRW7O/y3/qgWVdUWmC5X8vciVFnRbBvz8z5WMoPi8MKF/KmPNaPLqvvxCUDM5O3wL0p/oGkdloboLZdaq37/I6/63KgJZHPLyZy2oGcGRoGZydnivg55udJXyV+MmkEGLu+u2+r0pSGbx/O3nZaugZgTHrVgjOTsC9IOefr+qqtQeJUib2LUL6ixBzeTsCNNR3P9a1zjtdZDKqyoYh0r6hKDOOqiZnB2+BRX5/VHdZ6rhkblpb8WqEnTx+LRqr4PaWjH1azM5O7yXoHeHbo0aF3T1gw51UGcl3ewHNQXp2BvJ2eH/Fvsoq4RXsmurus33ZUf4F/2F4qPv7o9asfM/18VHbYIaETQElbHXydkR5XRHZn9HOCcuQZmaqyhKx4mhbSDiElSOuwZUGc6JS1D+9HoxbPDtnMgExQcFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCADEIKndNhb6M08RwWeJBEsOVnCCGy6IgwIQEVbu63R6lnI6gdbV5e2N/QO3UNUxF0H5V7/53udN7MoJ2y+oIYL5xeZNNRhBLEGJdnSJlHdRCdTDb7VmTCQkahxkIOpxttopucoK2i9u2P81b0OHREO196QkLqo6fd1E2XnMtQfJsLGi9d0vZfs1VUN7HUXZ2N2dBWlHnMKIYsM5XkDwyeluMKDr7gdvFy3kKkm2UNgNGovuVmKOg3dLFUeMJCwoYXSqCsuIGGzpMn7KgTFVAu+Wghx5MWFA1XThsrnDCgqrpwjUFfUF9WXq6cLsYVAlNWZB86Mrgx4qY5lJPDSQiKER0yg0FdYRPSJCTZeUpC8pcrAVOWNBu6WKpa9KCWofoNtH1DZ+OoP1qwBjDetknIUHFONVBEZqwoMOaTrBWLM6dnBH1g+IsRhQEaFyRehZ65nfCLCVBm7O7tXwov9fRfEKC5HyQ3Dfmdz4oIUGyoygF+Z1RTEhQVYKyQbvHJiyorIPWw7qLUxaku4q+ZxRTEhQiOgpC4dMRFH4sFrmgku5WHk7LTl9QnnVMC+HTPjMQ1FGEepzVmIGgjqFGj9M+0xfUtbtj3iWozzkVfNpnwoJ6AS3OXZDz6BIS1OMgRkcsLpZ9IhdULvt0j+bXonx1ZVtbN2FB+5U203Uada3eBiubuRkK2v2kJzpgR1FtxJ+hoKoEdcwoVh3FIsgMBckZxVzfRW0cOorZ5RwF6Xasc0a60qLf8wmi65d8SoJ6ULVx+9VwQfX+zQkJchld7SYVQZ6XnpMT5HvpOTVB3peeUxPkfek5NUHel55TE+R96Tk5Qb6XntMT5Dm61AQ1ZuRdRNcjaGKCvO+0Py1o2JOIRqBRSXs+zHJaUHRlKdzmhdQEeY+OglDQlAQNraFtqtb0BLlo6CmoV3T9ggJBkbT18QqKpBhFLqguR6FKVOSCHg7lKFSJoiB0mernoK0dx9H1C5qSoBDRURAK2l9QvcTo9mp7XWaw6AwE1T/cXm2vywwR3bNVZwo6CgU0UBAFgVAUBEJREAhlLaj3gMzZ0C0xQb2LkbMCl6KgPqUjkCBHJw4HCnrokfkwglydOBxB0PNSVQs6Wd76V08mgpydFxtD0LPPGoJOlSXx0OtCe+dI037i0HBVQ0RA30w7LkHTw7AOGuX9YlFjVtGP836xqIlgYSVuRhEUtvpFxCDI15c8fIeCRkhinEgpaIQvUVD471DQCEmMEykFjfAlCgr/HQ41ABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAgwhiC9vGj0urKN+TMfLFLZfvPeOLExBG2/Nn2+hXzA3MbQkHkqu6XacmGW2BiCjE/g610RXc9Cd5HKRm/8MkxsDEFr05cBbhfqKalmOTZNZSOulVPDxMYQlH1bVA4m2z/03WJYJIxTKVMwTGwEQbul3Pxh8rQ4XSOYVULmqZRWDBMbrZk3KQ82gsxTiUyQvtV7hrW5xYxTieEWW9fVgkkrbFVJG6dSCQpeSesrMCkPNs28eSpl6AiaeZW4UfVp01E0T6XUGb6jmGdCGD5Mb23xeDnzVMryZpQYB6sACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQECByQRsXr6waRNyC3LzTaxAUBIha0HYhnwYmfw57NeUQohakSpDaSrYJZih+QU7enGdP/ILKExahiF+QfsIu66CTHFqxbOALcu1JRFC49j52Qdd6x67NMQU3xC0oz4p+0EYMfgX1ACIXFB4KAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAjwP3CcczEwqzr+AAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="hw5" class="section level2">
<h2>HW5</h2>
</div>
<div id="question-1-4" class="section level2">
<h2>Question 1</h2>
<p>7.5</p>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures 1/λ by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
<p>分别使用标准正态（standard
normal）、基本(basic)、百分位(percentile)和BCa方法计算平均故障时间1/λ的95%自助法置信区间，并比较这些区间，并解释它们之间的差异。</p>
</div>
<div id="answer-1-4" class="section level2">
<h2>Answer 1</h2>
<p>R语言代码如下：</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>hours <span class="ot">=</span> aircondit<span class="sc">$</span>hours</span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">length</span>(hours)</span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>B <span class="ot">=</span> <span class="dv">200</span></span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a><span class="co">#  MLE </span></span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a>mle.lambda <span class="ot">=</span> <span class="cf">function</span>(values) {</span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">length</span>(values) <span class="sc">/</span> <span class="fu">sum</span>(values))</span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a>}</span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a></span>
<span id="cb51-11"><a href="#cb51-11" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" tabindex="-1"></a><span class="co"># 初始化保存自助法估计结果的向量</span></span>
<span id="cb51-13"><a href="#cb51-13" tabindex="-1"></a>time.b <span class="ot">=</span> <span class="fu">numeric</span>(B)</span>
<span id="cb51-14"><a href="#cb51-14" tabindex="-1"></a>ts <span class="ot">=</span> <span class="fu">numeric</span>(B)</span>
<span id="cb51-15"><a href="#cb51-15" tabindex="-1"></a></span>
<span id="cb51-16"><a href="#cb51-16" tabindex="-1"></a><span class="co"># 计算 lambda 的 MLE 估计值</span></span>
<span id="cb51-17"><a href="#cb51-17" tabindex="-1"></a>time.hat <span class="ot">=</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mle.lambda</span>(hours)</span>
<span id="cb51-18"><a href="#cb51-18" tabindex="-1"></a></span>
<span id="cb51-19"><a href="#cb51-19" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb51-20"><a href="#cb51-20" tabindex="-1"></a>  <span class="co"># 从原始数据中进行有放回抽样</span></span>
<span id="cb51-21"><a href="#cb51-21" tabindex="-1"></a>  i <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb51-22"><a href="#cb51-22" tabindex="-1"></a>  hours.b <span class="ot">=</span> hours[i]</span>
<span id="cb51-23"><a href="#cb51-23" tabindex="-1"></a>  </span>
<span id="cb51-24"><a href="#cb51-24" tabindex="-1"></a>  <span class="co"># 计算抽样数据的 MLE 估计值</span></span>
<span id="cb51-25"><a href="#cb51-25" tabindex="-1"></a>  time.b[b] <span class="ot">=</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mle.lambda</span>(hours.b)</span>
<span id="cb51-26"><a href="#cb51-26" tabindex="-1"></a>  </span>
<span id="cb51-27"><a href="#cb51-27" tabindex="-1"></a>  times.b2 <span class="ot">=</span> <span class="fu">numeric</span>(B)</span>
<span id="cb51-28"><a href="#cb51-28" tabindex="-1"></a>  </span>
<span id="cb51-29"><a href="#cb51-29" tabindex="-1"></a>  <span class="co"># 计算用于后续计算的自助法估计值</span></span>
<span id="cb51-30"><a href="#cb51-30" tabindex="-1"></a>  <span class="cf">for</span> (b2 <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb51-31"><a href="#cb51-31" tabindex="-1"></a>    i2 <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb51-32"><a href="#cb51-32" tabindex="-1"></a>    hours.b2 <span class="ot">=</span> hours.b[i2]</span>
<span id="cb51-33"><a href="#cb51-33" tabindex="-1"></a>    times.b2[b2] <span class="ot">=</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mle.lambda</span>(hours.b2)</span>
<span id="cb51-34"><a href="#cb51-34" tabindex="-1"></a>  }</span>
<span id="cb51-35"><a href="#cb51-35" tabindex="-1"></a>  </span>
<span id="cb51-36"><a href="#cb51-36" tabindex="-1"></a>  ts[b] <span class="ot">=</span> (time.b[b] <span class="sc">-</span> time.hat) <span class="sc">/</span> <span class="fu">sd</span>(times.b2)</span>
<span id="cb51-37"><a href="#cb51-37" tabindex="-1"></a>}</span>
<span id="cb51-38"><a href="#cb51-38" tabindex="-1"></a></span>
<span id="cb51-39"><a href="#cb51-39" tabindex="-1"></a><span class="co"># 计算估计值的标准误差</span></span>
<span id="cb51-40"><a href="#cb51-40" tabindex="-1"></a>se.hat <span class="ot">=</span> <span class="fu">sd</span>(time.b)</span>
<span id="cb51-41"><a href="#cb51-41" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.05</span></span>
<span id="cb51-42"><a href="#cb51-42" tabindex="-1"></a>q.probs <span class="ot">=</span> <span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb51-43"><a href="#cb51-43" tabindex="-1"></a></span>
<span id="cb51-44"><a href="#cb51-44" tabindex="-1"></a><span class="co"># 定义函数用于设置置信区间的名称</span></span>
<span id="cb51-45"><a href="#cb51-45" tabindex="-1"></a>setCINames <span class="ot">=</span> <span class="cf">function</span>(object) {</span>
<span id="cb51-46"><a href="#cb51-46" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">setNames</span>(object, <span class="fu">c</span>(<span class="fu">paste</span>((alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="st">&#39;%&#39;</span>), <span class="fu">paste</span>((<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="st">&#39;%&#39;</span>))))</span>
<span id="cb51-47"><a href="#cb51-47" tabindex="-1"></a>}</span>
<span id="cb51-48"><a href="#cb51-48" tabindex="-1"></a></span>
<span id="cb51-49"><a href="#cb51-49" tabindex="-1"></a><span class="co"># 标准正态分布置信区间</span></span>
<span id="cb51-50"><a href="#cb51-50" tabindex="-1"></a>q <span class="ot">=</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb51-51"><a href="#cb51-51" tabindex="-1"></a>ci.sn <span class="ot">=</span> time.hat <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> q <span class="sc">*</span> se.hat</span>
<span id="cb51-52"><a href="#cb51-52" tabindex="-1"></a>ci.sn <span class="ot">=</span> <span class="fu">setCINames</span>(ci.sn)</span>
<span id="cb51-53"><a href="#cb51-53" tabindex="-1"></a></span>
<span id="cb51-54"><a href="#cb51-54" tabindex="-1"></a><span class="co"># 基本自助法置信区间</span></span>
<span id="cb51-55"><a href="#cb51-55" tabindex="-1"></a>qs.time.hat <span class="ot">=</span> <span class="fu">quantile</span>(<span class="at">x =</span> time.b, <span class="at">p =</span> q.probs)</span>
<span id="cb51-56"><a href="#cb51-56" tabindex="-1"></a>ci.basic <span class="ot">=</span> <span class="fu">rev</span>(<span class="dv">2</span> <span class="sc">*</span> time.hat <span class="sc">-</span> qs.time.hat)</span>
<span id="cb51-57"><a href="#cb51-57" tabindex="-1"></a>ci.basic <span class="ot">=</span> <span class="fu">setCINames</span>(ci.basic)</span>
<span id="cb51-58"><a href="#cb51-58" tabindex="-1"></a></span>
<span id="cb51-59"><a href="#cb51-59" tabindex="-1"></a><span class="co"># 百分位自助法置信区间</span></span>
<span id="cb51-60"><a href="#cb51-60" tabindex="-1"></a>ci.percentile <span class="ot">=</span> qs.time.hat</span>
<span id="cb51-61"><a href="#cb51-61" tabindex="-1"></a></span>
<span id="cb51-62"><a href="#cb51-62" tabindex="-1"></a><span class="co"># 自助法 t 置信区间</span></span>
<span id="cb51-63"><a href="#cb51-63" tabindex="-1"></a>qs.t <span class="ot">=</span> <span class="fu">quantile</span>(<span class="at">x =</span> ts, <span class="at">p =</span> q.probs)</span>
<span id="cb51-64"><a href="#cb51-64" tabindex="-1"></a>ci.t <span class="ot">=</span> <span class="fu">setCINames</span>(<span class="fu">rev</span>(time.hat <span class="sc">-</span> qs.t <span class="sc">*</span> se.hat))</span>
<span id="cb51-65"><a href="#cb51-65" tabindex="-1"></a></span>
<span id="cb51-66"><a href="#cb51-66" tabindex="-1"></a><span class="co"># 输出置信区间</span></span>
<span id="cb51-67"><a href="#cb51-67" tabindex="-1"></a>confidence_intervals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Method =</span> <span class="fu">c</span>(<span class="st">&quot;Standard Normal&quot;</span>, <span class="st">&quot;Basic Bootstrap&quot;</span>, <span class="st">&quot;Percentile Bootstrap&quot;</span>, <span class="st">&quot;Bootstrap t&quot;</span>),</span>
<span id="cb51-68"><a href="#cb51-68" tabindex="-1"></a>                                   <span class="at">Lower =</span> <span class="fu">c</span>(ci.sn[<span class="dv">1</span>], ci.basic[<span class="dv">1</span>], ci.percentile[<span class="dv">1</span>], ci.t[<span class="dv">1</span>]),</span>
<span id="cb51-69"><a href="#cb51-69" tabindex="-1"></a>                                   <span class="at">Upper =</span> <span class="fu">c</span>(ci.sn[<span class="dv">2</span>], ci.basic[<span class="dv">2</span>], ci.percentile[<span class="dv">2</span>], ci.t[<span class="dv">2</span>]))</span>
<span id="cb51-70"><a href="#cb51-70" tabindex="-1"></a></span>
<span id="cb51-71"><a href="#cb51-71" tabindex="-1"></a><span class="fu">print</span>(confidence_intervals)</span></code></pre></div>
<pre><code>##                 Method    Lower    Upper
## 1      Standard Normal 35.07795 181.0887
## 2      Basic Bootstrap 26.91667 170.0042
## 3 Percentile Bootstrap 46.16250 189.2500
## 4          Bootstrap t 53.30762 304.0009</code></pre>
</div>
<div id="question-2-4" class="section level2">
<h2>Question 2</h2>
<p>7.8</p>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<p>根据习题7.7，获取<span class="math inline">\(\hat{\theta}\)</span>的jackknife偏差估计和标准误差。</p>
</div>
<div id="answer-2-4" class="section level2">
<h2>Answer 2</h2>
<p>R语言代码如下：</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;scor&quot;</span>)</span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a><span class="co"># 计算 theta 的函数</span></span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="fu">cov</span>(x)</span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a>  pca.sigma <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(sigma)</span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> pca.sigma<span class="sc">$</span>sdev[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(pca.sigma<span class="sc">$</span>sdev)</span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a>  <span class="fu">return</span>(theta)</span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a>}</span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a></span>
<span id="cb53-12"><a href="#cb53-12" tabindex="-1"></a><span class="co"># 计算 theta.hat</span></span>
<span id="cb53-13"><a href="#cb53-13" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(scor<span class="sc">$</span>mec)</span>
<span id="cb53-14"><a href="#cb53-14" tabindex="-1"></a>values <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(scor))<span class="sc">$</span>values</span>
<span id="cb53-15"><a href="#cb53-15" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> values[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(values)</span>
<span id="cb53-16"><a href="#cb53-16" tabindex="-1"></a></span>
<span id="cb53-17"><a href="#cb53-17" tabindex="-1"></a><span class="co"># 计算theta.jackknife</span></span>
<span id="cb53-18"><a href="#cb53-18" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb53-19"><a href="#cb53-19" tabindex="-1"></a></span>
<span id="cb53-20"><a href="#cb53-20" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb53-21"><a href="#cb53-21" tabindex="-1"></a>  Scor <span class="ot">&lt;-</span> scor[<span class="sc">-</span>i, ]</span>
<span id="cb53-22"><a href="#cb53-22" tabindex="-1"></a>  val <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(Scor))<span class="sc">$</span>values</span>
<span id="cb53-23"><a href="#cb53-23" tabindex="-1"></a>  theta.jack[i] <span class="ot">&lt;-</span> val[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(val)</span>
<span id="cb53-24"><a href="#cb53-24" tabindex="-1"></a>}</span>
<span id="cb53-25"><a href="#cb53-25" tabindex="-1"></a></span>
<span id="cb53-26"><a href="#cb53-26" tabindex="-1"></a><span class="co"># 计算 jackknife 估计的偏差和标准差</span></span>
<span id="cb53-27"><a href="#cb53-27" tabindex="-1"></a>bias <span class="ot">&lt;-</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(theta.jack) <span class="sc">-</span> theta.hat)</span>
<span id="cb53-28"><a href="#cb53-28" tabindex="-1"></a>se.jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">mean</span>((theta.jack <span class="sc">-</span> theta.hat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb53-29"><a href="#cb53-29" tabindex="-1"></a></span>
<span id="cb53-30"><a href="#cb53-30" tabindex="-1"></a><span class="fu">c</span>(bias, se.jack)</span></code></pre></div>
<pre><code>## [1] 0.001069139 0.049552440</code></pre>
</div>
<div id="question-3-4" class="section level2">
<h2>Question 3</h2>
<p>7.11</p>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best fitting model. Use leave-two-out cross validation to
compare the models.</p>
<p>在例子7.18中，使用了留一法（Leave-One-Out，简称LOO）交叉验证来选择最佳拟合模型。现在我们将使用留二法（Leave-Two-Out，简称LTO）交叉验证来比较这些模型。</p>
</div>
<div id="answer-3-4" class="section level2">
<h2>Answer 3</h2>
<p>比较下面四个模型：</p>
<p>1.Linear：<span class="math inline">\(Y=\beta_0+\beta_1X+\epsilon\)</span></p>
<p>2.Quadratic:<span class="math inline">\(Y=\beta_0+\beta_1X+\beta_2X^2+\epsilon\)</span></p>
<p>3.Exponential:<span class="math inline">\(log(Y)=log(\beta_0)+\beta_1X+\epsilon\)</span></p>
<p>4.Log-Log:<span class="math inline">\(log(Y)=\beta_0+\beta_{1}log(X)+\epsilon\)</span></p>
<p>R代码如下：</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="fu">library</span>(DAAG, <span class="at">quietly=</span><span class="cn">TRUE</span>)</span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a><span class="co"># 加载数据集</span></span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a><span class="fu">data</span>(ironslag)</span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a><span class="co"># 将 x 和 y 转换为数据框形式</span></span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">chemical =</span> ironslag<span class="sc">$</span>chemical)</span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">magnetic =</span> ironslag<span class="sc">$</span>magnetic)</span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a></span>
<span id="cb55-10"><a href="#cb55-10" tabindex="-1"></a><span class="co"># 初始化向量以存储每个模型的均方误差（MSE）</span></span>
<span id="cb55-11"><a href="#cb55-11" tabindex="-1"></a>mse_linear <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(ironslag))</span>
<span id="cb55-12"><a href="#cb55-12" tabindex="-1"></a>mse_quadratic <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(ironslag))</span>
<span id="cb55-13"><a href="#cb55-13" tabindex="-1"></a>mse_exponential <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(ironslag))</span>
<span id="cb55-14"><a href="#cb55-14" tabindex="-1"></a>mse_loglog <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(ironslag))</span>
<span id="cb55-15"><a href="#cb55-15" tabindex="-1"></a></span>
<span id="cb55-16"><a href="#cb55-16" tabindex="-1"></a><span class="co"># 进行交叉验证</span></span>
<span id="cb55-17"><a href="#cb55-17" tabindex="-1"></a><span class="cf">for</span> (k1 <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">nrow</span>(ironslag)<span class="sc">-</span><span class="dv">1</span>)) {</span>
<span id="cb55-18"><a href="#cb55-18" tabindex="-1"></a>  <span class="cf">for</span> (k2 <span class="cf">in</span> (k1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(ironslag)) {</span>
<span id="cb55-19"><a href="#cb55-19" tabindex="-1"></a>    <span class="co"># 留出观测 k1 和 k2</span></span>
<span id="cb55-20"><a href="#cb55-20" tabindex="-1"></a>    train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x[<span class="sc">-</span><span class="fu">c</span>(k1, k2), ], <span class="at">y =</span> y[<span class="sc">-</span><span class="fu">c</span>(k1, k2), ])</span>
<span id="cb55-21"><a href="#cb55-21" tabindex="-1"></a>    test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x[<span class="fu">c</span>(k1, k2), ], <span class="at">y =</span> y[<span class="fu">c</span>(k1, k2), ])</span>
<span id="cb55-22"><a href="#cb55-22" tabindex="-1"></a>    </span>
<span id="cb55-23"><a href="#cb55-23" tabindex="-1"></a>    <span class="do">### 模型 1: 线性模型 </span><span class="al">###</span></span>
<span id="cb55-24"><a href="#cb55-24" tabindex="-1"></a>    model_linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> train)</span>
<span id="cb55-25"><a href="#cb55-25" tabindex="-1"></a>    prediction_linear <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_linear, <span class="at">newdata =</span> test)</span>
<span id="cb55-26"><a href="#cb55-26" tabindex="-1"></a>    mse_linear[k1] <span class="ot">&lt;-</span> mse_linear[k1] <span class="sc">+</span> <span class="fu">mean</span>((test<span class="sc">$</span>y <span class="sc">-</span> prediction_linear)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb55-27"><a href="#cb55-27" tabindex="-1"></a>    </span>
<span id="cb55-28"><a href="#cb55-28" tabindex="-1"></a>    <span class="do">### 模型 2: 二次模型 </span><span class="al">###</span></span>
<span id="cb55-29"><a href="#cb55-29" tabindex="-1"></a>    model_quadratic <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> train)</span>
<span id="cb55-30"><a href="#cb55-30" tabindex="-1"></a>    prediction_quadratic <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_quadratic, <span class="at">newdata =</span> test)</span>
<span id="cb55-31"><a href="#cb55-31" tabindex="-1"></a>    mse_quadratic[k1] <span class="ot">&lt;-</span> mse_quadratic[k1] <span class="sc">+</span> <span class="fu">mean</span>((test<span class="sc">$</span>y <span class="sc">-</span> prediction_quadratic)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb55-32"><a href="#cb55-32" tabindex="-1"></a>    </span>
<span id="cb55-33"><a href="#cb55-33" tabindex="-1"></a>    <span class="do">### 模型 3: 指数模型 </span><span class="al">###</span></span>
<span id="cb55-34"><a href="#cb55-34" tabindex="-1"></a>    model_exponential <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x, <span class="at">data =</span> train)</span>
<span id="cb55-35"><a href="#cb55-35" tabindex="-1"></a>    prediction_exponential <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">predict</span>(model_exponential, <span class="at">newdata =</span> test))</span>
<span id="cb55-36"><a href="#cb55-36" tabindex="-1"></a>    mse_exponential[k1] <span class="ot">&lt;-</span> mse_exponential[k1] <span class="sc">+</span> <span class="fu">mean</span>((test<span class="sc">$</span>y <span class="sc">-</span> prediction_exponential)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb55-37"><a href="#cb55-37" tabindex="-1"></a>    </span>
<span id="cb55-38"><a href="#cb55-38" tabindex="-1"></a>    <span class="do">### 模型 4: 对数-对数模型 </span><span class="al">###</span></span>
<span id="cb55-39"><a href="#cb55-39" tabindex="-1"></a>    model_loglog <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x), <span class="at">data =</span> train)</span>
<span id="cb55-40"><a href="#cb55-40" tabindex="-1"></a>    prediction_loglog <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">predict</span>(model_loglog, <span class="at">newdata =</span> test))</span>
<span id="cb55-41"><a href="#cb55-41" tabindex="-1"></a>    mse_loglog[k1] <span class="ot">&lt;-</span> mse_loglog[k1] <span class="sc">+</span> <span class="fu">mean</span>((test<span class="sc">$</span>y <span class="sc">-</span> prediction_loglog)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb55-42"><a href="#cb55-42" tabindex="-1"></a>  }</span>
<span id="cb55-43"><a href="#cb55-43" tabindex="-1"></a>}</span>
<span id="cb55-44"><a href="#cb55-44" tabindex="-1"></a></span>
<span id="cb55-45"><a href="#cb55-45" tabindex="-1"></a><span class="co"># 计算每个模型的平均 MSE</span></span>
<span id="cb55-46"><a href="#cb55-46" tabindex="-1"></a>avg_mse_linear <span class="ot">&lt;-</span> <span class="fu">mean</span>(mse_linear)</span>
<span id="cb55-47"><a href="#cb55-47" tabindex="-1"></a>avg_mse_quadratic <span class="ot">&lt;-</span> <span class="fu">mean</span>(mse_quadratic)</span>
<span id="cb55-48"><a href="#cb55-48" tabindex="-1"></a>avg_mse_exponential <span class="ot">&lt;-</span> <span class="fu">mean</span>(mse_exponential)</span>
<span id="cb55-49"><a href="#cb55-49" tabindex="-1"></a>avg_mse_loglog <span class="ot">&lt;-</span> <span class="fu">mean</span>(mse_loglog)</span>
<span id="cb55-50"><a href="#cb55-50" tabindex="-1"></a></span>
<span id="cb55-51"><a href="#cb55-51" tabindex="-1"></a><span class="co"># 打印每个模型的平均 MSE</span></span>
<span id="cb55-52"><a href="#cb55-52" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;线性模型 MSE:&quot;</span>, avg_mse_linear, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 线性模型 MSE: 508.8791</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;二次模型 MSE:&quot;</span>, avg_mse_quadratic, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 二次模型 MSE: 464.6247</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;指数模型 MSE:&quot;</span>, avg_mse_exponential, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 指数模型 MSE: 479.8278</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;对数-对数模型 MSE:&quot;</span>, avg_mse_loglog, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 对数-对数模型 MSE: 532.1466</code></pre>
<p>根据结果，可以看出二次模型(quadratic
model)拟合效果最好,拟合出的回归模型为：</p>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2), data = train)
## 
## Coefficients:
## (Intercept)            x       I(x^2)  
##    25.22190     -1.43158      0.05408</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAjVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6OmY6OpA6kNtmAABmADpmAGZmOgBmZjpmZmZmkJBmtrZmtv9/f3+QOgCQOjqQOmaQkGaQtpCQtv+Q27aQ29uQ2/+2ZgC2Zjq225C2/7a2///bkDrbtmbb25Db/7bb/9vb////tmb/25D//7b//9v////+hVHDAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAOR0lEQVR4nO2dC4OjthHHtefdtI330jZn+5o+liRHrl1s8/0/XiWNnhg0QggQ7PyTvdvDAsHPo5E0esBaUlBs7RsoXQQIEQFCRIAQESBEBAgRAUJEgBARIEQECBEBQkSAEBEgRAQIEQFCRIAQESBEBAgRAUJEgBARIEQECBEBQkSAEBEgRAQIEQFCRIAQESBEBAgRAUJEgBARIEQECBEBQkSAEBEgRAQIEQFCRIAQESBEBAgRAUJEgBARIEQECBEBQkSAEBEgRAQIEQFCRIAQWUC312NbM3Z4X/FuCpQFVB3ery/PbfW84t0UKAPo9npqG8Z/Pn1b836Kkweo4nBqAuTJKWLPt9fD++2Vipgn10mzp7f7hfj4WqOabxjj38XQgfuFSR17zhR+QJ3iXaD7aUYtD+h+EV7u+nIcOKCMWFQYAe0YkKoFri+n/gMKEFLYFwbE/Y/RzLWYaI9K6QZX94AmU4kma63K2vWF/3JSCPjBp1+e3uQ/5B+V/FD+rhLm0+IWdP1BffW6wdU94FpQze1ElD1pXbzQAQ6ermEOoEql5L/rhPnud3FApmzoX7oHFKBaGoywHg5OwwQbEY9fWUC3z29QQPnv+Zu5XjW/RBGLAAT3cdJH+LPfXuGuZHNf/tq4RUzWgxKQTphPXl+sfnZ850yKK2KiVwjVP7CS1MAH1Q+AuE/69BtYkE6YT05X49g23C/WM3fnrU/mX4hwwe4B8RcUsUb4Zr+qUqXqwYLkd6qKmE6Y7369vtj1T9/kz6wSFnC/HL6bhlDngPJBFXhd50RZgrQPqgWgowQjiTXMAspa3RtA98uxFe5udkCyFuIlwVqqf0ABEh1DWTcJVNKUtNGIg43sFh3e+WknMB5uccJJq4T57tb6IPFFVsfZi1hrXIt1p94B3Q6qRSGr1WHVGfHaQbJa+QI+6OlNF8BuN2aqnGqeNyd4lstFO37tPsfDgRJEMWlEBAiRU4st0xfbmroWRCHpjh6KGI1q+HoARCbk6wHQtFENthmlApo4qrGZSnE8IF2LTWtI7xjQwvmuLQKEaCSgbEH7vQISkiGqqaGCHQMyUYZJXnrHgHQYblpDsThAKqDEfYj/xadYEEQ8q31ZUCW/9vvl1NZQQlQbMckHqVjvlPspDdD9q3yc20862M6cnyg5CWVVNjHgWhog+Uyn9vrjuwy4q/tj1A7SEoNu3IrEeBYBGlR1IgsKqjpN9kG312OekGtpgETZuv/jm6iiJ9diWVQaIBgza3O0g/KoOEBDSgA0ZSnC+EDd2koAlGUpwo4B5VmKsHNA05ci7BhQnqUIewaUZSnCngEtm+/aIkCIEsMdh/eqbw3JDPmurZSA2dNbLZz0JEI7BiT7c2LeJFXz/QnljGwOiBqKAwm1Be0saD+kZB9UT5vHv2dAEOAOD2rUTC2EGPJUJQASYzxi3VjQV8zTDoJFWaKtXTIguZDq85seI+6NwZzPsVd7GDgMCJKIFQAlA7r+5a9qnOcnNwjdUfrQc0BmNQ13VT6gggJm96//uTgWZIYxrKT1pDhptH43RlY9l2tB9VH6IB2E7gE0cGRAD1PwQr5NYxle0rE6IF62BCAxYCi/8Q4g43tm6qzqRgAsdZ98uRlUyy/52Bze+V9vreeDXMf8kXvzYEGMWxCMgLEePh8cEPgK3iaxt9Ot1j8yIKdUWd/Tlyb6YhlVAiBVsMyvvY3CDw8Im6EwevLCjqYBK0DSOQ92KVIairuYBiywxExvSYkH7WEaMLCBmj3YIU3vi206omjdD9ZbT4soCm04oqibhAznk+aDtjsNWEcSgFBMrCc5orjJacDMOGcWYz3qlOhr59QqgJj9/3yODEktDGjdgBnz/489Z3TCbQ49w9ci0HDrmcEwusM+Wxp61mzkn2wgPD907uiE2xt6Zuo/QUb4nlF5pzUUNzX0rGotzmVM0bJnj024uaFn1fDh1tMuAmhTQ8/K+8hGD0vhk95QnLi91SKAmPXO5zaxcbHjhiLYDmvBMadmuFtABk9i0TLXGZ1QT5AuuxZzraed0m5PAQTB1qIBmYbh5H5NCqAvr3KXxoIBgdWckz2ze6nRCXlD8X5hx5IBCes5MzaqSzF8rbEJYRdQdvijYECiWs+CJz0mjcxc06O6g2lmAaRdznlkhzR4zdEJVdA+uGN1rd/l0PS+1GFMvpHS3hj4sBEBH+zC2RO23iy9ocGh7M0q9R80CjOG5GYB5MzSaxaZgufV6bp7kevSoxLGrZtfzII8KMZ62oltQz+L7AmFTFd/Th9knY7To8huoTP1xdC9BDM0UJhbrM5nr5RNvrrNZlzCcmZ3uH2J3I7Zy2d8wjJmdziAzlm9cjef0QkLmd0BTR1tPbPxSW8ortsXU+Vp3tIFOY1OWMLsDhVGPS8RlxyfcP3ZHWAvs5UqP6+EhOvO7gCXc04aw0nJLnvCeS/ntwqz3tJAhqMTRqwXy5lv5zQz+YAtw2dCLbZQvp2z5ABXO2u91c1ydMIsu/2nAoI1bgtZD2Q5NuFKu+CZLoXyQ0tpG04aPM5Z90/z3gqSdfaE4auMb/iaar1dAU8SoCwvgYzLVxepVgfB8sWaY5UAKMtLIKPyBTitHj7eCKA8L4HE87X9CSdauDifxHbQ9JdAovla62n1xMvlGj/+fYxMmOclkFi+0npcOBPymqQEH5TlJZAxgM5rw9E3MjZhjpdAooDkQoqV4chbyJ5w+uUYzNhd3iH3qUBAEOspwXqEyhv2YePua26VNuyj48wbBhQ17DNhi67NA4oZ9knboktZTynuGTTLsE/KFl1nC6YQ9wyaZdhneIuuwXzPpRUtrVmGfcZu0XUW3RYmFzLuAhCuyC26VFk6NyIVk2+u+iCABrfo8iKKsr/FuxTV0z+5Bd3Yt/bKinv7bwIgdIpv5OUcpyPDJz/ya36etshqBqVEFGPJhIYYGXQpHEDmzVVlKS2iGCcMkL0uWNBuAMUGo0OA5CiFuawAZN9cVZTSuxq4EAtyWoQCjPPmqpKU3FCMEArISFrOw5urilBKEcsS7tiMRgOaSzHjHAVcYoYzc2WwGUBZhp5DGaQmKAVQlqHnUAapCQoBlGfoOZBBcoJiAOUYeg5kkJygEEB5hp4DGSQnKARQnqHnUAapCUoBlGXoOZhBYoJiAJH6ZJ20CklkmQ28Iz0AmrbJ2/6kAFW2F5djRcKO9GBBJF/kpBFpQNeXo4iZTd3kbX/SwVHRRxUxxeyd1a1LO2kRNZYDP9Nep74/ASA55gNhe2oH+dKATnpkjAD5cgCB+8ndWd26HB8kpwZNfZ/67qQANU9vt1dhO9Ej9JGSUyKQxnkwBBXR9EBCWDG3MCzdDmrk3KnrS+YCdr/wp6tZ0CqD26aJWbfIzNvg+XG3ENDMLWnl10JP0OCbXgWbHsHz424hpEW6GiETaNgxUHHiTxc+P+oWgloEEOLYQoB+eAsnQM6PvYVhLQFocMcz/fnwzcMXj3z9EYCwWxjWAoAazEHODwi9hWHNDwj/8mYvYun2MyegGlof9eDN1bp5MslJh89XGU2Iks5tQTFvWQg8YEQ1jwKa9qKH2dtBEV9e6AEjGooIoKhbGNbMgODVy0hnIfiANd7VCAOKuoVhUUwaEQFCRIAQESBEBAgRAUJEgBARIEQECBEBQkSAEBEgRAQIEQFCRIAQESBEBAgRAUJEgBARIEQECBEBQkSAEBEgRAQIEQFCRIAQzQfIbifze+zeTc2pf58ne7DBR9nVRfK8imduC4L5T7H3OphOfwCb74Wna+i0HxKQmkgVXLK1TUA/v8AuwnZSGfxy+/yLmOQMh6880eG/rzqdXKDF5HnmRd1mJ1C9/ObkpPnCy/TJXES9Hh7yE0cTp1EtA0jMdVc/amnjSW4rDMsf9GHjOmDX4aNZQaIAwdVaOSHIALJpIAN9EfGjL2yWCyZoGUBHWS7MeiuYWCfXhxydZVj22cBS5Dpj8XAKkJlp1gAHcdxJozMxgMyFpyzxWswH8T/gAflDgBNRT9Oaw/rZXB/TMBYE5KeRVAwg58LphBYFpOp9BUg9TWsOG0C6KHEX8uk3a0G9RcxL0wGkLwwLfkr2Qa4Ftboa8i1IpXMtSP7tFDHrpA/v+pp+mj4L0qrSZikuCcjUvI4POjkVctcHSdfR2CImq/n75fBdOnRwOX4aH5Bf0yfW+0sCgjWN4pu0tZjZBb0Cl21qsfvlGQyDHe2zVZKQWNkmNo7nv538NMozu7WYuLA0pcT1PosCku0S6S91OwieXB+uOu0gOQW4UoYm1Zid+kRP5gv4IJtG1vuddhCYWPI84G12Vn9dbn+IbQJaUAQIEQFCRIAQESBEBAjRooAeG7P3y+jmbQM7aNjz4G07en8F2b3PuN/YyoASdruXgJzz7l//dnT3VxA79sIfWbQuoJT+UWMjaPDvw3exR69Z3CqNK8EyB7Q0oOuLiIwerxCDFV1NuSC1x5Jq2Z/Q8XkT6oBFmiJOqz6vjpYGWJeMUuYyoeUByaKgHlDAafS33pF834R5TB+QOE99Lj4wyeT+ClO6po9aHtBRDdzoGKwTIhOOVuxB8y+Zuvn0u/W1HiAdSxWfCzj6w0ZF6M1uURm0PKCTfQRwJdwclAk0MEhh7EHvlyAHJXRMsDG9+6qzn4LaX8EJdGfQqoDga+ZlrOp9GnccwrMgZR6dcQq9v8KOAIEl3D7/u7fZcr/83cbaO0Xs1P3c2V9hV4DgrZJ/7q1y6sP/7EtyenyQ97mzv8KOfJDac6J/bw1hJn0DWroW8z93Buy3Xou5gOABrXW4qmTk+bF9pNtB/ufO/gobbgc9CJyJeEdbynmBz3JNXVgbELSg6/H+NNCH23Jf7FG8CZ20NeFwX2vTvfktigAh+j+mFN6G+5+FtAAAAABJRU5ErkJggg==" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="hw6" class="section level2">
<h2>HW6</h2>
</div>
<div id="question-1-5" class="section level2">
<h2>Question 1</h2>
<p>Proof the Stationarity of Metropolis-Hastings sampler Algorithm in
continuous situation.</p>
</div>
<div id="answer-1-5" class="section level2">
<h2>Answer 1</h2>
<p>要证明M-H采样方法的稳定性，我们需要证明下面的细致平稳条件： <span class="math display">\[
\pi(i)Q(i,j)\alpha(i,j)=\pi(j)Q(j,i)\alpha(j,i)
\]</span></p>
<p><span class="math display">\[
P(i,j)=Q(i,j)\alpha(i,j)=Q(i,j)min \{\
\frac{\pi(j)Q(i,j)}{\pi(i)Q(j,i)},1\}\
\]</span> 分为两种情况： 当<span class="math inline">\(\frac{\pi(j)Q(j,i)}{\pi(i)Q(i,j)} \geq
1\)</span>，即<span class="math inline">\(\pi(j)Q(j,i) \geq
\pi(i)Q(i,j)\)</span>时，有： <span class="math display">\[
\alpha(i,j)=1，P(i,j)=Q(i,j)
\]</span> 当$ &lt; 1 <span class="math inline">\(，即\)</span>(j)Q(j,i)
&lt; (i)Q(i,j)$时，有： <span class="math display">\[
\alpha(i,j) =
\frac{\pi(j)Q(j,i)}{\pi(i)Q(i,j)}，P(i,j)=Q(j,i)\frac{\pi(j)}{\pi(i)}
\]</span> 综上： <span class="math display">\[
当\pi(j)Q(j,i) \geq \pi(i)Q(i,j)时，P(i,j) = Q(i,j) \\
当\pi(j)Q(j,i) &lt; \pi(i)Q(i,j)时，P(i,j) = Q(j,i)\frac{\pi(j)}{\pi(i)}
\]</span> 下面推导<span class="math inline">\(Q(i,j)\alpha(i,j)\)</span>是否满足细致平稳条件：
<span class="math display">\[
\pi(i)P(i,j)=\pi(i)Q(i,j)\alpha(i,j)=\pi(i)Q(i,j)min \{\
\frac{\pi(j)Q(j,i)}{\pi(i)Q(i,j)},1\}\
=min\{\pi(j)Q(j,i),\pi(i)Q(i,j)\}=\pi(j)Q(j,i)min\{1,\frac{\pi(i)Q(i,j)}{\pi(j)Q(j,i)}\}
\]</span> 即我们需要证明下式成立： <span class="math display">\[
P(i,j)=Q(j,i)min\{1,\frac{\pi(i)Q(i,j)}{\pi(j)Q(j,i)}\}
\]</span> 由于i和j是任意参数，所以有 <span class="math display">\[
1. 当\pi(i)Q(i,j) \geq \pi(j)Q(j,i)时，P(j,i) = Q(j,i) \\
2. 当\pi(i)Q(i,j) &lt; \pi(j)Q(j,i)时，P(j,i) =
Q(i,j)\frac{\pi(i)}{\pi(j)}
\]</span> 下面分情况来证明<span class="math inline">\(P(i,j)=Q(j,i)min\{1,
\frac{\pi(i)Q(j,i)}{\pi(j)Q(j,i)}\}\)</span></p>
<ul>
<li><p>当<span class="math inline">\(\pi(i)Q(i,j)&gt;\pi(,j)\)</span>时，<span class="math inline">\(P(j,i)=Q(j,i)\)</span>成立，对应第一种情况;</p></li>
<li><p>当<span class="math inline">\(\pi(i)Q(i,j)&lt;\pi(,j)\)</span>时，<span class="math inline">\(P(j,i)=Q(j,i)\frac{\pi(i)}{\pi(j)}\)</span>成立，对应第二种情况；</p></li>
</ul>
<p>所以，任选一个建议马尔科夫链概率转移矩阵Q，配合接受概率<span class="math inline">\(\alpha\)</span>,<span class="math inline">\(P(i,j)=Q(i,j)\alpha(i,j)\)</span>和目标分布<span class="math inline">\(\pi\)</span>是满足细致平稳条件的</p>
</div>
<div id="question-2-5" class="section level2">
<h2>Question 2</h2>
<p>8.1</p>
<p>Implement the two-sample Cramér-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p>
<p>将等差数列的双样本 Cramér-von
Mises检验作为置换检验来实施。将这个检验运用于例 8.1 和例 8.2
中的数据。</p>
</div>
<div id="answer-2-5" class="section level2">
<h2>Answer 2</h2>
<p>R语言代码如下：</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="fu">attach</span>(chickwts) <span class="co"># 将 chickwts 数据集附加到当前环境中</span></span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a><span class="co"># 分别提取使用两种饲料类型喂食的鸡的体重并排序</span></span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>])) </span>
<span id="cb64-6"><a href="#cb64-6" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" tabindex="-1"></a><span class="fu">detach</span>(chickwts) <span class="co"># 分离 chickwts 数据集</span></span>
<span id="cb64-8"><a href="#cb64-8" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" tabindex="-1"></a><span class="fu">library</span>(cramer) <span class="co"># 加载 cramer 包</span></span></code></pre></div>
<pre><code>## Warning: package &#39;cramer&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a>rep <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># 设置重复次数</span></span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y) <span class="co"># 汇集样本</span></span>
<span id="cb66-4"><a href="#cb66-4" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb66-5"><a href="#cb66-5" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb66-6"><a href="#cb66-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb66-7"><a href="#cb66-7" tabindex="-1"></a></span>
<span id="cb66-8"><a href="#cb66-8" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(rep) <span class="co"># 存储模拟统计量</span></span>
<span id="cb66-9"><a href="#cb66-9" tabindex="-1"></a></span>
<span id="cb66-10"><a href="#cb66-10" tabindex="-1"></a>T.hat <span class="ot">&lt;-</span>  <span class="fu">cramer.test</span>(x, y)<span class="sc">$</span>statistic</span>
<span id="cb66-11"><a href="#cb66-11" tabindex="-1"></a></span>
<span id="cb66-12"><a href="#cb66-12" tabindex="-1"></a><span class="co"># 进行模拟</span></span>
<span id="cb66-13"><a href="#cb66-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rep) {</span>
<span id="cb66-14"><a href="#cb66-14" tabindex="-1"></a>  <span class="co"># 从z中无放回地随机抽取n1个样本作为一组</span></span>
<span id="cb66-15"><a href="#cb66-15" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, n1, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb66-16"><a href="#cb66-16" tabindex="-1"></a>  z1 <span class="ot">&lt;-</span> z[k]</span>
<span id="cb66-17"><a href="#cb66-17" tabindex="-1"></a>  z2 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k]</span>
<span id="cb66-18"><a href="#cb66-18" tabindex="-1"></a>  reps[i] <span class="ot">&lt;-</span> <span class="fu">cramer.test</span>(z1, z2)<span class="sc">$</span>statistic</span>
<span id="cb66-19"><a href="#cb66-19" tabindex="-1"></a>}</span>
<span id="cb66-20"><a href="#cb66-20" tabindex="-1"></a></span>
<span id="cb66-21"><a href="#cb66-21" tabindex="-1"></a>p.hat <span class="ot">&lt;-</span>  <span class="fu">mean</span>(<span class="fu">abs</span>(T.hat) <span class="sc">&lt;</span> <span class="fu">abs</span>(reps))</span>
<span id="cb66-22"><a href="#cb66-22" tabindex="-1"></a>p.hat</span></code></pre></div>
<pre><code>## [1] 0.369</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="fu">hist</span>(reps, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">&quot;T (P = 0.75)&quot;</span>, <span class="at">breaks =</span> <span class="st">&quot;scott&quot;</span>)</span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a><span class="fu">points</span>(T.hat, <span class="dv">0</span>, <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3-5" class="section level2">
<h2>Question 3</h2>
<p>8.3</p>
<p>The Count 5 test for equal variances in Section 6.4 is based on the
maximum number of extreme points. Example 6.15 shows that the Count 5
criterion is not applicable for unequal sample sizes. Implement a
permutation test for equal variance based on the maximum number of
extreme points that applies when sample sizes are not necessarily
equal.</p>
<p>第6.4节中的Count
5方差相等性检验是基于极端点的最大数量。例子6.15表明，Count
5准则在样本大小不相等时不适用。现在我们要实现一个基于极端点最大数量的置换检验，用于判断样本方差是否相等，即使样本大小不一定相等。</p>
</div>
<div id="answer-3-5" class="section level2">
<h2>Answer 3</h2>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb69-3"><a href="#cb69-3" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" tabindex="-1"></a><span class="co"># 返回方差不相等的概率，其中 H0 表示方差相等（即 sd1 = sd2）</span></span>
<span id="cb69-5"><a href="#cb69-5" tabindex="-1"></a>test.equal.variance <span class="ot">&lt;-</span> <span class="cf">function</span>(xs1, xs2) {</span>
<span id="cb69-6"><a href="#cb69-6" tabindex="-1"></a>  <span class="co"># 将 xs1 设置为较小的样本，xs2 设置为较大的样本</span></span>
<span id="cb69-7"><a href="#cb69-7" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(xs2) <span class="sc">&lt;</span> <span class="fu">length</span>(xs1)) {</span>
<span id="cb69-8"><a href="#cb69-8" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> xs1</span>
<span id="cb69-9"><a href="#cb69-9" tabindex="-1"></a>    xs1 <span class="ot">&lt;-</span> xs2</span>
<span id="cb69-10"><a href="#cb69-10" tabindex="-1"></a>    xs2 <span class="ot">&lt;-</span> tmp</span>
<span id="cb69-11"><a href="#cb69-11" tabindex="-1"></a>  }</span>
<span id="cb69-12"><a href="#cb69-12" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> <span class="fu">length</span>(xs1)</span>
<span id="cb69-13"><a href="#cb69-13" tabindex="-1"></a>  n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(xs2)</span>
<span id="cb69-14"><a href="#cb69-14" tabindex="-1"></a>  </span>
<span id="cb69-15"><a href="#cb69-15" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">c</span>(xs1, xs2)</span>
<span id="cb69-16"><a href="#cb69-16" tabindex="-1"></a>  </span>
<span id="cb69-17"><a href="#cb69-17" tabindex="-1"></a>  <span class="co"># 如果一个样本中有五个以上的值超出另一个样本的范围，则返回 1。</span></span>
<span id="cb69-18"><a href="#cb69-18" tabindex="-1"></a>  count5 <span class="ot">&lt;-</span> <span class="cf">function</span>(x1, x2) {</span>
<span id="cb69-19"><a href="#cb69-19" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(x1) <span class="sc">==</span> <span class="fu">length</span>(x2))</span>
<span id="cb69-20"><a href="#cb69-20" tabindex="-1"></a>    extr1 <span class="ot">&lt;-</span> <span class="fu">sum</span>((x1 <span class="sc">&lt;</span> <span class="fu">min</span>(x2))) <span class="sc">+</span> <span class="fu">sum</span>((x1 <span class="sc">&gt;</span> <span class="fu">max</span>(x2)))</span>
<span id="cb69-21"><a href="#cb69-21" tabindex="-1"></a>    extr2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((x2 <span class="sc">&lt;</span> <span class="fu">min</span>(x1))) <span class="sc">+</span> <span class="fu">sum</span>((x2 <span class="sc">&gt;</span> <span class="fu">max</span>(x1)))</span>
<span id="cb69-22"><a href="#cb69-22" tabindex="-1"></a>    </span>
<span id="cb69-23"><a href="#cb69-23" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">max</span>(extr1, extr2)</span>
<span id="cb69-24"><a href="#cb69-24" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">as.integer</span>(out <span class="sc">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb69-25"><a href="#cb69-25" tabindex="-1"></a>  }</span>
<span id="cb69-26"><a href="#cb69-26" tabindex="-1"></a>  </span>
<span id="cb69-27"><a href="#cb69-27" tabindex="-1"></a>  <span class="co"># 运行置换测试。</span></span>
<span id="cb69-28"><a href="#cb69-28" tabindex="-1"></a>  <span class="co"># 如果 H0 成立，count 5 在从 y 中随机选取的 &quot;大多数&quot;（取决于所需的 p 值）大小相等的样本对中应返回 0。</span></span>
<span id="cb69-29"><a href="#cb69-29" tabindex="-1"></a>  rep <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb69-30"><a href="#cb69-30" tabindex="-1"></a>  n.min <span class="ot">&lt;-</span> n1</span>
<span id="cb69-31"><a href="#cb69-31" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb69-32"><a href="#cb69-32" tabindex="-1"></a>  c5s <span class="ot">&lt;-</span> <span class="fu">numeric</span>(rep)</span>
<span id="cb69-33"><a href="#cb69-33" tabindex="-1"></a>  size <span class="ot">&lt;-</span> <span class="fu">floor</span>(n <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb69-34"><a href="#cb69-34" tabindex="-1"></a>  </span>
<span id="cb69-35"><a href="#cb69-35" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rep) {</span>
<span id="cb69-36"><a href="#cb69-36" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, size, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb69-37"><a href="#cb69-37" tabindex="-1"></a>    y1 <span class="ot">&lt;-</span> y[k]</span>
<span id="cb69-38"><a href="#cb69-38" tabindex="-1"></a>    y2 <span class="ot">&lt;-</span> y[<span class="sc">-</span>k]</span>
<span id="cb69-39"><a href="#cb69-39" tabindex="-1"></a>    <span class="co"># 计算 count 5 测试返回 1 的次数（即方差不同）</span></span>
<span id="cb69-40"><a href="#cb69-40" tabindex="-1"></a>    c5s[i] <span class="ot">&lt;-</span> <span class="fu">count5</span>(y1, y2)</span>
<span id="cb69-41"><a href="#cb69-41" tabindex="-1"></a>  }</span>
<span id="cb69-42"><a href="#cb69-42" tabindex="-1"></a>  </span>
<span id="cb69-43"><a href="#cb69-43" tabindex="-1"></a>  <span class="co"># 绘制 count 5 结果的直方图</span></span>
<span id="cb69-44"><a href="#cb69-44" tabindex="-1"></a>  <span class="fu">hist</span>(c5s, <span class="at">probability =</span> <span class="cn">TRUE</span>)</span>
<span id="cb69-45"><a href="#cb69-45" tabindex="-1"></a>  </span>
<span id="cb69-46"><a href="#cb69-46" tabindex="-1"></a>  <span class="co"># 根据 count 5 测试计算方差不同的频率</span></span>
<span id="cb69-47"><a href="#cb69-47" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(c5s))</span>
<span id="cb69-48"><a href="#cb69-48" tabindex="-1"></a>}</span>
<span id="cb69-49"><a href="#cb69-49" tabindex="-1"></a></span>
<span id="cb69-50"><a href="#cb69-50" tabindex="-1"></a>mean <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb69-51"><a href="#cb69-51" tabindex="-1"></a><span class="co"># 使用不同标准差的随机正态分布样本进行三次测试，检验算法的效果。</span></span>
<span id="cb69-52"><a href="#cb69-52" tabindex="-1"></a>p_value1 <span class="ot">&lt;-</span> <span class="fu">test.equal.variance</span>(<span class="fu">rnorm</span>(n1, mean, <span class="dv">1</span>), <span class="fu">rnorm</span>(n2, mean, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a>p_value2 <span class="ot">&lt;-</span> <span class="fu">test.equal.variance</span>(<span class="fu">rnorm</span>(n1, mean, <span class="dv">10</span>), <span class="fu">rnorm</span>(n2, mean, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a>p_value3 <span class="ot">&lt;-</span> <span class="fu">test.equal.variance</span>(<span class="fu">rnorm</span>(n1, mean, <span class="dv">100</span>), <span class="fu">rnorm</span>(n2, mean, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="fu">print</span>(p_value1)</span></code></pre></div>
<pre><code>## [1] 0.116</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="fu">print</span>(p_value2)</span></code></pre></div>
<pre><code>## [1] 0.132</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="fu">print</span>(p_value3)</span></code></pre></div>
<pre><code>## [1] 0.138</code></pre>
</div>
<div id="hw7" class="section level2">
<h2>HW7</h2>
</div>
<div id="question-1-6" class="section level2">
<h2>Question 1</h2>
<p>Consider a model <span class="math inline">\(P(Y = 1 | X_1, X_2, X_3)
=
\frac{exp(a+b_1X_1+b_2X_2+b_3X_3)}{1+exp(a+b_1X_1+b_2X_2+b_3X_3)}\)</span>,
where <span class="math inline">\(X_1 \sim P(1), X_2 \sim Exp(1) and X_3
\sim B(1,0.5)\)</span>.</p>
<ul>
<li><p>Design a function that takes as input values N, b1, b2, b3 and
f0, and produces the output a.</p></li>
<li><p>Call this function, input values are <span class="math inline">\(N = 10^6\)</span>, <span class="math inline">\(b1
= 0\)</span>, <span class="math inline">\(b2 = 1\)</span>, <span class="math inline">\(b3 = −1\)</span>, <span class="math inline">\(f_0
= 0.1, 0.01, 0.001, 0.0001\)</span>.</p></li>
<li><p>Plot <span class="math inline">\(−logf_0\)</span> vs <span class="math inline">\(a\)</span>.</p></li>
</ul>
<p>考虑一个模型 <span class="math inline">\(P(Y = 1 | X_1, X_2, X_3) =
\frac{exp(a+b_1X_1+b_2X_2+b_3X_3)}{1+exp(a+b_1X_1+b_2X_2+b_3X_3)}\)</span>
，其中 <span class="math inline">\(X_1 \sim P(1)，X_2 \sim Exp(1)，X_3
\sim B(1,0.5)\)</span> 。</p>
<ul>
<li><p>设计一个函数，该函数以<span class="math inline">\(N、b1、b2、b3\)</span>和<span class="math inline">\(f_0\)</span>作为输入值，并产生输出<span class="math inline">\(a\)</span>。</p></li>
<li><p>调用这个函数，输入值为 <span class="math inline">\(N = 10^6，b1 =
0，b2 = 1，b3 = −1，f0 = 0.1，0.01，0.001，0.0001\)</span>。</p></li>
<li><p>绘制<span class="math inline">\(−log f_0\)</span>vs<span class="math inline">\(a\)</span>。</p></li>
</ul>
</div>
<div id="answer-1-6" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a><span class="co"># 定义计算a的函数</span></span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a>calculate_a <span class="ot">&lt;-</span> <span class="cf">function</span>(N, b1, b2, b3, f0) {</span>
<span id="cb78-3"><a href="#cb78-3" tabindex="-1"></a>  <span class="co"># 生成 X1, X2, X3</span></span>
<span id="cb78-4"><a href="#cb78-4" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb78-5"><a href="#cb78-5" tabindex="-1"></a>  X2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb78-6"><a href="#cb78-6" tabindex="-1"></a>  X3 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, N, <span class="fl">0.5</span>)</span>
<span id="cb78-7"><a href="#cb78-7" tabindex="-1"></a>  </span>
<span id="cb78-8"><a href="#cb78-8" tabindex="-1"></a>  <span class="co"># 计算 a</span></span>
<span id="cb78-9"><a href="#cb78-9" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">log</span>(f0) <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> f0) <span class="sc">-</span> b1 <span class="sc">*</span> X1 <span class="sc">-</span> b2 <span class="sc">*</span> X2 <span class="sc">-</span> b3 <span class="sc">*</span> X3</span>
<span id="cb78-10"><a href="#cb78-10" tabindex="-1"></a>  </span>
<span id="cb78-11"><a href="#cb78-11" tabindex="-1"></a>  <span class="fu">return</span>(a)</span>
<span id="cb78-12"><a href="#cb78-12" tabindex="-1"></a>}</span>
<span id="cb78-13"><a href="#cb78-13" tabindex="-1"></a></span>
<span id="cb78-14"><a href="#cb78-14" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">6</span></span>
<span id="cb78-15"><a href="#cb78-15" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb78-16"><a href="#cb78-16" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb78-17"><a href="#cb78-17" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb78-18"><a href="#cb78-18" tabindex="-1"></a>f0_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>, <span class="fl">0.0001</span>)</span>
<span id="cb78-19"><a href="#cb78-19" tabindex="-1"></a></span>
<span id="cb78-20"><a href="#cb78-20" tabindex="-1"></a><span class="co"># 计算a的结果</span></span>
<span id="cb78-21"><a href="#cb78-21" tabindex="-1"></a>a_values <span class="ot">&lt;-</span> <span class="fu">calculate_a</span>(N, b1, b2, b3, f0_values)</span>
<span id="cb78-22"><a href="#cb78-22" tabindex="-1"></a></span>
<span id="cb78-23"><a href="#cb78-23" tabindex="-1"></a><span class="co"># 绘制结果图表</span></span>
<span id="cb78-24"><a href="#cb78-24" tabindex="-1"></a><span class="fu">plot</span>(<span class="sc">-</span><span class="fu">log</span>(f0_values), a_values, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb78-25"><a href="#cb78-25" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;-log f0&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;a&quot;</span>, <span class="at">main =</span> <span class="st">&quot;-log f0 vs a&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2-6" class="section level2">
<h2>Question 2</h2>
<p>9.4</p>
<p>Implement a random walk Metropolis sampler for generating the
standard Laplace distribution (see Exercise 3.2). For the increment,
simulate from a normal distribution. Compare the chains generated when
diﬀerent variances are used for the proposal distribution. Also, compute
the acceptance rates of each chain.</p>
<p>实现一个随机行走Metropolis采样器，用于生成标准拉普拉斯分布（参见练习3.2）。对于增量，从正态分布中模拟。比较在提议分布使用不同方差时生成的链，并计算每个链的接受率。</p>
</div>
<div id="answer-2-6" class="section level2">
<h2>Answer 2</h2>
<p>R语言代码如下：</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="co"># 定义标准拉普拉斯分布的概率密度函数</span></span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a>laplace_pdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x)))</span>
<span id="cb79-4"><a href="#cb79-4" tabindex="-1"></a>}</span>
<span id="cb79-5"><a href="#cb79-5" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" tabindex="-1"></a><span class="co"># 实现随机行走Metropolis采样器</span></span>
<span id="cb79-7"><a href="#cb79-7" tabindex="-1"></a>random_walk_metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(N, sigma) {</span>
<span id="cb79-8"><a href="#cb79-8" tabindex="-1"></a>  <span class="co"># 初始化采样链和接受计数</span></span>
<span id="cb79-9"><a href="#cb79-9" tabindex="-1"></a>  chain <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb79-10"><a href="#cb79-10" tabindex="-1"></a>  accept_count <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb79-11"><a href="#cb79-11" tabindex="-1"></a>  </span>
<span id="cb79-12"><a href="#cb79-12" tabindex="-1"></a>  <span class="co"># 设置初始状态</span></span>
<span id="cb79-13"><a href="#cb79-13" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb79-14"><a href="#cb79-14" tabindex="-1"></a>  </span>
<span id="cb79-15"><a href="#cb79-15" tabindex="-1"></a>  <span class="co"># 进行采样</span></span>
<span id="cb79-16"><a href="#cb79-16" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb79-17"><a href="#cb79-17" tabindex="-1"></a>    <span class="co"># 从提议分布中抽取增量</span></span>
<span id="cb79-18"><a href="#cb79-18" tabindex="-1"></a>    increment <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">0</span>, sigma)</span>
<span id="cb79-19"><a href="#cb79-19" tabindex="-1"></a>    </span>
<span id="cb79-20"><a href="#cb79-20" tabindex="-1"></a>    <span class="co"># 计算接受率</span></span>
<span id="cb79-21"><a href="#cb79-21" tabindex="-1"></a>    alpha <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="dv">1</span>, <span class="fu">laplace_pdf</span>(x <span class="sc">+</span> increment) <span class="sc">/</span> <span class="fu">laplace_pdf</span>(x))</span>
<span id="cb79-22"><a href="#cb79-22" tabindex="-1"></a>    </span>
<span id="cb79-23"><a href="#cb79-23" tabindex="-1"></a>    <span class="co"># 决定是否接受增量</span></span>
<span id="cb79-24"><a href="#cb79-24" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> alpha) {</span>
<span id="cb79-25"><a href="#cb79-25" tabindex="-1"></a>      x <span class="ot">&lt;-</span> x <span class="sc">+</span> increment</span>
<span id="cb79-26"><a href="#cb79-26" tabindex="-1"></a>      accept_count <span class="ot">&lt;-</span> accept_count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb79-27"><a href="#cb79-27" tabindex="-1"></a>    }</span>
<span id="cb79-28"><a href="#cb79-28" tabindex="-1"></a>    </span>
<span id="cb79-29"><a href="#cb79-29" tabindex="-1"></a>    <span class="co"># 记录当前状态到采样链中</span></span>
<span id="cb79-30"><a href="#cb79-30" tabindex="-1"></a>    chain[i] <span class="ot">&lt;-</span> x</span>
<span id="cb79-31"><a href="#cb79-31" tabindex="-1"></a>  }</span>
<span id="cb79-32"><a href="#cb79-32" tabindex="-1"></a>  </span>
<span id="cb79-33"><a href="#cb79-33" tabindex="-1"></a>  <span class="co"># 计算接受率</span></span>
<span id="cb79-34"><a href="#cb79-34" tabindex="-1"></a>  acceptance_rate <span class="ot">&lt;-</span> accept_count <span class="sc">/</span> N</span>
<span id="cb79-35"><a href="#cb79-35" tabindex="-1"></a>  </span>
<span id="cb79-36"><a href="#cb79-36" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">chain =</span> chain, <span class="at">acceptance_rate =</span> acceptance_rate))</span>
<span id="cb79-37"><a href="#cb79-37" tabindex="-1"></a>}</span>
<span id="cb79-38"><a href="#cb79-38" tabindex="-1"></a></span>
<span id="cb79-39"><a href="#cb79-39" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb79-40"><a href="#cb79-40" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb79-41"><a href="#cb79-41" tabindex="-1"></a>sigma_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb79-42"><a href="#cb79-42" tabindex="-1"></a></span>
<span id="cb79-43"><a href="#cb79-43" tabindex="-1"></a><span class="co"># 生成不同方差下的链并计算接受率</span></span>
<span id="cb79-44"><a href="#cb79-44" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb79-45"><a href="#cb79-45" tabindex="-1"></a><span class="cf">for</span> (sigma <span class="cf">in</span> sigma_values) {</span>
<span id="cb79-46"><a href="#cb79-46" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">random_walk_metropolis</span>(N, sigma)</span>
<span id="cb79-47"><a href="#cb79-47" tabindex="-1"></a>  results[[<span class="fu">as.character</span>(sigma)]] <span class="ot">&lt;-</span> result</span>
<span id="cb79-48"><a href="#cb79-48" tabindex="-1"></a>}</span>
<span id="cb79-49"><a href="#cb79-49" tabindex="-1"></a></span>
<span id="cb79-50"><a href="#cb79-50" tabindex="-1"></a><span class="co"># 输出接受率</span></span>
<span id="cb79-51"><a href="#cb79-51" tabindex="-1"></a><span class="cf">for</span> (sigma <span class="cf">in</span> sigma_values) {</span>
<span id="cb79-52"><a href="#cb79-52" tabindex="-1"></a>  acceptance_rate <span class="ot">&lt;-</span> results[[<span class="fu">as.character</span>(sigma)]]<span class="sc">$</span>acceptance_rate</span>
<span id="cb79-53"><a href="#cb79-53" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Acceptance rate for sigma =&quot;</span>, sigma, <span class="st">&quot;:&quot;</span>, acceptance_rate, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb79-54"><a href="#cb79-54" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Acceptance rate for sigma = 0.1 : 0.9624 
## Acceptance rate for sigma = 0.5 : 0.8293 
## Acceptance rate for sigma = 1 : 0.7034 
## Acceptance rate for sigma = 2 : 0.5337</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a><span class="co"># 绘制不同方差下的链</span></span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a><span class="cf">for</span> (sigma <span class="cf">in</span> sigma_values) {</span>
<span id="cb81-3"><a href="#cb81-3" tabindex="-1"></a>  chain <span class="ot">&lt;-</span> results[[<span class="fu">as.character</span>(sigma)]]<span class="sc">$</span>chain</span>
<span id="cb81-4"><a href="#cb81-4" tabindex="-1"></a>  <span class="fu">plot</span>(chain, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Chain (sigma =&quot;</span>, sigma, <span class="st">&quot;)&quot;</span>))</span>
<span id="cb81-5"><a href="#cb81-5" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3-6" class="section level2">
<h2>Question 3</h2>
<p>9.7</p>
<p>Implement a Gibbs sampler to generate a bivariate normal chain <span class="math inline">\((X_t，Y_t)\)</span> with zero means, unit standard
deviations, and correlation 0.9. Plot the generated sample after
discarding a suitable burn-in sample. Fit a simple linear regression
model <span class="math inline">\(Y=β_0+β_1X\)</span> to the sample and
check the residuals of the model for normality and constant
variance.</p>
<p>实现Gibbs采样器以生成具有零均值、单位标准差和相关性0.9的二元正态链<span class="math inline">\((X_t，Y_t)\)</span>。在丢弃合适的老化样本后，绘制生成的样本。将简单的线性回归模型<span class="math inline">\(Y=β_0+β_1X\)</span>与样本进行拟合，并检查模型的残差是否为正态分布和常方差。</p>
</div>
<div id="answer-3-6" class="section level2">
<h2>Answer 3</h2>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">5000</span></span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a>burn <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb82-3"><a href="#cb82-3" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, m, <span class="dv">2</span>)</span>
<span id="cb82-5"><a href="#cb82-5" tabindex="-1"></a></span>
<span id="cb82-6"><a href="#cb82-6" tabindex="-1"></a>rho <span class="ot">=</span> <span class="fl">0.9</span></span>
<span id="cb82-7"><a href="#cb82-7" tabindex="-1"></a>mu1 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb82-8"><a href="#cb82-8" tabindex="-1"></a>mu2 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb82-9"><a href="#cb82-9" tabindex="-1"></a>sigma1 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb82-10"><a href="#cb82-10" tabindex="-1"></a>sigma2 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb82-11"><a href="#cb82-11" tabindex="-1"></a>s1 <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb82-12"><a href="#cb82-12" tabindex="-1"></a>s2 <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb82-13"><a href="#cb82-13" tabindex="-1"></a></span>
<span id="cb82-14"><a href="#cb82-14" tabindex="-1"></a>mean12 <span class="ot">=</span> <span class="cf">function</span> (x2) mu1 <span class="sc">+</span> rho<span class="sc">*</span>sigma1<span class="sc">/</span>sigma2<span class="sc">*</span>(x2 <span class="sc">-</span> mu2)</span>
<span id="cb82-15"><a href="#cb82-15" tabindex="-1"></a>mean21 <span class="ot">=</span> <span class="cf">function</span> (x1) mu2 <span class="sc">+</span> rho<span class="sc">*</span>sigma2<span class="sc">/</span>sigma1<span class="sc">*</span>(x1 <span class="sc">-</span> mu1)</span>
<span id="cb82-16"><a href="#cb82-16" tabindex="-1"></a></span>
<span id="cb82-17"><a href="#cb82-17" tabindex="-1"></a>x[<span class="dv">1</span>,] <span class="ot">=</span> <span class="fu">c</span>(mu1, mu2)</span>
<span id="cb82-18"><a href="#cb82-18" tabindex="-1"></a></span>
<span id="cb82-19"><a href="#cb82-19" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb82-20"><a href="#cb82-20" tabindex="-1"></a>  xt <span class="ot">=</span> x[i<span class="dv">-1</span>,]</span>
<span id="cb82-21"><a href="#cb82-21" tabindex="-1"></a>  xt[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="fu">mean12</span>(xt[<span class="dv">2</span>]), s1)</span>
<span id="cb82-22"><a href="#cb82-22" tabindex="-1"></a>  xt[<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="fu">mean21</span>(xt[<span class="dv">1</span>]), s2)</span>
<span id="cb82-23"><a href="#cb82-23" tabindex="-1"></a>  x[i,] <span class="ot">=</span> xt</span>
<span id="cb82-24"><a href="#cb82-24" tabindex="-1"></a>}</span>
<span id="cb82-25"><a href="#cb82-25" tabindex="-1"></a></span>
<span id="cb82-26"><a href="#cb82-26" tabindex="-1"></a>x <span class="ot">=</span> x[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m,]</span>
<span id="cb82-27"><a href="#cb82-27" tabindex="-1"></a></span>
<span id="cb82-28"><a href="#cb82-28" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">data.frame</span>(x)</span>
<span id="cb82-29"><a href="#cb82-29" tabindex="-1"></a>lin.reg <span class="ot">=</span> <span class="fu">lm</span>(X1 <span class="sc">~</span> X2, <span class="at">data =</span> x)</span>
<span id="cb82-30"><a href="#cb82-30" tabindex="-1"></a></span>
<span id="cb82-31"><a href="#cb82-31" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb82-32"><a href="#cb82-32" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">main =</span> <span class="st">&quot;generated data&quot;</span>)</span>
<span id="cb82-33"><a href="#cb82-33" tabindex="-1"></a><span class="fu">hist</span>(lin.reg<span class="sc">$</span>residuals, <span class="at">main =</span> <span class="st">&quot;residuals of linear model&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA21BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrYoFwA6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmOpBmZjpmZrZmkJBmkLZmkNtmtrZmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q29uQ2/+2ZgC2Zjq2Zma2ZpC2kDq2kGa2tma225C227a229u22/+2/7a2///T09PbkDrbkGbbtmbbtpDb25Db27bb29vb2//b/7bb////tmb/25D/27b//7b//9v////wuMnzAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMyElEQVR4nO2d+4PjphHH2b3duk6vedS+y/WV2Mm1adfXd7cbNWnaWF5b//9fVGAEQs9BMNJie74/7EMaBvgYBiwhJArWoMRLFyB1MSBEDAgRA0LEgBAxIEQMCBEDQsSAEDEgRAwIEQNCxIAQMSBEDAgRA0LEgBAxIEQMCBEDQsSAEDEgRAwIEQNCxIAQMSBEDAgRA0LEgBAxIEQMCBEDQjQZoNOfn7oO78Tt0/CBMvlW3O8Rm5Zdt8WHpRCfWVs8QV1TAXp+212n+QHlQmplbVMB1FcnX0C+Nnh9M3Hz4GvboT5Apw9C3D1AydTfN5/tIbM/6hPGxB7+/Vtx+1h8/1Z+Wh8/qCpJybSVjW7qd984dXUP2IQ/lfafPtrKODZgeFzr1mDtS7t/vy7TGX3/uRCvfrMvSwKInBbUU5HKr61TDyDpRvl9rQoly6R096RSgVSGrcP3+9yeLQE5NuARsDlZwIEqoTkC9XBtXECVvalvzbUtqDzVB6izIpVfW6ceQNJysT/tTMkei8NSFUymuntUP1dF4/D9Y/FfmfdP9uUhqI5jAx4/VLVwDjgJF/viO+Ue6uEmcgA59tpOHjTpQPIUUFi1upgF1FERtwJlnfq6mC2NbgUr/ZnIIzLVRme/KNqHtX74q2zsi9KBa+N4bGXhJLz7p1OZmk2ti1l7bScLZNK5vuFXH6CuijgVMHXqBmTCmcpBerENLzNtclG0D8tkX8MhA8ixkR4XTtF1FtWBKqEoQ4epTGXjAqrsjZ1JVyt+5hauGYO6KuJUwCTrBqRTliUr+2UTUPuwjhh3v/thbQE5Nq7HVhZOQjD/Q9V1GoBMVzD2UN/ntyZdzXeuWgEGyCmkW4FhQI0WZPpPA3zjcNl5j2u3BW06PHZlYRI+v3+tY2NtztIE5NgbE5MuqAWZQroVGAbUiEGLDkDtw/CBuUHatRmKQW5CWY+voFE1YhBkkqu46tg7cxudzvU9GIO6KuKWAwFUH8Vuviye1w2/7cMwdjxvnS7s2Lgem1k4CX+h+4uph5tIDznKaOVmpO2kmUlnmwI2inVVpF2BXkAd8yCYHFR+W4erWcsCZhR2HqTP7qopjfmYzQEnoQ2X0DKcRDaYrtyMwO5DNX8xbVpLuUABVYV0K4AA0rPLTx6hqT5/Lcump6mu39ZhGFzuvsnMFFrONCqb4vSXpXj1pTuTrg5UCVUk+diZSTuJDjISf/oPO4qBfWn3nUlnpGfSvy0KD0BOIZ0KYIDMhzz+y8uFqTdIqysEeiJ15eoP0o1efa3q62LPny8b34+vVHzJFREDQsSAEDEgRAwIEQNCxIAQMSBEDAgRA0LEgBAxIEQMCBEDQsSAEDEgRAwIEQNCxIAQMSBEDAgRA0LEgBAxIEQMCBEDQsSAEBEDEr2izWc+UQOaKZ/5NAsg2X4Y0IA7oRGdqQIKng+sq+pyl0gMCizDuEQ7IVaHT/bFcb3pNuhwl0qQFt9OD2in1nbr1pP1LO68bkC63Rw+0ovq648ADo7m+vCVAFKPCpz+V4xqQSW+8UUj1hxdLDPtBlB5uUtmojgHoCKD4SsXPTG67U4N8cX1ABrvLp2vGmkDuo4gHeJOXNMwH+SOu9iwu6S6WEghJgYkGNCwOwaEuGNAw+5EOCD3iWkSXRogeDC35xtNiJIGFJoPJaMXBdR3uSMWECDCd2DykEixBYlIQOrJ2U1x2o5+9LrjA0sRkIiKQep5fyCThzehxAGJCEDHNcUT10kDcvm81DzoogHt9O4mcYNY0oCKOEA7HYCO66jp4pkACsnH3HqLiNDFRQM6baFzZZSAAhDNEYOKoC6W6TsDh2VUEGoACrhmNh0gEQkIdlSKHOsTBuSMYUFdjL48qQEqGNCwu9gWZDYUowzSSQGKbUE7ii/x8wIqt4sb+ly7g/TIfMrMKC4EzdyCTts+LjUYjUOhgDZjk3QVzCnPHF3stEUm/nSA0KzACIlTs8eg/nUd7QLFAUKzKtRccmVs0eU4yQXp+C42HO2K6ttI4bOgKzVAIroF4XLCVN9X2rMANEU+WpfSgkLzOaoNendDg31mwtQZxqB4QPnNQ6Y2JR8iZAJV722PCwak+o/qOKTXgyIAqRt0ur3SFKgZo8MmigoQ6RXFcEBq+Spc/k0FkGlBu6G7hrNNFGE80LcwyQE1S+oriEHZ0HRxvomimVHIjysZQBCBh64ozjjM26x2CxJArR4280SxmXthAY0uh4lB1etAiAHVT5AqpAWFArJzrt4rGsNemu0lHpDHd7ERE0XlKA4Qkchb0PAo7z1RLOmQAPpTfBdrh6DwD2JHcus5FtDxV+b/w5IgBok2oWBANBPFaEBmMY7PGwc9CkQIyGNUPSx750pkXQze5BX/Hg3yLja0umPETQSCGJSLm1/Gv0YDLo5RAELjb2EHrzlaUFG9Mi5KdIC8dFwrfvMAylQLir5XRz+KIVJPqc8ByL5IKvJuHR0gjwCjJb+wzgCIeBRr8wm+7TP4bV7rsHw1AyCveZD3qEEB6LSFWvd9y3It+yHOPJPGv6jRATq+gTadxkTRV363njtCUHgLGryiiGpuQH63njv4hF1RLOxWBqGaHVCflxoRGkAQ8iJfIZgKoLo7ki5GWJ5iZkDOhbxOd10TaQbkuOviM82tZ1xJAup8/jAoSKO3nlElCairAb30recLBER76zmpUYy2BZ3ZRNHHHQ0gn1vPfuXRvy8QEH7r2bM8+neagKbLZ0x59G8LaGxBpgQUlc/QUIAXo1mGNAFFtSDalfYpAeoMQSFBmvJhljQBReXjs3jBqzz6V5KApsxnRHn0r5cG5LaaTj7XDsh1RwGIJkIXSQLq2VkyAFDUQF/PNilAZC3oQgHRdbELBdTNhwEZd8IgisrnkgF1x2gGZN0RdbFqZnV+M+nhF49087mWiaLHi0cSBKTKUwEaiWiUtceLR3p62MsC+tYFNPKBljHW/S8eqdz18LkWQPiLR3r4XAcgnxeP9HXy6wDU++IR0VBsPmSaGxDuTg1jXV6vCdDwrWfBgDxWd5DkQyGVrUgNUGotqAVoVFnOG5DXc/OJASrDNEE+uPyem28DGoOIfhTrdjkFIM+nntuAxoShcwbk89x8n7wzmeB60Bz5aHm0oHjRX7SfJR8Q/tx8vM4akNdzm5E6b0AziP6uRmxUJFZiQbr05/584cYj7Oy18ad/euryFAwI9ceAEH8MCPHHgBB/DAjxx4AQfwwI8ceArkcMCBEDQsSAEDEgRAwIEQNCxIAQMSBEDAgRA0LEgBAxIEQTAIrbbYNQh5+ZG/ZwgzFoJ1Z6QPmU9znH6Li2KxpgcXeQyAHpfaOonYYod9ZVRTyDTw4ou/8qCUC5WFVYsvB9jqkBycacTAyqAO1+LkNQ2AIQYkBqyU56gGDb6bD94ogBxe8ZRahG5AkLRLSA9GiRKqCBbacHRAZIvaBslZWLS0JKQqbMxJsmoKCx/pInihYQtJ0UuphWeoDg9S5JBGmltADBFti74H7PX1YRMSBEDAgRA0LEgBAxIEQMCBEDQsSAEDEgRAwIEQNCxIAQMSBEDAgRA0LEgBAxIEQMCBEDQsSAEDEgRAwIEQNCxIAQMSBElw7o+C7yPjg9oMMS7s2Xux9Va3GpdFxvvF9Mshtaeld5yTt2EC/PTtCCYDuow3IF2VC85KmmEa9t2d3+691/PNZNzQtIFuvJvFc8j9yTvkv+gA7LjexiHqtNZgZ0XC/KnZVra3Hp3Osudlx/sTZrWo5v3qsPwq4tkz3r5v3NAwBqnz8s9WoYQJCBrf5H/yiXyqi/lSFx6bUOy1/bdj0hIPmxl/s3wzJW9Y/u2aoJ50JV+v5HAFQ7rxec5QIiWWVbQlGLrZSl/FsZTjOKZVVknBDQyi7M1H/DLuAyPzi40zjgCY36eVMkaCOlrQF0fPMAbuXfynASQKctyVMAPbKANjZQ6F8QSGTdIEv4Vz3GsmqcNwOHOmptXXd52QGV4SSAdvc/rs3i/xkBmSW2mQtIBunbp/p52CMXPGQtQDIm3f4dWpA2JC69ktrR3W79OHcLsllaQIePHurntcpe1WpBus+VXUzZTQDosFxAAZzSUqoPkB3+Ia7IQKvq/W7f6D91L9bWhDRd3lxMCOi01Uhg4JgTEAxp6oOpjWKqt9fP66ZksKmDyva0vd/LHrWBxgNxSxmSA1KZ6D9yeMJvckBqSlpyysze23Iqc/s3PV2FBw0b51U0goG8sPMgHc6/gBh082A64AvukDm54JNJ8Mvqy0vHld53o4zUJQKCAZ3ogZqLBEQpBoSIASFiQIgYECIGhIgBIWJAiBgQIgaEiAEhYkCIGBAiBoSIASFiQIgYECIGhIgBIWJAiBgQov8DsHjPet6eOAMAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
</div>
<div id="question-4-3" class="section level2">
<h2>Question 4</h2>
<p>9.10</p>
<p>Refer to Example 9.1. Use the Gelman-Rubin method to monitor
convergence of the chain, and run the chain until the chain has
converged approximately to the target distribution according to <span class="math inline">\(\hat{R} &lt; 1.2\)</span>. (See Exercise 9.9.)
Also use the coda [212] package to check for convergence of the chain by
the Gelman-Rubin method. Hints: See the help topics for the coda
functions gelman.diag, gelman.plot, as.mcmc, and mcmc.list.</p>
<p>参考例9.1。使用Gelman-Rubin方法来监控链的收敛性，并运行链，直到链根据<span class="math inline">\(\hat{R}&lt;1.2\)</span>收敛到目标分布。（参见练习9.9。）还使用coda
[212]包通过Gelman-Rubin方法检查链的收敛性。提示：请参阅coda函数gelman.diDEag，gelman.plot，as.mcmc和mcmc.list的帮助主题。</p>
</div>
<div id="answer-4-3" class="section level2">
<h2>Answer 4</h2>
<p>R语言代码如下</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a><span class="co"># 定义瑞利分布的概率密度函数</span></span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a>rayleigh_pdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x, sigma) {</span>
<span id="cb84-3"><a href="#cb84-3" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(x <span class="sc">&lt;</span> <span class="dv">0</span>)) <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb84-4"><a href="#cb84-4" tabindex="-1"></a>  <span class="fu">stopifnot</span>(sigma <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb84-5"><a href="#cb84-5" tabindex="-1"></a>  <span class="fu">return</span>(x <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb84-6"><a href="#cb84-6" tabindex="-1"></a>}</span>
<span id="cb84-7"><a href="#cb84-7" tabindex="-1"></a></span>
<span id="cb84-8"><a href="#cb84-8" tabindex="-1"></a><span class="co"># Metropolis-Hastings采样算法</span></span>
<span id="cb84-9"><a href="#cb84-9" tabindex="-1"></a>metropolis_hastings_sampler <span class="ot">&lt;-</span> <span class="cf">function</span>(n, sigma, initial_value) {</span>
<span id="cb84-10"><a href="#cb84-10" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb84-11"><a href="#cb84-11" tabindex="-1"></a>  x <span class="ot">&lt;-</span> initial_value</span>
<span id="cb84-12"><a href="#cb84-12" tabindex="-1"></a>  </span>
<span id="cb84-13"><a href="#cb84-13" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb84-14"><a href="#cb84-14" tabindex="-1"></a>    <span class="co"># 从建议分布中生成新样本</span></span>
<span id="cb84-15"><a href="#cb84-15" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> x, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb84-16"><a href="#cb84-16" tabindex="-1"></a>    </span>
<span id="cb84-17"><a href="#cb84-17" tabindex="-1"></a>    <span class="co"># 计算接受比率</span></span>
<span id="cb84-18"><a href="#cb84-18" tabindex="-1"></a>    alpha <span class="ot">&lt;-</span> <span class="fu">rayleigh_pdf</span>(y, sigma) <span class="sc">/</span> <span class="fu">rayleigh_pdf</span>(x, sigma)</span>
<span id="cb84-19"><a href="#cb84-19" tabindex="-1"></a>    </span>
<span id="cb84-20"><a href="#cb84-20" tabindex="-1"></a>    <span class="co"># 决定是否接受新样本</span></span>
<span id="cb84-21"><a href="#cb84-21" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb84-22"><a href="#cb84-22" tabindex="-1"></a>    <span class="cf">if</span> (u <span class="sc">&lt;=</span> alpha) {</span>
<span id="cb84-23"><a href="#cb84-23" tabindex="-1"></a>      x <span class="ot">&lt;-</span> y</span>
<span id="cb84-24"><a href="#cb84-24" tabindex="-1"></a>    }</span>
<span id="cb84-25"><a href="#cb84-25" tabindex="-1"></a>    </span>
<span id="cb84-26"><a href="#cb84-26" tabindex="-1"></a>    <span class="co"># 保存样本值</span></span>
<span id="cb84-27"><a href="#cb84-27" tabindex="-1"></a>    samples[i] <span class="ot">&lt;-</span> x</span>
<span id="cb84-28"><a href="#cb84-28" tabindex="-1"></a>  }</span>
<span id="cb84-29"><a href="#cb84-29" tabindex="-1"></a>  </span>
<span id="cb84-30"><a href="#cb84-30" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb84-31"><a href="#cb84-31" tabindex="-1"></a>}</span>
<span id="cb84-32"><a href="#cb84-32" tabindex="-1"></a></span>
<span id="cb84-33"><a href="#cb84-33" tabindex="-1"></a><span class="co"># 计算Gelman-Rubin统计量</span></span>
<span id="cb84-34"><a href="#cb84-34" tabindex="-1"></a>gelman_rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(chains) {</span>
<span id="cb84-35"><a href="#cb84-35" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(chains)  <span class="co"># 链的数量</span></span>
<span id="cb84-36"><a href="#cb84-36" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">sapply</span>(chains, length))  <span class="co"># 所有链中的最小长度</span></span>
<span id="cb84-37"><a href="#cb84-37" tabindex="-1"></a>  </span>
<span id="cb84-38"><a href="#cb84-38" tabindex="-1"></a>  <span class="co"># 截取所有链到相同的长度</span></span>
<span id="cb84-39"><a href="#cb84-39" tabindex="-1"></a>  chains <span class="ot">&lt;-</span> <span class="fu">lapply</span>(chains, <span class="cf">function</span>(x) x[<span class="dv">1</span><span class="sc">:</span>n])</span>
<span id="cb84-40"><a href="#cb84-40" tabindex="-1"></a>  </span>
<span id="cb84-41"><a href="#cb84-41" tabindex="-1"></a>  <span class="co"># 计算每条链的均值</span></span>
<span id="cb84-42"><a href="#cb84-42" tabindex="-1"></a>  chain_means <span class="ot">&lt;-</span> <span class="fu">sapply</span>(chains, mean)</span>
<span id="cb84-43"><a href="#cb84-43" tabindex="-1"></a>  </span>
<span id="cb84-44"><a href="#cb84-44" tabindex="-1"></a>  <span class="co"># 计算所有链的均值</span></span>
<span id="cb84-45"><a href="#cb84-45" tabindex="-1"></a>  all_means <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(<span class="fu">do.call</span>(rbind, chains))</span>
<span id="cb84-46"><a href="#cb84-46" tabindex="-1"></a>  </span>
<span id="cb84-47"><a href="#cb84-47" tabindex="-1"></a>  <span class="co"># 计算B</span></span>
<span id="cb84-48"><a href="#cb84-48" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(chain_means)</span>
<span id="cb84-49"><a href="#cb84-49" tabindex="-1"></a>  </span>
<span id="cb84-50"><a href="#cb84-50" tabindex="-1"></a>  <span class="co"># 计算W</span></span>
<span id="cb84-51"><a href="#cb84-51" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">sapply</span>(chains, var))</span>
<span id="cb84-52"><a href="#cb84-52" tabindex="-1"></a>  </span>
<span id="cb84-53"><a href="#cb84-53" tabindex="-1"></a>  <span class="co"># 计算var_hat</span></span>
<span id="cb84-54"><a href="#cb84-54" tabindex="-1"></a>  var_hat <span class="ot">&lt;-</span> ((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n) <span class="sc">*</span> W <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> n) <span class="sc">*</span> B</span>
<span id="cb84-55"><a href="#cb84-55" tabindex="-1"></a>  </span>
<span id="cb84-56"><a href="#cb84-56" tabindex="-1"></a>  <span class="co"># 计算Gelman-Rubin统计量</span></span>
<span id="cb84-57"><a href="#cb84-57" tabindex="-1"></a>  R_hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(var_hat <span class="sc">/</span> W)</span>
<span id="cb84-58"><a href="#cb84-58" tabindex="-1"></a>  </span>
<span id="cb84-59"><a href="#cb84-59" tabindex="-1"></a>  <span class="fu">return</span>(R_hat)</span>
<span id="cb84-60"><a href="#cb84-60" tabindex="-1"></a>}</span>
<span id="cb84-61"><a href="#cb84-61" tabindex="-1"></a></span>
<span id="cb84-62"><a href="#cb84-62" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb84-63"><a href="#cb84-63" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">4</span>  <span class="co"># 瑞利分布的尺度参数</span></span>
<span id="cb84-64"><a href="#cb84-64" tabindex="-1"></a>initial_value <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># 初始样本值</span></span>
<span id="cb84-65"><a href="#cb84-65" tabindex="-1"></a>target_R_hat <span class="ot">&lt;-</span> <span class="fl">1.2</span>  <span class="co"># 目标Gelman-Rubin统计量</span></span>
<span id="cb84-66"><a href="#cb84-66" tabindex="-1"></a></span>
<span id="cb84-67"><a href="#cb84-67" tabindex="-1"></a><span class="co"># 初始化链</span></span>
<span id="cb84-68"><a href="#cb84-68" tabindex="-1"></a>chains <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb84-69"><a href="#cb84-69" tabindex="-1"></a></span>
<span id="cb84-70"><a href="#cb84-70" tabindex="-1"></a><span class="cf">while</span> (<span class="cn">TRUE</span>) {</span>
<span id="cb84-71"><a href="#cb84-71" tabindex="-1"></a>  <span class="co"># 生成样本</span></span>
<span id="cb84-72"><a href="#cb84-72" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">metropolis_hastings_sampler</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">sigma =</span> sigma, <span class="at">initial_value =</span> initial_value)</span>
<span id="cb84-73"><a href="#cb84-73" tabindex="-1"></a>  </span>
<span id="cb84-74"><a href="#cb84-74" tabindex="-1"></a>  <span class="co"># 将样本添加到链中</span></span>
<span id="cb84-75"><a href="#cb84-75" tabindex="-1"></a>  chains <span class="ot">&lt;-</span> <span class="fu">c</span>(chains, <span class="fu">list</span>(samples))</span>
<span id="cb84-76"><a href="#cb84-76" tabindex="-1"></a>  </span>
<span id="cb84-77"><a href="#cb84-77" tabindex="-1"></a>  <span class="co"># 计算Gelman-Rubin统计量</span></span>
<span id="cb84-78"><a href="#cb84-78" tabindex="-1"></a>  R_hat <span class="ot">&lt;-</span> <span class="fu">gelman_rubin</span>(chains)</span>
<span id="cb84-79"><a href="#cb84-79" tabindex="-1"></a>  </span>
<span id="cb84-80"><a href="#cb84-80" tabindex="-1"></a>  <span class="co"># 检查是否达到收敛条件</span></span>
<span id="cb84-81"><a href="#cb84-81" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(R_hat) <span class="sc">&amp;&amp;</span> R_hat <span class="sc">&lt;</span> target_R_hat) {</span>
<span id="cb84-82"><a href="#cb84-82" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb84-83"><a href="#cb84-83" tabindex="-1"></a>  }</span>
<span id="cb84-84"><a href="#cb84-84" tabindex="-1"></a>  </span>
<span id="cb84-85"><a href="#cb84-85" tabindex="-1"></a>  <span class="co"># 更新初始样本值</span></span>
<span id="cb84-86"><a href="#cb84-86" tabindex="-1"></a>  initial_value <span class="ot">&lt;-</span> samples[<span class="fu">length</span>(samples)]</span>
<span id="cb84-87"><a href="#cb84-87" tabindex="-1"></a>}</span>
<span id="cb84-88"><a href="#cb84-88" tabindex="-1"></a></span>
<span id="cb84-89"><a href="#cb84-89" tabindex="-1"></a><span class="co"># 打印最终的Gelman-Rubin统计量</span></span>
<span id="cb84-90"><a href="#cb84-90" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Final R_hat:&quot;</span>, R_hat))</span></code></pre></div>
<pre><code>## [1] &quot;Final R_hat: 1.00009443265889&quot;</code></pre>
</div>
<div id="hw8" class="section level2">
<h2>HW8</h2>
</div>
<div id="question-1-7" class="section level2">
<h2>Question 1</h2>
<p>设<span class="math inline">\(X_1,...,X_n
\stackrel{\text{i.i.d}}{\sim}Exp(\lambda)\)</span>,
因为某种原因，只知道<span class="math inline">\(X_i\)</span>落在某个区间<span class="math inline">\((u_i, v_i)\)</span>, 其中<span class="math inline">\(u_i &lt;
v_i\)</span>是两个非随机的已知常数。这种数据称为区间删失数据。</p>
<ul>
<li><p>试分别直接极大化观测数据的似然函数与采用EM算法求解<span class="math inline">\(\lambda\)</span>的MLE，证明EM算法收敛于观测数据的MLE,且收敛有线性速度。</p></li>
<li><p>设<span class="math inline">\((u_i, v_i),
i=1,...,n(n=10)\)</span>的观测值为(11, 12), (8, 9), (27, 28), (13, 14),
(16, 17), (0, 1), (23, 24), (10, 11), (24, 25), (2,
3)试分别编程实现上述两种算法以得到<span class="math inline">\(\lambda\)</span>的MLE的数值解。</p></li>
</ul>
<p>提示：观测数据的似然函数为<span class="math inline">\(L(\lambda) =
\prod_{i=1}^{n} P_\lambda(u_i \leq X_i \leq v_i)\)</span></p>
</div>
<div id="answer-1-7" class="section level2">
<h2>Answer 1</h2>
<ul>
<li>试分别直接极大化观测数据的似然函数与采用EM算法求解<span class="math inline">\(\lambda\)</span>的MLE，证明EM算法收敛于观测数据的MLE,且收敛有线性速度。</li>
</ul>
<p>易知观测数据的似然函数为 <span class="math display">\[
L(\lambda) = \prod_{i=1}^{n} P_\lambda(u_i \leq X_i \leq v_i)
\]</span> 由题目信息可知，对每个<span class="math inline">\(X_i\)</span>，我们有以下条件概率：</p>
<p><span class="math display">\[
P_\lambda(u_i \leq X_i \leq v_i) = P_\lambda(X_i \geq u_i) -
P_\lambda(X_i \geq v_i) = e^{-\lambda u_i} - e^{-\lambda v_i}
\]</span> 观测数据的似然函数为 <span class="math display">\[
L(\lambda) = \prod_{i=1}^{n} P_\lambda(u_i \leq X_i \leq
v_i)=\prod_{i=1}^{n} (e^{-\lambda u_i} - e^{-\lambda v_i})
\]</span> 为方便计算，对似然函数取对数：</p>
<p><span class="math display">\[
\log L(\lambda) = \sum_{i=1}^{n} \log(e^{-\lambda u_i} - e^{-\lambda
v_i})
\]</span></p>
<ol style="list-style-type: decimal">
<li>极大化观测数据的似然函数</li>
</ol>
<p>为了求解<span class="math inline">\(\lambda\)</span>的MLE，我们需要最大化观测数据的似然函数。取对数并对<span class="math inline">\(\lambda\)</span>求导，我们可以得到似然方程： <span class="math display">\[
\frac{\partial \log L(\lambda)}{\partial \lambda} = \sum_{i=1}^{n}
\left( \frac{v_i e^{-\lambda v_i} - u_i e^{-\lambda u_i}}{-e^{-\lambda
u_i} + e^{-\lambda v_i}} \right) = 0
\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li>采用EM算法</li>
</ol>
<p>观测数据的对数似然函数为 <span class="math display">\[
\log L(\lambda) = \sum_{i=1}^{n} \log(e^{-\lambda u_i} - e^{-\lambda
v_i})
\]</span></p>
<p>完全数据的对数似然函数为：</p>
<p><span class="math display">\[
\log L(\lambda) = \sum_{i=1}^{n} \log P(X_i, Z_i | \lambda)
\]</span></p>
<p>其中，<span class="math inline">\(X_i\)</span>表示观测数据;</p>
<p><span class="math inline">\(Z_i\)</span>表示对应的隐含变量，表示<span class="math inline">\(X_i\)</span>是否落在给定的区间<span class="math inline">\((u_i,v_i)\)</span>(如果<span class="math inline">\(X_i\)</span>落在区间内，则<span class="math inline">\(Z_i = 1\)</span>；否则，<span class="math inline">\(Z_i = 0\)</span>);</p>
<p><span class="math inline">\(\lambda\)</span>表示模型的参数。</p>
<p>E步（Expectation Step）：</p>
<p>计算隐变量<span class="math inline">\(Z_i\)</span>的期望<span class="math inline">\(\hat{Z}_i\)</span>，对于第<span class="math inline">\(i\)</span>个观测值<span class="math inline">\(X_i\)</span>，有： <span class="math display">\[
\hat{Z}_i = P(Z_i = 1 | X_i, \lambda^{(t)}) = \frac{P(u_i &lt; X_i &lt;
v_i | \lambda^{(t)})}{P(X_i &gt; u_i | \lambda^{(t)}) - P(X_i &gt; v_i |
\lambda^{(t)})}
\]</span></p>
<p>其中，<span class="math inline">\(\lambda^{(t)}\)</span>表示当前迭代的<span class="math inline">\(\lambda\)</span>值。</p>
<p>M步（Maximization Step）：</p>
<p>使用观测数据和隐变量的期望，更新参数<span class="math inline">\(\lambda\)</span>。具体地，最大化完全数据的对数似然函数：
<span class="math display">\[
\lambda^{(t+1)} = \arg\max_\lambda \sum_{i=1}^{n} \left( \hat{Z}_i \log
f(X_i;\lambda) \right)
\]</span></p>
<p>其中，<span class="math inline">\(f(x;\lambda)\)</span>是指数分布的概率密度函数。</p>
<p>重复E步、M步直至<span class="math inline">\(\lambda\)</span>收敛，停止迭代</p>
<ol start="3" style="list-style-type: decimal">
<li>证明EM算法收敛于观测数据的MLE且具有线性速度：</li>
</ol>
<p>要证明 EM 算法收敛，需要满足下面两个条件： -
完全数据对数似然函数的期望（对应E步）是凸函数。 -
在M步中，我们可以找到最大化完全数据对数似然函数的期望的参数值。</p>
<p>完全数据的对数似然函数可以表示为： <span class="math display">\[
\log L_c(\lambda) = \sum_{i=1}^{n} \log f(X_i;\lambda) = \sum_{i=1}^{n}
\left( \hat{Z}_i \log f(X_i;\lambda) \right)
\]</span> 其中，<span class="math inline">\(\hat{Z}_i\)</span>是在E步中计算得到的隐变量<span class="math inline">\(Z_i\)</span>的期望。</p>
<p>利用Jensen不等式，我们知道对于凸函数，有 <span class="math display">\[\mathbb{E}[g(X)] \geq
g(\mathbb{E}[X])\]</span></p>
<p>由于函数<span class="math inline">\(g(x) = \log
x\)</span>是凸函数，我们可以得到：</p>
<p><span class="math display">\[
\sum_{i=1}^{n} \left( \hat{Z}i \log f(X_i;\lambda) \right) \geq \log
\left( \sum{i=1}^{n} \left( \hat{Z}_i f(X_i;\lambda) \right) \right)
\]</span></p>
<p>换句话说，完全数据的对数似然函数的值在每次迭代中单调递增。由于完全数据的对数似然函数是有上界的，因此EM算法收敛。</p>
<p>此外，根据EM算法的性质，每次迭代都增加了完全数据的对数似然函数的值，因此EM算法具有线性收敛速度。</p>
<p>综上，EM算法收敛于MLE且具有线性收敛速度。</p>
<ul>
<li>设<span class="math inline">\((u_i, v_i),
i=1,...,n(n=10)\)</span>的观测值为(11, 12), (8, 9), (27, 28), (13, 14),
(16, 17), (0, 1), (23, 24), (10, 11), (24, 25), (2,
3)试分别编程实现上述两种算法以得到<span class="math inline">\(\lambda\)</span>的MLE的数值解。</li>
</ul>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="co"># 观测数据</span></span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">12</span>,</span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a>                 <span class="dv">8</span>, <span class="dv">9</span>,</span>
<span id="cb86-4"><a href="#cb86-4" tabindex="-1"></a>                 <span class="dv">27</span>, <span class="dv">28</span>,</span>
<span id="cb86-5"><a href="#cb86-5" tabindex="-1"></a>                 <span class="dv">13</span>, <span class="dv">14</span>,</span>
<span id="cb86-6"><a href="#cb86-6" tabindex="-1"></a>                 <span class="dv">16</span>, <span class="dv">17</span>,</span>
<span id="cb86-7"><a href="#cb86-7" tabindex="-1"></a>                 <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb86-8"><a href="#cb86-8" tabindex="-1"></a>                 <span class="dv">23</span>, <span class="dv">24</span>,</span>
<span id="cb86-9"><a href="#cb86-9" tabindex="-1"></a>                 <span class="dv">10</span>, <span class="dv">11</span>,</span>
<span id="cb86-10"><a href="#cb86-10" tabindex="-1"></a>                 <span class="dv">24</span>, <span class="dv">25</span>,</span>
<span id="cb86-11"><a href="#cb86-11" tabindex="-1"></a>                 <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-12"><a href="#cb86-12" tabindex="-1"></a></span>
<span id="cb86-13"><a href="#cb86-13" tabindex="-1"></a><span class="co"># 极大化观测数据的似然函数</span></span>
<span id="cb86-14"><a href="#cb86-14" tabindex="-1"></a>mlogL <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda) {</span>
<span id="cb86-15"><a href="#cb86-15" tabindex="-1"></a>  u <span class="ot">&lt;-</span> data[, <span class="dv">1</span>]</span>
<span id="cb86-16"><a href="#cb86-16" tabindex="-1"></a>  v <span class="ot">&lt;-</span> data[, <span class="dv">2</span>]</span>
<span id="cb86-17"><a href="#cb86-17" tabindex="-1"></a>  </span>
<span id="cb86-18"><a href="#cb86-18" tabindex="-1"></a>  <span class="co"># 计算似然函数的对数值</span></span>
<span id="cb86-19"><a href="#cb86-19" tabindex="-1"></a>  log_likelihood <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> u) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> v)))</span>
<span id="cb86-20"><a href="#cb86-20" tabindex="-1"></a>  </span>
<span id="cb86-21"><a href="#cb86-21" tabindex="-1"></a>  <span class="fu">return</span>(<span class="sc">-</span>log_likelihood) <span class="co"># 使用负对数似然函数进行最小化</span></span>
<span id="cb86-22"><a href="#cb86-22" tabindex="-1"></a>}</span>
<span id="cb86-23"><a href="#cb86-23" tabindex="-1"></a></span>
<span id="cb86-24"><a href="#cb86-24" tabindex="-1"></a><span class="co"># 使用optim函数进行最大化</span></span>
<span id="cb86-25"><a href="#cb86-25" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="at">par =</span> <span class="dv">1</span>, <span class="at">fn =</span> mlogL, <span class="at">method =</span> <span class="st">&quot;Brent&quot;</span>, <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="dv">10</span>)</span>
<span id="cb86-26"><a href="#cb86-26" tabindex="-1"></a></span>
<span id="cb86-27"><a href="#cb86-27" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb86-28"><a href="#cb86-28" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;直接极大似然估计结果：&quot;</span>, fit<span class="sc">$</span>par, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 直接极大似然估计结果： 0.0719735</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a><span class="co"># EM算法求解MLE</span></span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a>em_algorithm <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">max_iter =</span> <span class="dv">10000</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>) {</span>
<span id="cb88-3"><a href="#cb88-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data)</span>
<span id="cb88-4"><a href="#cb88-4" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb88-5"><a href="#cb88-5" tabindex="-1"></a>  </span>
<span id="cb88-6"><a href="#cb88-6" tabindex="-1"></a>  <span class="cf">for</span> (iter <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb88-7"><a href="#cb88-7" tabindex="-1"></a>    lambda_prev <span class="ot">&lt;-</span> lambda</span>
<span id="cb88-8"><a href="#cb88-8" tabindex="-1"></a>    </span>
<span id="cb88-9"><a href="#cb88-9" tabindex="-1"></a>    <span class="co"># E步</span></span>
<span id="cb88-10"><a href="#cb88-10" tabindex="-1"></a>    z <span class="ot">&lt;-</span> (<span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> data[, <span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> data[, <span class="dv">2</span>])) <span class="sc">/</span> (<span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> data[, <span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> data[, <span class="dv">2</span>]))</span>
<span id="cb88-11"><a href="#cb88-11" tabindex="-1"></a>    </span>
<span id="cb88-12"><a href="#cb88-12" tabindex="-1"></a>    <span class="co"># M步</span></span>
<span id="cb88-13"><a href="#cb88-13" tabindex="-1"></a>    lambda <span class="ot">&lt;-</span> <span class="fu">optimize</span>(<span class="at">f =</span> <span class="cf">function</span>(x) {</span>
<span id="cb88-14"><a href="#cb88-14" tabindex="-1"></a>      <span class="fu">sum</span>(z <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">/</span> x) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> z) <span class="sc">*</span> <span class="fu">log</span>(<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>x <span class="sc">*</span> data[, <span class="dv">2</span>]) <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>x <span class="sc">*</span> data[, <span class="dv">1</span>])))</span>
<span id="cb88-15"><a href="#cb88-15" tabindex="-1"></a>    }, <span class="at">interval =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">maximum =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>minimum</span>
<span id="cb88-16"><a href="#cb88-16" tabindex="-1"></a>    </span>
<span id="cb88-17"><a href="#cb88-17" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(lambda <span class="sc">-</span> lambda_prev) <span class="sc">&lt;</span> tol) {</span>
<span id="cb88-18"><a href="#cb88-18" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb88-19"><a href="#cb88-19" tabindex="-1"></a>    }</span>
<span id="cb88-20"><a href="#cb88-20" tabindex="-1"></a>  }</span>
<span id="cb88-21"><a href="#cb88-21" tabindex="-1"></a>  </span>
<span id="cb88-22"><a href="#cb88-22" tabindex="-1"></a>  <span class="fu">return</span>(lambda)</span>
<span id="cb88-23"><a href="#cb88-23" tabindex="-1"></a>}</span>
<span id="cb88-24"><a href="#cb88-24" tabindex="-1"></a></span>
<span id="cb88-25"><a href="#cb88-25" tabindex="-1"></a><span class="co"># 使用EM算法求解</span></span>
<span id="cb88-26"><a href="#cb88-26" tabindex="-1"></a>result_em <span class="ot">&lt;-</span> <span class="fu">em_algorithm</span>(data)</span>
<span id="cb88-27"><a href="#cb88-27" tabindex="-1"></a></span>
<span id="cb88-28"><a href="#cb88-28" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb88-29"><a href="#cb88-29" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;EM算法估计结果：&quot;</span>, result_em, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## EM算法估计结果： 9.999944</code></pre>
</div>
<div id="question-2-7" class="section level2">
<h2>Question 2</h2>
<p>11.8</p>
<p>In the Morra game, the set of optimal strategies are not changed if a
constant is subtracted from every entry of the payoﬀ matrix, or a
positive constant is multiplied times every entry of the payoﬀ matrix.
However, the simplex algorithm may terminate at a diﬀerent basic
feasible point (also optimal). Compute B &lt;- A + 2, ﬁnd the solution
of game B, and verify that it is one of the extreme points
(11.12)–(11.15) of the original game A. Also ﬁnd the value of game A and
game B.</p>
<p>在Morra游戏中，如果从支付矩阵的每个条目中减去一个常数，或者将一个正常数乘以收益矩阵的每个条目，则最优策略集不会改变。然而，单纯形算法可能终止于不同的基本可行点(也是最优的)。计算B&lt;-A+2，求出对策B的解，并验证它是原对策A的极值点之一(11.12)-(11.15)，并求出对策A和对策B的值。</p>
</div>
<div id="answer-2-7" class="section level2">
<h2>Answer 2</h2>
<p>R语言代码如下：</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a><span class="co"># 创建支付矩阵A</span></span>
<span id="cb90-3"><a href="#cb90-3" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>( <span class="dv">0</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb90-4"><a href="#cb90-4" tabindex="-1"></a>               <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb90-5"><a href="#cb90-5" tabindex="-1"></a>               <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,</span>
<span id="cb90-6"><a href="#cb90-6" tabindex="-1"></a>               <span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb90-7"><a href="#cb90-7" tabindex="-1"></a>               <span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb90-8"><a href="#cb90-8" tabindex="-1"></a>               <span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb90-9"><a href="#cb90-9" tabindex="-1"></a>               <span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb90-10"><a href="#cb90-10" tabindex="-1"></a>               <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb90-11"><a href="#cb90-11" tabindex="-1"></a>               <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="dv">0</span>), <span class="dv">9</span>, <span class="dv">9</span>)</span>
<span id="cb90-12"><a href="#cb90-12" tabindex="-1"></a>B <span class="ot">&lt;-</span> A <span class="sc">+</span> <span class="dv">2</span></span>
<span id="cb90-13"><a href="#cb90-13" tabindex="-1"></a></span>
<span id="cb90-14"><a href="#cb90-14" tabindex="-1"></a>solve.game <span class="ot">&lt;-</span> <span class="cf">function</span>(A){</span>
<span id="cb90-15"><a href="#cb90-15" tabindex="-1"></a>  <span class="co"># 使用单纯形法解决两个玩家的零和博弈</span></span>
<span id="cb90-16"><a href="#cb90-16" tabindex="-1"></a>  <span class="co"># 先优化玩家1，在优化玩家2</span></span>
<span id="cb90-17"><a href="#cb90-17" tabindex="-1"></a>  <span class="co"># 最大化v，服从...</span></span>
<span id="cb90-18"><a href="#cb90-18" tabindex="-1"></a>  </span>
<span id="cb90-19"><a href="#cb90-19" tabindex="-1"></a>  <span class="co"># 预处理 </span></span>
<span id="cb90-20"><a href="#cb90-20" tabindex="-1"></a>  min.A <span class="ot">&lt;-</span> <span class="fu">min</span>(A)</span>
<span id="cb90-21"><a href="#cb90-21" tabindex="-1"></a>  A <span class="ot">&lt;-</span> A <span class="sc">-</span> min.A <span class="co"># v &gt;= 0</span></span>
<span id="cb90-22"><a href="#cb90-22" tabindex="-1"></a>  max.A <span class="ot">&lt;-</span> <span class="fu">max</span>(A)</span>
<span id="cb90-23"><a href="#cb90-23" tabindex="-1"></a>  A <span class="ot">&lt;-</span> A <span class="sc">/</span> <span class="fu">max</span>(A)</span>
<span id="cb90-24"><a href="#cb90-24" tabindex="-1"></a>  </span>
<span id="cb90-25"><a href="#cb90-25" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb90-26"><a href="#cb90-26" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(A)</span>
<span id="cb90-27"><a href="#cb90-27" tabindex="-1"></a>  it <span class="ot">&lt;-</span> n<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb90-28"><a href="#cb90-28" tabindex="-1"></a>  </span>
<span id="cb90-29"><a href="#cb90-29" tabindex="-1"></a>  <span class="co"># 玩家1的优化</span></span>
<span id="cb90-30"><a href="#cb90-30" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, m), <span class="dv">1</span>)  <span class="co"># 目标函数</span></span>
<span id="cb90-31"><a href="#cb90-31" tabindex="-1"></a>  A1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">cbind</span>(<span class="fu">t</span>(A), <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, n)) <span class="co"># &lt;=约束</span></span>
<span id="cb90-32"><a href="#cb90-32" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n) <span class="co"># 约束条件右侧常数</span></span>
<span id="cb90-33"><a href="#cb90-33" tabindex="-1"></a>  A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, m), <span class="dv">0</span>))) <span class="co"># 等式约束 sum(x) = 1</span></span>
<span id="cb90-34"><a href="#cb90-34" tabindex="-1"></a>  b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb90-35"><a href="#cb90-35" tabindex="-1"></a>  sx <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>a, <span class="at">A1=</span>A1, <span class="at">b1=</span>b1, <span class="at">A3=</span>A3, <span class="at">b3=</span>b3, <span class="at">maxi=</span><span class="cn">TRUE</span>, <span class="at">n.iter=</span>it)</span>
<span id="cb90-36"><a href="#cb90-36" tabindex="-1"></a>  </span>
<span id="cb90-37"><a href="#cb90-37" tabindex="-1"></a>  <span class="co"># 玩家2的优化</span></span>
<span id="cb90-38"><a href="#cb90-38" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n), <span class="dv">1</span>)  <span class="co"># 目标函数</span></span>
<span id="cb90-39"><a href="#cb90-39" tabindex="-1"></a>  A1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(A, <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, m))  <span class="co"># &lt;= 约束</span></span>
<span id="cb90-40"><a href="#cb90-40" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)  <span class="co"># 约束条件右侧常数</span></span>
<span id="cb90-41"><a href="#cb90-41" tabindex="-1"></a>  A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n), <span class="dv">0</span>)))  <span class="co"># 等式约束 sum(y) = 1</span></span>
<span id="cb90-42"><a href="#cb90-42" tabindex="-1"></a>  b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb90-43"><a href="#cb90-43" tabindex="-1"></a>  sy <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a =</span> a, <span class="at">A1 =</span> A1, <span class="at">b1 =</span> b1, <span class="at">A3 =</span> A3, <span class="at">b3 =</span> b3, <span class="at">maxi =</span> <span class="cn">FALSE</span>, <span class="at">n.iter =</span> it)</span>
<span id="cb90-44"><a href="#cb90-44" tabindex="-1"></a>  </span>
<span id="cb90-45"><a href="#cb90-45" tabindex="-1"></a>  <span class="co"># 构造结果</span></span>
<span id="cb90-46"><a href="#cb90-46" tabindex="-1"></a>  soln <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb90-47"><a href="#cb90-47" tabindex="-1"></a>    <span class="st">&quot;A&quot;</span> <span class="ot">=</span> A <span class="sc">*</span> max.A <span class="sc">+</span> min.A,  <span class="co"># 恢复原始范围的支付矩阵A</span></span>
<span id="cb90-48"><a href="#cb90-48" tabindex="-1"></a>    <span class="st">&quot;x&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>m],  <span class="co"># 玩家1的策略向量x</span></span>
<span id="cb90-49"><a href="#cb90-49" tabindex="-1"></a>    <span class="st">&quot;y&quot;</span> <span class="ot">=</span> sy<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>n],  <span class="co"># 玩家2的策略向量y</span></span>
<span id="cb90-50"><a href="#cb90-50" tabindex="-1"></a>    <span class="st">&quot;v&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[m <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">*</span> max.A <span class="sc">+</span> min.A,  <span class="co"># 博弈的值v</span></span>
<span id="cb90-51"><a href="#cb90-51" tabindex="-1"></a>    <span class="st">&quot;optimal_point&quot;</span> <span class="ot">=</span> <span class="fu">cbind</span>(sx<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>m], sy<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>n])  <span class="co"># 极值点</span></span>
<span id="cb90-52"><a href="#cb90-52" tabindex="-1"></a>  )</span>
<span id="cb90-53"><a href="#cb90-53" tabindex="-1"></a>  </span>
<span id="cb90-54"><a href="#cb90-54" tabindex="-1"></a>  <span class="fu">return</span>(soln)</span>
<span id="cb90-55"><a href="#cb90-55" tabindex="-1"></a>}</span>
<span id="cb90-56"><a href="#cb90-56" tabindex="-1"></a></span>
<span id="cb90-57"><a href="#cb90-57" tabindex="-1"></a>soln_A <span class="ot">&lt;-</span> <span class="fu">solve.game</span>(A)</span>
<span id="cb90-58"><a href="#cb90-58" tabindex="-1"></a>soln_B <span class="ot">&lt;-</span> <span class="fu">solve.game</span>(B)</span>
<span id="cb90-59"><a href="#cb90-59" tabindex="-1"></a><span class="fu">round</span>(soln_A<span class="sc">$</span>optimal_point, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>##         [,1]      [,2]
## x1 0.0000000 0.0000000
## x2 0.0000000 0.0000000
## x3 0.4098361 0.4098361
## x4 0.0000000 0.0000000
## x5 0.3278689 0.3278689
## x6 0.0000000 0.0000000
## x7 0.2622951 0.2622951
## x8 0.0000000 0.0000000
## x9 0.0000000 0.0000000</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a><span class="fu">round</span>(soln_A<span class="sc">$</span>v, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>## x10 
##   0</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a><span class="fu">round</span>(soln_B<span class="sc">$</span>optimal_point, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>##         [,1]      [,2]
## x1 0.0000000 0.0000000
## x2 0.0000000 0.0000000
## x3 0.4098361 0.4098361
## x4 0.0000000 0.0000000
## x5 0.3278689 0.3278689
## x6 0.0000000 0.0000000
## x7 0.2622951 0.2622951
## x8 0.0000000 0.0000000
## x9 0.0000000 0.0000000</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a><span class="fu">round</span>(soln_B<span class="sc">$</span>v, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>## x10 
##   2</code></pre>
</div>
<div id="hw-9" class="section level2">
<h2>HW 9</h2>
</div>
<div id="question-1-8" class="section level2">
<h2>Question 1</h2>
<p>2.1.3 Exercise 4</p>
<ol start="4" style="list-style-type: decimal">
<li><p>Why do you need to use unlist() to convert a list to an atomic
vector? Why doesn’t as.vector() work?</p>
<p>为什么需要使用unlist()将列表(lists)转换为原子向量(atom
vector)而as.vector()不起作用？</p></li>
</ol>
</div>
<div id="answer-1-8" class="section level2">
<h2>Answer 1</h2>
<p>’as.vector()’无法处理列表内的递归结构，而’unlist()’可以做到这一点；’as.vector()’函数将列表转换为向量时，它会将列表视为一个整体，并且尝试将其转换为一个原子向量，而’unlist()’会递归地遍历列表中的元素，并将它们展开成一个原子向量。</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a>list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="fu">list</span>(<span class="dv">3</span>, <span class="dv">4</span>))</span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a><span class="fu">as.vector</span>(list)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1
## 
## [[2]]
## [1] 2
## 
## [[3]]
## [[3]][[1]]
## [1] 3
## 
## [[3]][[2]]
## [1] 4</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a><span class="fu">unlist</span>(list)</span></code></pre></div>
<pre><code>## [1] 1 2 3 4</code></pre>
</div>
<div id="question-2-8" class="section level2">
<h2>Question 2</h2>
<p>2.3.1 Exercises</p>
<ol style="list-style-type: decimal">
<li><p>‘What does dim() return when applied to a vector?’</p>
<p>当dim()应用到一个向量上会返回什么？</p></li>
<li><p>If is.matrix(x) is TRUE, what will is.array(x) return?</p>
<p>如果’is.matrix(x)’为真，’is.array(x)’会返回什么？</p></li>
</ol>
</div>
<div id="answer-2-8" class="section level2">
<h2>Answer 2</h2>
<ol style="list-style-type: decimal">
<li>当dim()应用到一个向量上会返回’NULL’.</li>
</ol>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span></code></pre></div>
<pre><code>## NULL</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>如果’is.matrix(x)‘为真，则’is.array(x)’也会返回’Ture’. 在 R
语言中，矩阵是一种特殊的数组，具有二维结构，其中每个元素都具有相同的数据类型。因此，
is.matrix(x) 返回真时， is.array(x) 也会返回真。 示例</li>
</ol>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a><span class="co"># 创建一个矩阵</span></span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a>mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb104-3"><a href="#cb104-3" tabindex="-1"></a><span class="fu">print</span>(mat)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a><span class="co"># 检查是否为矩阵</span></span>
<span id="cb106-2"><a href="#cb106-2" tabindex="-1"></a>is_mat <span class="ot">&lt;-</span> <span class="fu">is.matrix</span>(mat)</span>
<span id="cb106-3"><a href="#cb106-3" tabindex="-1"></a><span class="fu">print</span>(is_mat)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="co"># 检查是否为数组</span></span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a>is_arr <span class="ot">&lt;-</span> <span class="fu">is.array</span>(mat)</span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a><span class="fu">print</span>(is_arr)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="question-3-7" class="section level2">
<h2>Question 3</h2>
<p>2.4.5 Exercise 2, 3</p>
<ol start="2" style="list-style-type: decimal">
<li><p>What does as.matrix() do when applied to a data frame with
columns of diﬀerent types?</p>
<p>当’as.matrix()’应用到于一个包含不同类型列的数据框（data
frame）时会对数据框进行什么操作？</p></li>
<li><p>Can you have a data frame with 0 rows? What about 0 columns?</p>
<p>可以创建一个只有0行或0列的数据框吗？</p></li>
</ol>
</div>
<div id="answer-3-7" class="section level2">
<h2>Answer 3</h2>
<ol start="2" style="list-style-type: decimal">
<li><p>当as.matrix()函数应用于一个数据框，其中包含不同类型的列时，它会尝试进行类型转换以生成一个矩阵，具体的转换规则取决于列的类型。</p></li>
<li><p>在R语言中可以创建具有0行或0列的数据框。</p></li>
</ol>
<p>创建0行数据框</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a>frame1 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">col1=</span><span class="fu">character</span>(<span class="dv">0</span>),<span class="at">col2=</span><span class="fu">numeric</span>(<span class="dv">0</span>),<span class="at">col3=</span><span class="fu">logical</span>(<span class="dv">0</span>))</span>
<span id="cb110-2"><a href="#cb110-2" tabindex="-1"></a><span class="fu">str</span>(frame1)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    0 obs. of  3 variables:
##  $ col1: chr 
##  $ col2: num 
##  $ col3: logi</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a>frame1</span></code></pre></div>
<pre><code>## [1] col1 col2 col3
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<p>创建0列数据框</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a>frame2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">0</span>))</span>
<span id="cb114-2"><a href="#cb114-2" tabindex="-1"></a><span class="fu">str</span>(frame2)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    3 obs. of  0 variables</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a>frame2</span></code></pre></div>
<pre><code>## data frame with 0 columns and 3 rows</code></pre>
</div>
<div id="question-4-4" class="section level2">
<h2>Question 4</h2>
<p>Exercises 2</p>
<p>The function below scales a vector so it falls in the range [0, 1].
How would you apply it to every column of a data frame? How would you
apply it to every numeric column in a data frame?</p>
<p>下面的函数对向量进行缩放，使其落在范围[0，1]内。如何将其应用于数据框的每一列？如何将其应用于数据框中的每个数值列？</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb118-2"><a href="#cb118-2" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span>
<span id="cb118-3"><a href="#cb118-3" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb118-4"><a href="#cb118-4" tabindex="-1"></a>  }</span></code></pre></div>
</div>
<div id="answer-4-4" class="section level2">
<h2>Answer 4</h2>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a><span class="co"># 定义函数</span></span>
<span id="cb119-2"><a href="#cb119-2" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb119-3"><a href="#cb119-3" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb119-4"><a href="#cb119-4" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb119-5"><a href="#cb119-5" tabindex="-1"></a>}</span>
<span id="cb119-6"><a href="#cb119-6" tabindex="-1"></a></span>
<span id="cb119-7"><a href="#cb119-7" tabindex="-1"></a><span class="co"># 创建一个示例数据框</span></span>
<span id="cb119-8"><a href="#cb119-8" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb119-9"><a href="#cb119-9" tabindex="-1"></a>  <span class="at">A =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb119-10"><a href="#cb119-10" tabindex="-1"></a>  <span class="at">B =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>),</span>
<span id="cb119-11"><a href="#cb119-11" tabindex="-1"></a>  <span class="at">C =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>)</span>
<span id="cb119-12"><a href="#cb119-12" tabindex="-1"></a>)</span>
<span id="cb119-13"><a href="#cb119-13" tabindex="-1"></a></span>
<span id="cb119-14"><a href="#cb119-14" tabindex="-1"></a><span class="co"># 对数据框的每一列应用scale01函数</span></span>
<span id="cb119-15"><a href="#cb119-15" tabindex="-1"></a>scaled_df1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df, scale01)</span>
<span id="cb119-16"><a href="#cb119-16" tabindex="-1"></a></span>
<span id="cb119-17"><a href="#cb119-17" tabindex="-1"></a><span class="co"># 仅对数值列应用scale01函数</span></span>
<span id="cb119-18"><a href="#cb119-18" tabindex="-1"></a>numeric_cols <span class="ot">&lt;-</span> df[<span class="fu">sapply</span>(df, is.numeric)]  <span class="co"># 选择只包含数值的列</span></span>
<span id="cb119-19"><a href="#cb119-19" tabindex="-1"></a>scaled_df2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(numeric_cols, scale01)  <span class="co"># 对数值列应用函数</span></span>
<span id="cb119-20"><a href="#cb119-20" tabindex="-1"></a></span>
<span id="cb119-21"><a href="#cb119-21" tabindex="-1"></a>scaled_df1</span></code></pre></div>
<pre><code>## $A
## [1] 0.0 0.5 1.0
## 
## $B
## [1] 0.0 0.5 1.0
## 
## $C
## [1] 0.0 0.5 1.0</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a>scaled_df2</span></code></pre></div>
<pre><code>## $A
## [1] 0.0 0.5 1.0
## 
## $B
## [1] 0.0 0.5 1.0
## 
## $C
## [1] 0.0 0.5 1.0</code></pre>
</div>
<div id="question-5-2" class="section level2">
<h2>Question 5</h2>
<p>Exercises 1</p>
<ol style="list-style-type: decimal">
<li><p>Use vapply() to:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Compute the standard deviation of every column in a numeric data
frame.</p></li>
<li><p>Compute the standard deviation of every numeric column in a mixed
data frame. (Hint: you’ll need to use vapply() twice.)</p></li>
</ol>
<p>使用’vapply()’:</p>
<ol style="list-style-type: lower-alpha">
<li><p>计算数值数据框中每一列的标准差</p></li>
<li><p>计算混合数据框中每个数值列的标准差。（提示：您需要使用vApply()两次。）</p></li>
</ol></li>
</ol>
</div>
<div id="answer-5-2" class="section level2">
<h2>Answer 5</h2>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a><span class="co"># 计算数值数据框中每一列的标准差</span></span>
<span id="cb123-2"><a href="#cb123-2" tabindex="-1"></a>numeric_iris <span class="ot">&lt;-</span> iris[<span class="sc">-</span><span class="dv">5</span>]</span>
<span id="cb123-3"><a href="#cb123-3" tabindex="-1"></a><span class="fu">vapply</span>(numeric_iris, sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##    0.8280661    0.4358663    1.7652982    0.7622377</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" tabindex="-1"></a><span class="co"># 计算混合数据框中每个数值列的标准差</span></span>
<span id="cb125-2"><a href="#cb125-2" tabindex="-1"></a>df_sd <span class="ot">&lt;-</span> <span class="cf">function</span>(df) <span class="fu">vapply</span>(df[<span class="fu">vapply</span>(df, is.numeric, <span class="fu">logical</span>(<span class="dv">1</span>))], sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span>
<span id="cb125-3"><a href="#cb125-3" tabindex="-1"></a><span class="fu">df_sd</span>(iris)</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##    0.8280661    0.4358663    1.7652982    0.7622377</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" tabindex="-1"></a><span class="fu">df_sd</span>(mtcars)</span></code></pre></div>
<pre><code>##         mpg         cyl        disp          hp        drat          wt 
##   6.0269481   1.7859216 123.9386938  68.5628685   0.5346787   0.9784574 
##        qsec          vs          am        gear        carb 
##   1.7869432   0.5040161   0.4989909   0.7378041   1.6152000</code></pre>
</div>
<div id="question-6-1" class="section level2">
<h2>Question 6</h2>
<p>This example appears in [40]. Consider the bivariate density <span class="math display">\[
f(x, y) \propto\left(\begin{array}{l}n \\x\end{array}\right)
y^{x+a-1}(1-y)^{n-x+b-1}, \quad x=0,1, \ldots, n, 0 \leq y \leq 1
\]</span> It can be shown (see e.g. [23]) that for ﬁxed a, b, n, the
conditional distributions are Binomial(n, y) and Beta(x + a, n − x + b).
Use the Gibbs sampler to generate a chain with target joint density
f(x,y).</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer 6</h2>
<div id="r-function" class="section level3">
<h3>R function</h3>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" tabindex="-1"></a>GibbsR <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b,n,N){</span>
<span id="cb129-2"><a href="#cb129-2" tabindex="-1"></a>  X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb129-3"><a href="#cb129-3" tabindex="-1"></a>  X[<span class="dv">1</span>,] <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>)</span>
<span id="cb129-4"><a href="#cb129-4" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb129-5"><a href="#cb129-5" tabindex="-1"></a>    y <span class="ot">=</span> X[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb129-6"><a href="#cb129-6" tabindex="-1"></a>    X[i,<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,y)</span>
<span id="cb129-7"><a href="#cb129-7" tabindex="-1"></a>    x <span class="ot">=</span> X[i,<span class="dv">1</span>]</span>
<span id="cb129-8"><a href="#cb129-8" tabindex="-1"></a>    X[i,<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb129-9"><a href="#cb129-9" tabindex="-1"></a>  }</span>
<span id="cb129-10"><a href="#cb129-10" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb129-11"><a href="#cb129-11" tabindex="-1"></a>}</span>
<span id="cb129-12"><a href="#cb129-12" tabindex="-1"></a></span>
<span id="cb129-13"><a href="#cb129-13" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb129-14"><a href="#cb129-14" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb129-15"><a href="#cb129-15" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">60</span></span>
<span id="cb129-16"><a href="#cb129-16" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb129-17"><a href="#cb129-17" tabindex="-1"></a></span>
<span id="cb129-18"><a href="#cb129-18" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">GibbsR</span>(a,b,n,N)</span>
<span id="cb129-19"><a href="#cb129-19" tabindex="-1"></a><span class="fu">plot</span>(X[,<span class="dv">1</span>],X[,<span class="dv">2</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAYFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6ZrY6kNtmAABmZjpmZrZmkJBmtv+QOgCQ2/+2ZgC2Zjq2Zma2///bkDrb2//b/7bb////tmb/25D//7b//9v///8n0lnmAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKrUlEQVR4nO2dC3ecNhCF1cbuy24bd9tsm12b//8vCwI9V3A1QgJ2fe9JbMcRaPSd0YxeLKqjFqX2NuDoIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICkgH6eFNaP35rZM7xJAJ0Vi/jDxfzw+NLAujjzWI5f/newJgjSgLo/fWr+fHyaToZPQhIGIMmF2IMmtH765jFPo3/cBwERUBAsiw2RJ4LB4pz0oB0/vISfnS7u1ErQBOauTSvJkqCu+6jZoCuzxrQ3EBReX8PrR09SInvu6km924EaOi8T50J10GttmsfG5DYxYUN6Rn98NfCQProgKxxrQDl3O7IMegQgHbKYlm1bgbovJDF9pH22ySj4LdmDLSrB+2hsdHqxgAPx5hCPjGgqfnRr5WJiaOLeYWzb1xTewOyDLzfDtCMa7UGBHc19oxBxle8RDECU+MXZ18zQHhXY8f0rruXUrZLOY/yATUdKGasSe87/nFh2EwnlO1illnTqQbc1dgbkOVjPcXxCNN99j0F9d+DB5keFU56VBePkVrFILSrsT0gr+GWi5+3TMeLjGuUxeCuxuaAXMON89jvt3a17mLb3w7X59KSyWLJRdW9AcmXeuvIBRu3HJW0ZW9ArW4HKjP+o2wCM53MhOqp2GYxaOvbgbqmfGVzVOBDe2SxzW8HqjIxufODT+d+cBbd2PU5ADk+iRjUeUPm2+D4+IA8X+nC7BVGaY9jkaF3B8i1W5nJacjEErO9S5lIVWLovQFy03QXk9P+Y43xXKnA0HsBFLTSLV7cUIlc6eZSsaF3Akh5f02C92JQyCgct36KLmZztfOcLuhcKUZTie4zBGmXq22zlTLDxFQ/izrjDZ9HBOT3nU7N53bfo1y0Kjb0PgDFUSeV4G8J2clswqxHAxSu9ig150Fd7F1dqn9JDK3TIs/CVlJ29hX2tkXNN++xPEglog4k5IXqNYZKWpRxyrUJIJfS8/zG8lswpx0gcMpVcLtc2WmFQN7u2EpDx4JmMX7SjIPknnKtLDsczqQSbBUu3TS79tgj5nYFM0+5VpL1AWWmC0IvWrSlGaDNPMi1UsolC1GjGDRUmjrlWnS7RQW9pQhN6jhVgaGm4Lm/6egbi89hZJxyrSNvC7mIT7D7vMbQqeC5b/b76+Acy4Ayb7detn1CLNN37wYrDR0LjscSPt76yHIUQGYkE7U9n9XMJExqaBikT1++Y0D9SLH3t5X1QrvWa9GcIg/qdXpaBHRS6uX66/fWA8UCj7lxoJvzC4WGmhg0YemD8AKg3sG6k/aepmneLgJmT0pThHAd2cYMMkd/Pt7mAWm/uf40AGo5ULT7pbIg7VZDvD2fhUqyrcnXOPr5+Ldr60GmwSsCURev0ZcbKmqRjU9Lj0OtllluXxuGlivJtkZk+3lMXxc1E6NXe5DnPCuij9qpi7W/nbIZTI7HjJvmlukLDT0UIDdv91ef891GufiODGkNqM3jUMrrWmI3ilZkcVXZNoU6L4yTC24nvTp2ojJVNPRQXcwtjK2g0+EcLzH0WIBE2xYBFReF8sxosqK4yeNQRc5jHa9LHXVZZagI0CaPQ0mcpwt/7LxRJqol2xz9NW9XY6OHWQo8KIaaUUm2NQLLN3ocKtXiDDyy+c4KQP/MzuY38KAy74lOCmVVlG2R/vr+h/n39XlhPaj541DFM9Rg/JRZU7ZJ3dB5psHhafnDpZo9DqXcFqEwj/kHgcxuT06F2ZaN3/r8/TS4j971KmqfwL3TVkSno6QeZOa5OSmsK4lBF/XD72smGcJ6E1etWuAQhqCSID060UqtAHSTinLcxnyzd8r1YTmg8+BBqz/dbiWgAh+yi4+NDJ0K9tH3SX9d+RGka2KQMtvFIj7mKmHVjbJYvXrj6yL/yZ9suLwlqrvNOKhivfFlJf3L34qX1t1kJF2z3viqYPyTA6tzu6fZaxwlhh5iPShGkxwRJZjZ1Y3mMaiaim63CCHVp1S4utGBffhVhh4AUNkSWSdaQCw3dH9AicSe6k3pfxckeKGhxwAULgJ1NyjiNSIv6ihp5xIaegxALictxiGTt4oSe6Gh+wPKHiB21sGKEnuhoXUAea1YdfU8oLjbrTX+njxIX+cweL0tScpVtMb2RoBa7ospt67s9leTjuOKr6itesFB1fbF0q1T4dpX+K24A68yVAao2q7GNMy7+bW3N+Eoham9lpoAqrUvZtYowsI+Dp+fWY/PXI3P1KE9SHl/3C8tBAvE/k99Ps1iUJV9sRQgb1/CjhzNf1UPQLmGigpqVdoXM82fStvgbLpZxK8+nsOPg5S/gjMtW5jA7ICosPgehu44ULSNVvafYdKqbltYffWCWvCxu+KVmWh7InuPvVSNgjR87K4UkJ/a16xiyGqtWrDLeuyubDbfGefx7tGWT9uB4sJjd6Wz+eDa1vEnqKxawS7rsbuydsWdqnX/6prFoLnH7qTTyajgJmE5sqB6QS342J1gshr+onz5vUyHHgclonAchprr3gBtk7pu6qtZMNSqIJ2EsW0PO7YHpWFskLoiE+oWrHq7bWEkLahesMnt9gPVCFDlXY2N405cdd2Cgyo/7bN15rqtu2bBrv6zGg8HqPbTPg8HqPrTPg8Ygyo/7fNwWex4Lz8q1W7joLvRToDwTY/0fzkiICACAiIgIAICIiAgAgIiICACArqbucFeIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICqg9o/r0k15+/LRdIyn5+s+w696YmYX2RqgO6DC9HShr0/qo39OcLJDUc9tPFhdeNr7eQ1xerNqBx//6U+Li4y3isaL5AUvr9Cx9vT9Lr7PEK6XWxagMa32CXOON5US/a5tkCCxoASa87PwGDMlUd0MKLW0ZAi292SWt4ykh63emXPgS9lNXnqzagsben+7y2cqnAzC11Q4XXvb8OByxOLwX1hboDQOMTWEUN7Ws8GqAmXWxoX9F1fQA6WhdbionFQVo3tOi6n/46WpBeyqqXgjQ/tq+/cqPrbrThQHHyc+HAbXjpm26k9LoByUl+Xaz6U435V7tMgUD47peTMk9ab3NdJE5WgQgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICAjgfo+jx++M5Zfb0+hx/EM5wj/nhb/8JliY4HaPr0puvzy3SGxco7R7ydDgioO/34TR9sjQBN54gJSH9s/tmdRptkzhET0ADmT40m6mIdARlNn2hJQDPqM5VGQUAzOn35T7+9g4DSuqivY64noKSuz/qA6vB8BgElNL1xYXjYgoAS6gP0SOWingZAesQ4iYAiaQ+6/hb9loCsNKBL/Lm6BGSlZ/N/hzg4mz+YCAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgID+B4UpszJB4ezTAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a><span class="co"># Rcpp</span></span>
<span id="cb130-2"><a href="#cb130-2" tabindex="-1"></a></span>
<span id="cb130-3"><a href="#cb130-3" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="at">code=</span><span class="st">&#39;</span></span>
<span id="cb130-4"><a href="#cb130-4" tabindex="-1"></a><span class="st">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb130-5"><a href="#cb130-5" tabindex="-1"></a><span class="st">using namespace Rcpp;</span></span>
<span id="cb130-6"><a href="#cb130-6" tabindex="-1"></a></span>
<span id="cb130-7"><a href="#cb130-7" tabindex="-1"></a><span class="st">//[[Rcpp::export]]</span></span>
<span id="cb130-8"><a href="#cb130-8" tabindex="-1"></a><span class="st">NumericMatrix GibbsC(double a, double b, int n, int N) {</span></span>
<span id="cb130-9"><a href="#cb130-9" tabindex="-1"></a><span class="st">  NumericMatrix X(N,2);</span></span>
<span id="cb130-10"><a href="#cb130-10" tabindex="-1"></a><span class="st">  double x,y;</span></span>
<span id="cb130-11"><a href="#cb130-11" tabindex="-1"></a><span class="st">  X(0,0)=0;</span></span>
<span id="cb130-12"><a href="#cb130-12" tabindex="-1"></a><span class="st">  X(0,1)=0.5;</span></span>
<span id="cb130-13"><a href="#cb130-13" tabindex="-1"></a><span class="st">  for(int i=1;i&lt;N;i++){</span></span>
<span id="cb130-14"><a href="#cb130-14" tabindex="-1"></a><span class="st">    y = X(i-1,1);</span></span>
<span id="cb130-15"><a href="#cb130-15" tabindex="-1"></a><span class="st">    X(i,0) = rbinom(1,n,y)[0];</span></span>
<span id="cb130-16"><a href="#cb130-16" tabindex="-1"></a><span class="st">    x = X(i,0);</span></span>
<span id="cb130-17"><a href="#cb130-17" tabindex="-1"></a><span class="st">    X(i,1) = rbeta(1,x+a,n-x+b)[0];</span></span>
<span id="cb130-18"><a href="#cb130-18" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb130-19"><a href="#cb130-19" tabindex="-1"></a><span class="st">  return X;</span></span>
<span id="cb130-20"><a href="#cb130-20" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb130-21"><a href="#cb130-21" tabindex="-1"></a><span class="st">&#39;</span>)</span>
<span id="cb130-22"><a href="#cb130-22" tabindex="-1"></a>XC <span class="ot">=</span> <span class="fu">GibbsC</span>(a,b,n,N)</span>
<span id="cb130-23"><a href="#cb130-23" tabindex="-1"></a><span class="fu">plot</span>(XC[,<span class="dv">1</span>],XC[,<span class="dv">2</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">GibbsR=</span><span class="fu">GibbsR</span>(a,b,n,N),<span class="at">GibbsC=</span><span class="fu">GibbsC</span>(a,b,n,N))</span>
<span id="cb131-2"><a href="#cb131-2" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##     expr       lq   median        uq
## 1 GibbsR 2368.802 2423.751 2533.9505
## 2 GibbsC  356.901  364.051  375.6505</code></pre>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
